!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.GeoFormatter=e()}(this,function(){var t=function(t){this.result=t};return t.prototype={getCoordinates:function(){var t=this.result.geometry.location;return[t.lat(),t.lng()]},getAddress:function(){return this.result.formatted_address},getNeighborhood:function(){return this.matchingTypes(["neighborhood"])},getCity:function(){return this.matchingTypes(["locality","sublocality","administrative_area_level_3","administrative_area_level_2"],!0)},getState:function(){return this.matchingTypes(["administrative_area_level_1"])},getStateCode:function(){return this.matchingTypes(["administrative_area_level_1"],!0)},getSubState:function(){return this.matchingTypes(["administrative_area_level_2"])},getSubStateCode:function(){return this.matchingTypes(["administrative_area_level_2"],!0)},getCountry:function(){return this.matchingTypes(["country"])},getCountryCode:function(){return this.matchingTypes(["country"],!0)},getPostalCode:function(){return this.matchingTypes(["postal_code"])},getRoute:function(){return this.matchingTypes(["route"])},getStreetNumber:function(){return this.matchingTypes(["street_number"])},getStreetAddress:function(){var t=this.getStreetNumber(),e=this.getRoute();return t&&e?[t,e].join(" "):t||e||""},getTypes:function(){return this.result.types},getFormattedAddress:function(){return this.result.formatted_address},getGeometry:function(){return this.result.geometry},getPrecision:function(){var t=this.getGeometry();return t?t.location_type:null},matchingTypes:function(t,e){var r,o,i,n,s=this.result.address_components;for(i=0;i<t.length;i++)for(r=t[i],n=0;n<s.length;n++)if(o=s[n],o.types.indexOf(r)>-1)return e?o.short_name:o.long_name}},t}),function(){!function(t){return t.fn.artsyplaceholder=function(e,r){var o,i,n,s=this;return t(this).wrap("<div class='artsy_placeholder_wrapper' />"),t(this).before("<div class='artsy_placeholder'>"+e+"</div>"),n=t(this).closest(".artsy_placeholder_wrapper"),i=t(this).siblings(".artsy_placeholder"),o=!0,n.css({position:"relative"}),i.css({position:"absolute",top:0,left:0,color:r||"#999"}),setTimeout(function(){return""!==t(s).val()?(o=!1,i.hide()):void 0},200),i.click(function(){return t(s).focus()}),t(this).keydown(function(t){var e;if(8!==(e=t.keyCode)&&9!==e)return o?i.fadeOut(150):void 0}).keyup(function(){return""===t(this).val()?(i.fadeIn(150),o=!0):(o=!1,i.fadeOut(150))}).blur(function(){return""===t(this).val()&&(o=!0)?i.fadeIn(150):void 0})}}(jQuery)}.call(this),function(t){var e,r={axis:"both",element:window,translated:!1,centerOnInit:!0,center:{x:0,y:0}},o={init:function(i){return i&&t.extend(r,i),this.each(function(){var i=t(this);i.data("centerme_on",r.axis),e=function(){o.center(i)},t(window).bind("resize",e),i.css("position","absolute").bind("center",function(){o.center(i)}),r.centerOnInit&&o.center(i),i.bind("center",function(t,e){o.center(i,e)})})},center:function(e,r){if(null==r&&(r=!1),e||(e=t(this)),!e.data("centering")){var i=o.getCenterPos(e);r?e.data("centering",!0).animate(i,{duration:"slow",queue:!1,specialEasing:"easeIn"}):e.css(i).data("centering",!1)}},getCenterPos:function(e){var o={},i=e.data("centerme_on");return e||(e=t(this)),("horizontal"==i||"both"==i)&&(o.left=Math.floor((t(r.element).width()-e.width())/2)),("vertical"==i||"both"==i)&&(o.top=Math.floor((t(r.element).height()-e.height())/2)),o},option:function(t,e){return e?(r[t]=e,this):r[t]},destroy:function(){return this.each(function(){t(this).unbind("center"),t(window).unbind("resize",e)})}};t.fn.centerme=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.centerme"),void 0):o.init.apply(this,arguments)}}(jQuery),/*
 *
 * Copyright (c) 2006-2010 Sam Collett (http://www.texotela.co.uk)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * 
 * Version 1.2
 * Demo: http://www.texotela.co.uk/code/jquery/dimension/
 *
 * Modified to support dimensions, ie. allowing space and slash
 */
function(t){t.fn.dimension=function(e,r){return e=e===!1?"":e||".",r="function"==typeof r?r:function(){},this.data("dimension.decimal",e).data("dimension.callback",r).keypress(t.fn.dimension.keypress).blur(t.fn.dimension.blur)},t.fn.dimension.keypress=function(e){var r=t.data(this,"dimension.decimal"),o=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(13==o&&"input"==this.nodeName.toLowerCase())return!0;if(13==o)return!1;var i=!1;if(e.ctrlKey&&97==o||e.ctrlKey&&65==o)return!0;if(e.ctrlKey&&120==o||e.ctrlKey&&88==o)return!0;if(e.ctrlKey&&99==o||e.ctrlKey&&67==o)return!0;if(e.ctrlKey&&122==o||e.ctrlKey&&90==o)return!0;if(e.ctrlKey&&118==o||e.ctrlKey&&86==o||e.shiftKey&&45==o)return!0;if(48>o||o>57){if(32==o&&this.value.length>0)return-1!=this.value.indexOf(" ")?!1:-1==this.value.indexOf("/")?!0:!1;if(47==o&&this.value.length>0)return-1==this.value.indexOf("/")?!0:!1;r&&o==r.charCodeAt(0)&&-1!=this.value.indexOf(r)&&(i=!1),8!=o&&9!=o&&13!=o&&35!=o&&36!=o&&37!=o&&39!=o&&46!=o?i=!1:"undefined"!=typeof e.charCode&&(e.keyCode==e.which&&0!=e.which?(i=!0,46==e.which&&(i=!1)):0!=e.keyCode&&0==e.charCode&&0==e.which&&(i=!0)),r&&o==r.charCodeAt(0)&&(i=-1==this.value.indexOf(r)?!0:!1)}else i=!0;return i},t.fn.dimension.blur=function(){var e=t.data(this,"dimension.decimal"),r=t.data(this,"dimension.callback"),o=t(this).val();if(""!=o){var i=new RegExp("^\\d+$|\\d*"+e+"\\d+");i.exec(o)||r.apply(this)}},t.fn.removedimension=function(){return this.data("dimension.decimal",null).data("dimension.callback",null).unbind("keypress",t.fn.dimension.keypress).unbind("blur",t.fn.dimension.blur)}}(jQuery),function(){var t,e,r,o,i,n,s;t=jQuery,s=0,o=[],e=function(){function e(e,r){var o,i;o=t(e),this.originalWidth=this.width=o.outerWidth(!1),this.originalHeight=this.height=o.height(),this.originalMargin=this.margin=o.outerWidth(!0)-o.outerWidth(!1),i=o.find("img"),this.imgRatio=i.width()/i.height(),this.$el=o,this.settings=r}return e.prototype.setHeight=function(t){return this.width=Math.round(t*(this.width/this.height)),this.settings.lockedHeight?void 0:this.height=t},e.prototype.setWidth=function(t){return this.height=Math.round(t*(this.height/this.width)),this.width=t},e.prototype.decWidth=function(){return this.setWidth(this.width-1)},e.prototype.decHeight=function(){return this.setHeight(this.height-1)},e.prototype.incWidth=function(){return this.setWidth(this.width+1)},e.prototype.incHeight=function(){return this.setHeight(this.height+1)},e.prototype.updateDOM=function(){return this.$el.css({width:this.width,height:this.height,"margin-right":this.margin})},e.prototype.reset=function(){return this.width=this.originalWidth,this.height=this.originalHeight,this.margin=this.originalMargin,this.$el.css({width:this.width,height:this.height,"margin-right":this.margin})},e}(),r=function(){function t(t,e){this.frameWidth=t,this.settings=e,this.lis=[]}return t.prototype.width=function(){var t,e,r,o,i;for(e=0,i=this.lis,r=0,o=i.length;o>r;r++)t=i[r],e+=t.width+t.margin;return e},t.prototype.updateDOM=function(){var t,e,r,o,i;for(o=this.lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.updateDOM());return i},t.prototype.reset=function(){var t,e,r,o,i;for(o=this.lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.reset());return i},t.prototype.landscapeGroups=function(){var t,e,r,o,i,n;e=[],n=this.settings.landscapeRatios;for(t in n)i=n[t],r=function(){var t,e,r,n;for(r=this.lis,n=[],t=0,e=r.length;e>t;t++)o=r[t],o.imgRatio>=i&&n.push(o);return n}.call(this),e.push(r);return e},t.prototype.resizeLandscapes=function(){var t,e,r,o,i,n,s,a,l,p;for(l=this.landscapeGroups(this.settings.landscapeRatios),o=0,s=l.length;s>o;o++)if(e=l[o],0!==e.length){for(t=i=0,p=this.settings.resizeLandscapesBy;p>=0?p>=i:i>=p;t=p>=0?++i:--i){for(n=0,a=e.length;a>n;n++)r=e[n],r.decHeight();if(this.width()<=this.frameWidth)break}if(this.width()<=this.frameWidth)break}return this},t.prototype.adjustMargins=function(){var t,e,r,o,i,n,s,a;for(a=[],t=r=0,n=this.settings.adjustMarginsBy;n>=0?n>=r:r>=n;t=n>=0?++r:--r){for(s=this.lis.slice(0,+(this.lis.length-2)+1||9e9),o=0,i=s.length;i>o&&(e=s[o],e.margin--,!(this.width()<=this.frameWidth));o++);if(this.width()<=this.frameWidth)break;a.push(void 0)}return a},t.prototype.resizeHeight=function(){var t,e,r;for(t=0,r=[];this.width()>this.frameWidth&&t<this.settings.resizeRowBy;)t++,r.push(function(){var t,r,o,i;for(o=this.lis,i=[],t=0,r=o.length;r>t;t++)e=o[t],i.push(e.decHeight());return i}.call(this));return r},t.prototype.roundOff=function(){var t,e,r,o,i;for(o=this.lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.setWidth(Math.floor(t.width)));return i},t.prototype.fillLeftoverPixels=function(){var t,e,r,o=this;for(this.roundOff(),t=function(){return o.frameWidth-o.width()},r=[];0!==t();)e=Math.round(Math.random()*(this.lis.length-1)),t()<0?r.push(this.lis[e].decWidth()):r.push(this.lis[e].incWidth());return r},t.prototype.removeMargin=function(){var t;return t=this.lis[this.lis.length-1],t.margin=0},t.prototype.lockHeight=function(){var t,e,r,o,i,n,s;for(r=this.lis.sort(function(t,e){return e.height-t.height})[0],e=Math.ceil(r.height),n=this.lis,s=[],o=0,i=n.length;i>o;o++)t=n[o],s.push(t.height=e);return s},t.prototype.hide=function(){var t,e,r,o,i;for(o=this.lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.$el.hide());return i},t.prototype.show=function(){var t,e,r,o,i;for(o=this.lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.$el.show());return i},t}(),i=function(t,e){var r;return r=0,function(){var o,i;return o=arguments,i=function(){return r=null,t(o)},clearTimeout(r),r=setTimeout(i,e)}},n={init:function(e){var r,a,l=this;return a={resizeLandscapesBy:200,resizeRowBy:15,landscapeRatios:function(){var t,e;for(e=[],r=t=10;50>=t;r=t+=3)e.push(r/10);return e}().reverse(),fillLastRow:!1,beforeFillWidth:null,afterFillWidth:null,childSelector:"li"},this.settings=t.extend(a,e),this.each(function(e,r){var a,p,u,h;return a=t(r),n.initStyling.call(l,a),h=function(){return n.fillWidth.call(l,a),navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||t.browser.msie&&"8.0"===t.browser.version||App.$window.bind("resize.fillwidth",i(function(){var t,e,r;if(o.push(function(){return n.fillWidth.call(l,a)}),o.length===s){for(e=0,r=o.length;r>e;e++)t=o[e],t();return o=[]}},300)),s++},p=a.find("img"),null!=l.settings.liWidths?(h(),p.load(function(){return t(this).height("auto")})):(u=p.length,p.load(function(){return u--,0===u?h():void 0}))})},initStyling:function(e){var r,o=this;return r=t(e),r.css({"list-style":"none",padding:0,margin:0,overflow:"hidden"}),null!=this.settings.initStyling&&r.css(this.settings.initStyling),r.children(this.settings.childSelector).css({"float":"left","margin-left":0}),r.find("*").css({"max-width":"100%","max-height":"100%"}),this.settings&&null!=this.settings.liWidths?r.children(this.settings.childSelector).each(function(e,r){return t(r).width(o.settings.liWidths[e])}):void 0},destroy:function(){return App.$window.unbind("resize.fillwidth"),this.each(function(){var e,r,o,i;for(i=t(this).fillwidth("rowObjs"),r=0,o=i.length;o>r;r++)e=i[r],e.reset();return t(this).removeData("fillwidth.rows")})},fillWidth:function(e){var r,o,i,s,a,l,p,u;if(r=t(e),r.trigger("fillwidth.beforeFillWidth"),null!=this.settings.beforeFillWidth&&this.settings.beforeFillWidth(),this.fillwidthRows)for(u=this.fillwidthRows,s=0,l=u.length;l>s;s++)o=u[s],o.reset();for(r.width("auto"),r.trigger("fillwidth.beforeNewRows"),null!=this.settings.beforeNewRows&&this.settings.beforeNewRows(),this.frameWidth=r.width(),i=n.breakUpIntoRows.call(this,r),this.fillwidthRows=i,r.width(this.frameWidth),r.trigger("fillwidth.afterNewRows"),null!=this.settings.afterNewRows&&this.settings.afterNewRows(),a=0,p=i.length;p>a;a++)o=i[a],o.lis.length>1&&(o.removeMargin(),o.resizeHeight(),null!=this.settings.adjustMarginsBy&&o.adjustMargins(),o.resizeLandscapes(),(o!==i[i.length-1]||this.settings.fillLastRow)&&o.fillLeftoverPixels(),o.lockHeight(),o.updateDOM());return r.trigger("fillwidth.afterFillWidth"),null!=this.settings.afterFillWidth?this.settings.afterFillWidth():void 0},rowObjs:function(){var t,e;return t=[],e=this.fillwidthRows,this.each(function(){return t.push(e)}),1===t.length&&(t=t[0]),t},rows:function(){var t,e,r,o,i,s;for(o=n.rowObjs.call(this),t=[],i=0,s=o.length;s>i;i++)r=o[i],t.push(function(){var t,o,i,n;for(i=r.lis,n=[],t=0,o=i.length;o>t;t++)e=i[t],n.push(e.$el);return n}());return 1===t.length&&(t=t[0]),t},breakUpIntoRows:function(o){var i,n,s,a=this;return i=t(o),n=0,s=[new r(this.frameWidth,this.settings)],i.children(this.settings.childSelector).each(function(o,l){return t(l).is(":hidden")?void 0:(s[n].lis.push(new e(l,a.settings)),s[n].width()>=i.width()&&o!==i.children(a.settings.childSelector).length-1?(s.push(new r(a.frameWidth,a.settings)),n++):void 0)}),s}},t.fn.fillwidth=function(e){return null!=n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof e||null==e?n.init.apply(this,arguments):t.error("Method "+e+" does not exist on jQuery.fillwidth")}}.call(this),function(t,e,r,o){function i(e,r){this.options=t.extend(!0,{},n,r),this.input=e,this.$input=t(e),this._defaults=n,this._name="geocomplete",this.init()}var n={bounds:!0,country:null,map:!1,details:!1,detailsAttribute:"name",location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"],blur:!1},s="street_address route intersection political country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality sublocality neighborhood premise subpremise postal_code natural_feature airport park point_of_interest post_box street_number floor room lat lng viewport location formatted_address location_type bounds".split(" "),a="id url website vicinity reference name rating international_phone_number icon formatted_phone_number".split(" ");t.extend(i.prototype,{init:function(){this.initMap(),this.initMarker(),this.initGeocoder(),this.initDetails(),this.initLocation()},initMap:function(){if(this.options.map){if("function"==typeof this.options.map.setCenter)return this.map=this.options.map,void 0;this.map=new google.maps.Map(t(this.options.map)[0],this.options.mapOptions),google.maps.event.addListener(this.map,"click",t.proxy(this.mapClicked,this))}},initMarker:function(){if(this.map){var e=t.extend(this.options.markerOptions,{map:this.map});e.disabled||(this.marker=new google.maps.Marker(e),google.maps.event.addListener(this.marker,"dragend",t.proxy(this.markerDragged,this)))}},initGeocoder:function(){var e={types:this.options.types,bounds:this.options.bounds===!0?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};this.options.country&&(e.componentRestrictions={country:this.options.country}),this.autocomplete=new google.maps.places.Autocomplete(this.input,e),this.geocoder=new google.maps.Geocoder,this.map&&this.options.bounds===!0&&this.autocomplete.bindTo("bounds",this.map),google.maps.event.addListener(this.autocomplete,"place_changed",t.proxy(this.placeChanged,this)),this.$input.keypress(function(t){return 13===t.keyCode?!1:void 0}),this.$input.bind("geocode",t.proxy(function(){this.find()},this)),this.options.blur===!0&&this.$input.blur(t.proxy(function(){this.find()},this))},initDetails:function(){function e(t){i[t]=r.find("["+o+"="+t+"]")}if(this.options.details){var r=t(this.options.details),o=this.options.detailsAttribute,i={};t.each(s,function(t,r){e(r),e(r+"_short")}),t.each(a,function(t,r){e(r)}),this.$details=r,this.details=i}},initLocation:function(){var t,e=this.options.location;if(e){if("string"==typeof e)return this.find(e),void 0;e instanceof Array&&(t=new google.maps.LatLng(e[0],e[1])),e instanceof google.maps.LatLng&&(t=e),t&&(this.map&&this.map.setCenter(t),this.marker&&this.marker.setPosition(t))}},find:function(t){this.geocode({address:t||this.$input.val()})},geocode:function(e){this.options.bounds&&!e.bounds&&(e.bounds=this.options.bounds===!0?this.map&&this.map.getBounds():this.options.bounds),this.options.country&&(e.region=this.options.country),this.geocoder.geocode(e,t.proxy(this.handleGeocode,this))},handleGeocode:function(t,e){if(e===google.maps.GeocoderStatus.OK){var r=t[0];this.$input.val(r.formatted_address),this.update(r),t.length>1&&this.trigger("geocode:multiple",t)}else this.trigger("geocode:error",e)},trigger:function(t,e){this.$input.trigger(t,[e])},center:function(t){t.viewport?(this.map.fitBounds(t.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(t.location)),this.marker&&(this.marker.setPosition(t.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(t){this.map&&this.center(t.geometry),this.$details&&this.fillDetails(t),this.trigger("geocode:result",t)},fillDetails:function(e){var r={},o=e.geometry,i=o.viewport,n=o.bounds;t.each(e.address_components,function(t,e){var o=e.types[0];r[o]=e.long_name,r[o+"_short"]=e.short_name}),t.each(a,function(t,o){r[o]=e[o]}),t.extend(r,{formatted_address:e.formatted_address,location_type:o.location_type||"PLACES",viewport:i,bounds:n,location:o.location,lat:o.location.lat(),lng:o.location.lng()}),t.each(this.details,t.proxy(function(t,e){var o=r[t];this.setDetail(e,o)},this)),this.data=r},setDetail:function(t,e){e===o?e="":"function"==typeof e.toUrlValue&&(e=e.toUrlValue()),t.is(":input")?t.val(e):t.text(e)},markerDragged:function(t){this.trigger("geocode:dragged",t.latLng)},mapClicked:function(t){this.trigger("geocode:click",t.latLng)},resetMarker:function(){this.marker.setPosition(this.data.location),this.setDetail(this.details.lat,this.data.location.lat()),this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var t=this.autocomplete.getPlace();t.geometry?this.update(t):this.find(t.name)}}),t.fn.geocomplete=function(e){var r="plugin_geocomplete";if("string"==typeof e){var o=t(this).data(r)||t(this).geocomplete().data(r),n=o[e];return"function"==typeof n?(n.apply(o,Array.prototype.slice.call(arguments,1)),t(this)):(2==arguments.length&&(n=arguments[1]),n)}return this.each(function(){var o=t.data(this,r);o||(o=new i(this,e),t.data(this,r,o))})}}(jQuery,window,document),function(){!function(t){var e,r;return r="heroUnit",e=function(){function e(t,e){var r,o,i,n,s=this;for(n=this.requires,o=0,i=n.length;i>o;o++)if(r=n[o],null==e[r])throw"You must pass "+r;if(!(t.length>0))throw"Herounit must be called on an element";this.$el=t,this.settings=e,this.$img=this.settings.$img,this.detectPhone(),this.$el.imagesLoaded?this.$el.imagesLoaded(function(){return s.render()}):this.$img.load(function(){return s.render()}),this.onLoad(),this.$el.height(this.settings.height)}return e.prototype.requires=["height","$img"],e.prototype.optional=["afterImageLoadcont"],e.prototype.render=function(){var t;return this.neutralizeImageSize(),this.setImageAttrs(),this.centerImage(),this.$img.show(),"function"==typeof(t=this.settings).afterImageLoadcont?t.afterImageLoadcont():void 0},e.prototype.neutralizeImageSize=function(){return this.$img.css({height:"auto",width:"auto"})},e.prototype.setImageAttrs=function(){return this.naturalImageHeight=this.$img.height(),this.naturalImageWidth=this.$img.width(),this.aspectRatio=this.naturalImageWidth/this.naturalImageHeight,this.minWidth=Math.floor(this.settings.height*this.aspectRatio),this.height=this.settings.height||this.$el.height(),this.width=this.$el.width()},e.prototype.centerImage=function(){var t,e;return this.IS_PHONE?this.$img.width("auto"):this.width<this.minWidth?(t=-Math.floor((this.minWidth-this.width)/2),this.$img.width(this.minWidth)):(t=0,this.$img.width(this.width)),e=this.height>=this.$img.height()?0:-Math.abs(Math.floor((this.height-this.$img.height())/2)),this.$img.css({"margin-top":""+e+"px","margin-left":""+t+"px"})},e.prototype.onLoad=function(){var t=this;return this.IS_PHONE?void 0:App.$window.on("resize."+r,this.debounce(function(){return t.render()},100))},e.prototype.debounce=function(t,e){var r;return r=0,function(){var o,i;return o=arguments,i=function(){return r=null,t(o)},clearTimeout(r),r=setTimeout(i,e)}},e.prototype.detectPhone=function(){return this.uagent=navigator.userAgent.toLowerCase(),this.IS_PHONE=this.uagent.search("iphone")>-1||this.uagent.search("ipod")>-1||this.uagent.search("android")>-1&&this.uagent.search("mobile")>-1},e.prototype.destroy=function(){return App.$window.off("."+r),this.$img.fadeOut(),t.removeData(this.$el,"plugin_"+r)},e}(),t.fn[r]=function(o){if(t.data(this,"plugin_"+r)){if(null!=t.data(this,"plugin_"+r)[o])return t.data(this,"plugin_"+r)[o](Array.prototype.slice.call(arguments,1)[0],Array.prototype.slice.call(arguments,1)[1]);throw"Method '"+o+"' does not exist on jQuery."+r}if(null==o)throw"You must pass settings";return t.data(this,"plugin_"+r,new e(this,o))}}(jQuery,window,document)}.call(this),function(){!function(t){return t.fn.konami=function(e){var r,o;return r=[38,38,40,40,37,39,37,39,66,65],o=[],t(this).bind("keydown.konami",function(t){return o.push(t.keyCode),o.join("")!==r.slice(0,o.length).join("")&&(o=[]),o.length===r.length?e():void 0})}}(jQuery)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,r){function o(){this.constructor=e}for(var i in r)t.call(r,i)&&(e[i]=r[i]);return o.prototype=r.prototype,e.prototype=new o,e.__super__=r.prototype,e};!function(t,r){var o,i,n,s,a;return a="popLockIt",o=function(){function t(t,e){var r,o,i,n;for(this.$el=t,this.settings=e,n=this.requires,o=0,i=n.length;i>o;o++)if(r=n[o],null==this.settings[r])throw"You must pass "+r}return t.prototype.requires=[],t}(),i=function(t){function r(t,e){this.$el=t,this.settings=e}return e(r,t),r.prototype.requires=["height","marginTop","marginLeft","marginBottom"],r.prototype.cssProperties=["position","top","bottom","left"],r.prototype.marginTop=0,r.prototype.marginBottom=0,r.prototype.marginLeft=0,r.prototype.parentHeight=0,r.prototype.height=0,r.prototype.top=0,r.prototype.bottom=0,r.prototype.left=0,r.prototype.setMargins=function(t){return t.parentHeight&&(this.parentHeight=t.parentHeight),t.marginTop&&(this.marginTop=t.marginTop),t.marginBottom&&(this.marginBottom=t.marginBottom),t.marginLeft?this.marginLeft=t.marginLeft:void 0},r.prototype.setDimensions=function(){return this.height=Math.floor(Number(this.$el.css("height").replace("px",""))),this.top=Math.floor(this.$el.offset().top-this.marginTop),this.left=Math.floor(this.$el.offset().left),this.bottom=Math.floor(this.top+this.height),this.top<1?this.top=1:void 0},r.prototype.setPosition=function(t,e){var r,o,i,n,s,a,l;if(null==t&&(t="absolute"),null==e&&(e="north"),i={position:t,left:Math.round(this.getLeftForPosition(t))},"absolute"===t?(i.top="north"===e?this.marginTop:"auto",i.bottom="south"===e?this.marginBottom:"auto"):(i.top="north"===e?this.marginTop:"auto",i.bottom="south"===e?0:"auto"),!this.oldState)return this.$el.css(i),this.oldState=i;for(o={},r=!1,l=this.cssProperties,s=0,a=l.length;a>s;s++)n=l[s],i[n]!==this.oldState[n]&&(o[n]=i[n],r=!0);return r?(this.$el.css(o),this.oldState=i):void 0},r.prototype.getLeftForPosition=function(t){return"fixed"===t?this.left:"static"===t?0:this.left-this.marginLeft},r.prototype.onScroll=function(t,e,r){if(null==r&&(r=!1),!r){if(this.height===e)return t<this.top+this.parentHeight-this.height?this.setPosition("fixed","north"):this.setPosition("absolute","south");if(this.height<e)return t>=this.top&&t<this.top+this.parentHeight-this.height?this.setPosition("fixed","north"):this.setPosition("absolute","south");if(this.height>e&&this.height<this.parentHeight&&t+e>=this.top+this.height&&t+e<this.parentHeight+this.top)return this.setPosition("fixed","south")}return t+e>=this.bottom&&this.height>=e?this.setPosition("absolute","south"):this.setPosition("absolute","north")},r.prototype.destroy=function(){return this.setPosition()},r}(o),s=function(r){function o(t,e,r,i){this.$el=t,this.settings=e,this.index=r,this.parent=i,o.__super__.constructor.apply(this,arguments),this.$columns=this.$el.find(this.settings.columnSelector),this.hasColumns()&&(this.setDimensions(),this.createColumns()),this.settings.additionalFeedItemInit&&this.settings.additionalFeedItemInit(this.$el,this.index)}return e(o,r),o.prototype.requires=["columnSelector"],o.prototype.active=!1,o.prototype.columns=[],o.prototype.createColumns=function(){var e,r,o,n,s,a,l,p;for(this.columns=this.$columns.map(function(){return new i(t(this))}),a=this.columns,r=0,n=a.length;n>r;r++)e=a[r],this.setColumnMargins(e);for(l=this.columns,p=[],o=0,s=l.length;s>o;o++)e=l[o],p.push(e.setDimensions());return p},o.prototype.setDimensions=function(){var t;return this.marginTop=Number(this.$el.css("padding-top").replace("px","")),this.marginBottom=Number(this.$el.css("padding-bottom").replace("px","")),this.resetColumnPositioning(),this.$el.css({height:"auto"}),t=this.$el.css("height"),this.height=Number(t.replace("px","")),this.$el.css({height:t}),this.left=this.$el.offset().left,this.top=this.$el.offset().top,this.bottom=this.top+this.height},o.prototype.onScroll=function(t,e,r){var o,i,n,s,a,l,p,u,h,c,d,f;if(e>=this.height)return this.active=!1;if(t>=this.top&&t<this.bottom){for(this.active=!0,u=this.columns,d=[],i=0,a=u.length;a>i;i++)o=u[i],d.push(o.onScroll(t,e,this.parent.settings.preventFixed));return d}if(this.active){for(h=this.columns,n=0,l=h.length;l>n;n++)o=h[n],o.onScroll(t,e,!0);return this.active=!1}if(r){for(c=this.columns,f=[],s=0,p=c.length;p>s;s++)o=c[s],f.push(o.onScroll(t,e,!0));return f}},o.prototype.recompute=function(){var t,e,r,o,i,n,s,a;for(this.setDimensions(),n=this.columns,e=0,o=n.length;o>e;e++)t=n[e],this.setColumnMargins(t);for(s=this.columns,a=[],r=0,i=s.length;i>r;r++)t=s[r],a.push(t.setDimensions());return a},o.prototype.setColumnMargins=function(t){return t.setMargins({parentHeight:this.height,marginTop:this.marginTop,marginBottom:this.marginBottom,marginLeft:this.left})},o.prototype.recomputeColumn=function(t){return this.columns[t]?void 0:this.setColumnMargins(this.columns[t])},o.prototype.resetColumnPositioning=function(){var t,e,r,o,i;for(o=this.columns,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.setPosition("static"));return i},o.prototype.destroy=function(){var t,e,r,o,i;for(o=this.columns,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.destroy());return i},o.prototype.hasColumns=function(){var t;return(null!=(t=this.$columns)?t.length:void 0)>1},o}(o),n=function(o){function i(e,r){var o;if(this.el=e,this.settings=r,this.$el=t(this.el),null==this.settings)throw"You must pass settings";if(1!==(null!=(o=this.$el)?o.length:void 0))throw"PopLockIt must be called on one element";i.__super__.constructor.call(this,this.$el,this.settings),this.settings=t.extend(this.defaults,this.settings),this.settings.active=!0,this.initRequestAnimationFrame(),this.viewportHeight=App.$window.outerHeight(!0),this.$el.css({"box-sizing":"border-box",overflow:"hidden"}),this.addFeedItems(this.settings.feedItems),this.requestAnimationFrame()}return e(i,o),i.prototype.feedItems=[],i.prototype.requires=["feedItems"],i.prototype.hasFocus=!0,i.prototype.scrollSpeedThreshold=500,i.prototype.defaults={active:!0,rendered:!1,preventFixed:!1},i.prototype.onScroll=function(){var t,e,o,i,n,s=this;if(this.settings.active){if(e=App.$window.scrollTop(),e===this.previousScrollTop)return this.requestedAnimationFrame=r.requestAnimationFrame(function(){return s.onScroll()});for(n=this.feedItems,o=0,i=n.length;i>o;o++)t=n[o],t.onScroll(e,this.viewportHeight,Math.abs(e-this.previousScrollTop)>this.scrollSpeedThreshold);return this.previousScrollTop=e,null!=this.settings.onScroll&&this.settings.onScroll(e),this.requestAnimationFrame()}},i.prototype.recompute=function(){var t,e,r,o,i,n,s,a,l,p;for(this.settings.active=!0,a=this.feedItems,o=0,n=a.length;n>o;o++)t=a[o],t.recompute();for(r=App.$window.scrollTop(),l=this.feedItems,p=[],i=0,s=l.length;s>i;i++)e=l[i],p.push(e.onScroll(r,this.viewportHeight,!1));return p},i.prototype.recomputeItem=function(t){return this.feedItems[t]?this.feedItems[t].recompute():void 0},i.prototype.recomputeItemColumn=function(t,e){return this.feedItems[t]?this.feedItems[t].recomputeColumn(e):void 0},i.prototype.destroy=function(){var e,r,o,i;if(this.settings.rendered=!1,this.settings.active=!1,t.data(this.$el,"plugin_"+a,!1),"undefined"!=typeof feedItems&&null!==feedItems?feedItems.length:void 0)for(i=this.feedItems,r=0,o=i.length;o>r;r++)e=i[r],e.destroy();return this.feedItems=[]},i.prototype.stop=function(){return this.settings.active=!1,r.cancelAnimationFrame(this.requestedAnimationFrame)},i.prototype.start=function(){var t=this;return this.settings.active=!0,r.cancelAnimationFrame(this.requestedAnimationFrame),this.requestedAnimationFrame=r.requestAnimationFrame(function(){return t.onScroll()})},i.prototype.addFeedItems=function(e){var r=this;if(null==e||!e.length)throw"You must pass $feedItems";return e.map(function(e,o){return r.feedItems.push(new s(t(o),r.settings,e,r))})},i.prototype.requestAnimationFrame=function(){var t=this;return this.requestedAnimationFrame=r.requestAnimationFrame(function(){return t.onScroll()})},i.prototype.debounce=function(t,e){var r;return r=0,function(){var o,i;return o=arguments,i=function(){return r=null,t(o)},clearTimeout(r),r=setTimeout(i,e)}},i.prototype.initRequestAnimationFrame=function(){var t,e,o,i,n;if(!r.requestAnimationFrame){for(t=0,o=["ms","moz","webkit","o"],i=0,n=o.length;n>i;i++)e=o[i],r.requestAnimationFrame||(r.requestAnimationFrame=r[""+e+"RequestAnimationFrame"],r.cancelAnimationFrame=r["{vendor}CancelAnimationFrame"]||r["{vendors}CancelRequestAnimationFrame"]);return r.requestAnimationFrame||(r.requestAnimationFrame=function(e){var o,i,n;return o=(new Date).getTime(),n=Math.max(0,16-(o-t)),i=r.setTimeout(function(){return e(o+n)},n),t=o+n,i}),r.cancelAnimationFrame?void 0:r.cancelAnimationFrame=function(t){return clearTimeout(t)}}},i}(o),t.fn[a]=function(e){if(t.data(this,"plugin_"+a)){if(null!=t.data(this,"plugin_"+a)[e])return t.data(this,"plugin_"+a)[e](Array.prototype.slice.call(arguments,1)[0],Array.prototype.slice.call(arguments,1)[1]);throw"Method '"+e+"' does not exist on jQuery.popLockIt"}if(null==e)throw"You must pass settings";return t.data(this,"plugin_"+a,new n(this,e))}}(jQuery,window,document)}.call(this),function(t){var e={interval:5e3,fade_class:"fade_out",fadeables:[],timeout:null,cancel:!1},r={init:function(o){return o&&t.extend(e,o),e.$_this=this,e.fadeables=t(e.fadeables),e.fadeables.addClass("fadeable"),r.fadeOut(),t(document).bind("click.spotlight",r.fadeIn).bind("keyup.spotlight",r.fadeIn).bind("mousemove.spotlight",r.fadeIn),t(e.fadeables).bind("mouseover.spotlight",r.mouseoverOthers).bind("mouseout.spotlight",r.mouseoutOthers),this},mouseoverOthers:function(){e.cancel=!0,window.clearTimeout(e.timeout)},mouseoutOthers:function(){e.cancel=!1,window.clearTimeout(e.timeout),e.timeout=window.setTimeout(r.fadeOut,e.interval)},fadeIn:function(){t(e.fadeables).removeClass(e.fade_class),window.clearTimeout(e.timeout),e.timeout=window.setTimeout(r.fadeOut,e.interval)},fadeOut:function(){e.cancel||t(e.fadeables).addClass("fade_out"),window.clearTimeout(e.timeout)},destroy:function(){r.fadeIn(),t(e.fadeables).unbind(".spotlight"),t(document).unbind(".spotlight"),window.clearTimeout(e.timeout)},option:function(t,r){return r?(e[t]=r,void 0):e[t]}};t.fn.spotlight=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.spotlight"),void 0):r.init.apply(this,arguments)}}(jQuery),function(t){t.fn.toggler=function(){return this.each(function(){if(void 0===this.toggled){this.toggled=!0;var e,r=t(this),o=t("select",this).hide(),i=t("<div class = 'toggler'/>"),n=t("<div class = 'error' />"),s=o.val();r.append("<div class = 'toggle-on'>On</div>").append("<div class = 'toggle-off'>Off</div>").append(i).append(n),"on"==s&&i.css("left","66px"),e=function(t){var e;void 0===t&&(t=!1),"off"==s?(e=66,s="on"):(e=0,s="off"),i.animate({left:e+"px"},{duration:300}),t||o.val(s).change()},r.click(function(){e()}),this.rollback=function(t){t=t||"Whoops!  Can&rsquo;t do it.",n.hide().html(t).fadeIn("fast").delay(500).fadeOut("slow"),setTimeout(function(){e(!0)},500)}}}),this}}(jQuery),function(){var t,e=[].slice;t=function(){var t,r,o,i,n,s,a,l;if(s=1<=arguments.length?e.call(arguments,0):[],a=/(^|\s)(\b(https?):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|]\b)/gi,s.length>0){n=s[0],r=n.callback,null!=r&&"function"==typeof r&&(t=r,delete n.callback),i="";for(o in n)l=n[o],i+=" "+o+"='"+l+"'";return this.replace(a,function(e,r,o){var n,s;return s=t&&t(o),n=s||"<a href='"+o+"'"+i+">"+o+"</a>",""+r+n})}return this.replace(a,"$1<a href='$2'>$2</a>")},String.prototype.autoLink=t}.call(this),function(t){t.fn.serializeToJSON=function(){function e(t){return""==t?null:"true"==t?!0:"false"==t?!1:t}function r(t,e){var o=e.shift();return e.length>0?(t[o]=r(t[o]||{},e),t):o}if(1==this.length)return t.makeArray(this[0].elements).filter(function(t){return""!=t.name&&("radio"==t.type?t.checked:!0)}).map(function(t){var r=t.name.split(".");return"checkbox"==t.type&&(t.value=t.checked),r.push(e(t.value)),r}).reduce(r,{});throw{error:"Can work on a single form only"}},t.flatten=function(e){var r={};for(var o in e)if("object"==typeof e[o]){var i=t.flatten(e[o]);for(var n in i)r[o+"."+n]=i[n]}else r[o]=String(e[o]);return r}}(jQuery),function(){window.html_escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")},window.wrapHamlJsTemplate=function(t,e){var r;return r="with(locals || {}) {\n  try {\n    var _$output="+e+";\n    return _$output;\n  } catch (e) {\n    return \"\\n<pre class='error'>Error rendering "+t+' (" + e.name + "): " + e.message + "\\n" + html_escape(e.stack) + "</pre>\\n";\n  }\n}',new Function("locals",r)}}.call(this),function(){$(function(){var t;return t=function(t){return App.currentUser.isAdmin()?void 0:(t.stopPropagation(),t.preventDefault())},$(document).on("contextmenu","img",t).on("dragstart","img",function(e){return"deep_zoom_light_box"!==$(this).parent().parent().attr("id")&&"profile_edit_icon"!==$(this).parent().parent().parent().parent().attr("id")?t(e):void 0})})}.call(this),function(){$(document).ajaxSend(function(t,e){return App.XAPP?e.setRequestHeader("X-XAPP-TOKEN",App.XAPP.xapp_token):void 0}),$.ajaxPrefilter(function(t){var e;return"GET"!==(null!=t?t.type:void 0)&&$.support.cors?(t.url=App.canonicalize(t.url),null==(e=t.xhrFields)&&(t.xhrFields={}),t.xhrFields.withCredentials=!0):void 0}),$(document).ajaxError(function(t,e,r){var o,i,n,s,a;if(e&&0!==e.status&&("GET"!==r.type||503!==e.status||!App.retry503s(r))){if(i=""+e.status+": "+e.statusText,e.responseText)try{n=jQuery.parseJSON(e.responseText),i=null!=(s=null!=(a=null!=n?n.text:void 0)?a:n.message)?s:i}catch(l){o=l}return("undefined"!=typeof App&&null!==App?App.showError:void 0)&&!e.suppressAppMessages&&App.showError(i),"undefined"!=typeof console&&null!==console?console.log(i):void 0}})}.call(this),function(){String.prototype.camelize=function(){return this.replace(/(_[a-z])/g,function(t){return t.toUpperCase().replace("_","")})},String.prototype.underscore=function(){return inflection.underscore(this)},String.prototype.lcFirst=function(){return this.charAt(0).toLowerCase()+this.slice(1)},String.prototype.ucFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.pluralize=function(){return inflection.pluralize(this)},String.prototype.singularize=function(){return inflection.singularize(this)},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.includes=function(t){return this.indexOf(t)>-1},String.prototype.parseFraction=function(){var parts;return parts=this.trim().split(" "),parts.length>1&&parts[1].indexOf("/")>0?parseInt(parts[0])+eval(parts[1]):parts[0].indexOf(".")>0?parseFloat(parts[0]):parts[0].indexOf("/")>0?eval(parts[0]):parseFloat(this)},_.mixin({capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)},htmlDecode:function(t){return $("<div />").html(t).text()}})}.call(this),function(){window.App={Lib:{},Models:{},Mixins:{},Collections:{},Views:{Browse:{},Genes:{},Home:{},Profiles:{FairOrganizer:{Browse:{}}},Shared:{},Show:{},Shows:{},User:{}},Frames:{},Routers:{},Repositories:{},XAPPCallbacks:[],redirectUrl:"/",viewedArtworkIds:[],passThroughPaths:["sign_out","sign_up","log_in","users/invitation","users/auth"],trackArtworkImpressions:function(){return this.viewedArtworkIds.length>0?(Analytics.multi("Impression","Artwork",this.viewedArtworkIds),this.viewedArtworkIds=[]):void 0
},max503Retries:1,retried503s:{},retry503s:function(t){var e;return null==App.retried503s[t.url]&&(App.retried503s[t.url]={current:0,total:0}),e=App.retried503s[t.url],e.current>=App.max503Retries?(e.current=0,!1):(e.current=e.current+1,e.total=e.total+1,$.ajax(t.url,t),Analytics.error("503 response, retry "+t.url),!0)},init:function(){var t=this;return window.location.hash.indexOf("!")>-1?this.redirectHashBang():(App.$window=$(window),App.$document=$(document),this.initDevice(),$(function(){return t.onDocReady()}))},onDocReady:function(){var t=this;return App.$body=$("body"),App.$html=$("html"),this.IS_MOBILE&&new FastClick(document.body),window.setInterval(function(){return t.trackArtworkImpressions()},15e3),window.PENDING_SESSION||App.currentUser?App.initApp():"false"===App.readCookie("signed_in")?App.initPublicApp():App.setupCurrentUser()},setupCurrentUser:function(){var t=this;return this.currentUser=new App.Models.CurrentUser,this.currentUser.fetch({success:function(){return t.setSignedInCookie(!0),App.Repositories.Users.add(t.currentUser),t.currentUser.track(),t.$html.removeClass("logged-out"),t.currentUser.initializeDefaultArtworkCollection(),t.currentUser.get("default_profile_id")&&(t.currentProfile=new App.Models.Profile({id:t.currentUser.get("default_profile_id")}),t.currentUser.set("profile",t.currentProfile),t.currentProfile.fetch({success:function(){return t.currentProfile.set("owner",t.currentUser),App.Repositories.Profiles.add(t.currentProfile)}})),t.initApp(),_.defer(function(){return t.currentUser.fetchFollowArtists(),t.currentUser.fetchFollowGenes()})},error:function(t,e){return e.suppressAppMessages=!0,App.initPublicApp()}})},setSignedInCookie:function(t){return null==t&&(t=!1),App.createCookie("signed_in",t.toString(),365)},initClickCapture:function(){var t=this;return $(document).on("click","a:not(.refresh)[href^='/']",function(e){var r,o,i;return null==("undefined"!=typeof App&&null!==App?App.router:void 0)?!0:(r=$(e.currentTarget).attr("href"),o=_.any(t.passThroughPaths,function(t){return r.indexOf(t)>=0}),e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||o?void 0:(e.preventDefault(),i=r.replace(/^\//,"").replace("#!/",""),App.router.navigate(i,{trigger:!0}),!1))}),$(document).on("click","a:not(.refresh)[href^='http']",function(t){var e,r,o,i,n;return e=$(t.target),i=/https?:\/\/([^\/]+)/,o=null!=(n=e.attr("href"))?n.match(i):void 0,r=[App.canonicalUrl,App.secureUrl,App.defaultUrl()],o&&!_.contains(r,o[0])&&e.attr("target","_blank"),!0})},initApp:function(t){return null==t&&(t=window.location.pathname),App.sharedInit(),App.showFlash()},initPublicApp:function(){var t=this;return this.$html.addClass("logged-out"),this.setSignedInCookie(!1),Analytics.registerCurrentUser(),404!==App.status&&500!==App.status?(this.currentUser=new App.Models.CurrentUser({followArtists:new App.Collections.FollowArtists,followArtistsFetched:!0,followGenes:new App.Collections.FollowGenes,followGenesFetched:!0,accountCreated:!1}),this.requestXAPP(function(){return"art.sy"===parseUri(window.location).queryKey.dns_source&&(t.redirectDialog=new App.Views.RedirectDialog,t.redirectDialog.render()),App.sharedInit(),App.showFlash(),t.loginSignupDialog=new App.Views.LoginSignupDialog,t.publicHeader=new App.Views.PublicHeader})):void 0},requestXAPP:function(t){var e,r=this;return t&&this.XAPPCallbacks.push(t),this.XAPP&&this.runXAPPCallbacks(),this.XAPP||this.requestingXAPP||"undefined"==typeof API||null===API?void 0:(this.requestingXAPP=!0,e="/api/v1/xapp_token?client_id="+API.client_id+"&client_secret="+API.client_secret,$.get(e,function(t){return r.XAPP=t,r.runXAPPCallbacks()}))},addXhrAuth:function(t){return t.setRequestHeader("X-XAPP-Token",App.XAPP.xapp_token)},runXAPPCallbacks:function(){var t,e,r,o,i;for(o=this.XAPPCallbacks,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(this.XAPPCallbacks.pop()());return i},redirectHashBang:function(){return window.location=window.location.hash.substring(2)},onHomepage:function(){return"/"===window.location.pathname&&""===window.location.hash},onLoginSignupPage:function(){if(this.onHomepage()&&null!=App.readCookie("log_in"))return!0;if(window.history&&window.history.pushState){if("/sign_up"===window.location.pathname||"/log_in"===window.location.pathname||"/forgot-password"===window.location.pathname)return!0}else if("#sign_up"===window.location.hash||"#log_in"===window.location.hash||"#forgot-password"===window.location.hash)return!0;return!1},sharedInit:function(){return this.router||(this.router=new App.Routers.Client),this.footer||(this.footer=new App.Views.Footer),this.header||(this.header=new App.Views.Header),this.searchForm||(this.searchForm=new App.Views.SearchForm),this.initClickCapture(),this.initAppMessages(),App.currentUser&&App.currentUser.get("is_slumming")&&App.showError(JST["templates/shared/slumming_notification"]()),null!=App.readCookie("impersonator_id")?App.showError(JST["templates/shared/impersonating_notification"]()):void 0},initAppMessages:function(){var t;return t=new App.Views.AppMessage,App.showMessage=function(e){return t.render(e,!0)},App.showHomepageMessage=function(e){return t.render(e,!1,"homepage","homepage_message",!0)},App.showError=function(e){return t.render(e,!1,"bad_news")},App.isMessageVisible=function(){return t.isVisible()},App.dismissMessages=function(){return t.dismiss()}},showFlash:function(){return Flash.transferFromCookies(),null!=Flash.data.error&&App.showError(Flash.data.error.toString().replace(/\+/g," ")),null!=Flash.data.notice?App.showMessage(Flash.data.notice.toString().replace(/\+/g," ")):void 0},showShareDialog:function(t){return this.shareDialog||(this.shareDialog=new App.Views.ShareDialog),this.shareDialog.show(t)},isLoggedIn:function(){return this.currentUser&&this.currentUser.accountCreated()},defaultUrl:function(){return window.location.origin},isSSL:function(){return"https:"===window.location.protocol},canonicalize:function(t){return App.canonicalUrl&&App.viaCdn?t.match(/https?:/)?t:App.canonicalUrl!==App.defaultUrl()?this.isSSL()?""+App.secureUrl+t:""+App.canonicalUrl+t:t:t},showCreateAccountDialog:function(t){return null==t&&(t={}),App.loginSignupDialog.hide(),_.delay(function(){return App.createAccountDialog||(App.createAccountDialog=new App.Views.CreateAccountDialog),t.email?App.createAccountDialog.showCreateAccountForm(t.email):t.provider?App.createAccountDialog.showFinishCreateAccountForm(t.name,t.email,t.provider):App.createAccountDialog.showCreateAccountForm(t.email)},300)},initDevice:function(){var t,e,r,o,i,n,s,a;return this.uagent=navigator.userAgent.toLowerCase(),t=this.uagent.search("android")>-1,r=this.uagent.search("ipad")>-1,o=this.uagent.search("iphone")>-1,i=this.uagent.search("ipod")>-1,e=this.uagent.search("bb10")>-1||this.uagent.search("blackberry")>-1,n=this.uagent.search("windows phone")>-1,this.IS_TABLET=r||t&&this.uagent.search("mobile")<0,this.IS_TABLET?(this.IS_PHONE=!1,a=document.querySelector("meta[name=viewport]"),a.setAttribute("content","width=1024, user-scalable=0")):this.IS_PHONE=o||i||n||e||t&&this.uagent.search("mobile")>-1,this.IS_MOBILE=this.IS_PHONE||this.IS_TABLET,this.IS_MOBILE_SAFARI=o||i||r,this.IS_PC=null!=window.navigator.appVersion.match(/Win|Linux|X11/i),this.IS_MAC=window.navigator.appVersion.match(/Mac/i)&&!this.IS_MOBILE,r?(s=/\os (\d+)/.exec(this.uagent),this.IS_IPAD_LT_IOS6=s&&s[1]&&Number(s[1])<6):this.IS_IPAD_LT_IOS6=!1},setDeviceClasses:function(){var t;return t=$("html"),$.browser.webkit&&t.addClass("webkit"),$.browser.mozilla&&t.addClass("mozilla"),$.browser.msie&&t.addClass("msie"),$.browser.safari&&t.addClass("safari"),"ontouchstart"in document.documentElement?void 0:t.addClass("no-touch")},markdownToHtml:function(t){return this.showdownConverter||(this.showdownConverter=new Showdown.converter),this.showdownConverter.makeHtml(t)},emailRegex:/^([a-zA-Z0-9_\+\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,numberToMoney:function(t){return t?App.formatNumber(t/100):""},calcScrollbarWidth:function(){var t,e,r;return e=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),r=t.innerWidth()-t.height(99).innerWidth(),e.remove(),r},pluralizeWithNumber:function(t,e){return 1===t?""+t+" "+e:""+t+" "+inflection.pluralize(e)},artsyNavigation:{hide:function(){return App.$body.addClass("hide_nav"),$("#frames").addClass("no_top_border"),$("#search_input").attr("disabled","disabled")},show:function(){return App.$body.removeClass("hide_nav"),$("#frames").removeClass("no_top_border"),$("#search_input").attr("disabled",!1)}}},_.extend(App,Backbone.Events),App.init()}.call(this),App.Constants={ADMIN_URL:"http://admin.artsy.net",CMS_URL:"http://cms.artsy.net"},function(){App.Mixins.BidArtwork={bidArtwork:function(t,e){var r;return App.currentUser.accountCreated()?(Analytics.funnel("Clicked bid on artwork",t),App.router.navigate("feature/"+e.get("id")+"/bid/"+t.get("id"),{trigger:!0})):null!=(r=App.loginSignupDialog)?r.show("bid"):void 0}}}.call(this),function(){App.Mixins.ArtworkColumns={artworkColumnMargin:40,artworkColumnWidth:195,maxArtworkWidth:260,minArtworkWidth:190,defaultArtworkColumns:[4,5,6,7],setupArtworkColumnRowWidth:function(){var t,e,r,o,i,n,s,a;for(App.IS_PHONE?(this.artworkRowWidth=150,this.artworkColumns=2,t=[2]):this.fixedWidth<1e3?(e=200,r=150,t=[3,4],this.artworkRowWidth=r):(e=this.maxArtworkWidth,r=this.minArtworkWidth,t=this.defaultArtworkColumns,this.artworkRowWidth=r),a=[],n=0,s=t.length;s>n;n++){if(o=t[n],i=Math.floor((this.fixedWidth-o*this.artworkColumnMargin)/o),i>r&&e>i){this.artworkRowWidth=i,this.artworkColumns=o;break}a.push(void 0)}return a}}}.call(this),function(){App.Mixins.SaleDialog={showDialog:function(t){return this.popup||($(".artwork_dialog").remove(),App.$body.append("<div class='artwork_dialog'></div>"),this.popup=new App.Views.SaleDialog({el:$(".artwork_dialog"),model:this.model})),this.popup.render(t),!1},showInquireDialog:function(){return this.showDialog("inquire")},showContactGalleryDialog:function(){return this.showDialog("contact")}}}.call(this),function(){var t=this;App.Mixins.AuctionPopover={showAuctionConfirmationDialog:function(e){return _.include(["bid","registration"],e)?(t.auctionConfirmationDialog||(t.auctionConfirmationDialog=new App.Views.AuctionConfirmationDialog({el:t.$(".auction_confirmation_dialog")})),t.auctionConfirmationDialog.renderDialog(e),t.auctionConfirmationDialog.show(),!1):void 0},renderConfirmationFromParams:function(t,e){return"confirm-bid"===(null!=e?e.subpage:void 0)&&(this.showAuctionConfirmationDialog("bid"),App.router.navigate(t,{trigger:!1,replace:!0})),"confirm-registration"===(null!=e?e.subpage:void 0)?(this.showAuctionConfirmationDialog("registration"),App.router.navigate(t,{trigger:!1,replace:!0})):void 0}}}.call(this),function(){App.Mixins.BackToTopArrow={backToTopArrowWidth:84,initializeFromFrame:function(t){var e=this;return this.contentDiv=t.contentDiv,App.$window.on("scroll."+App.currentFrameName,_.throttle(function(){return e.showHideArrow()},40)),App.$window.on("resize."+App.currentFrameName,_.debounce(function(){return e.positionArrow()},100)),App.router.viewState.once("frameUnload:"+App.currentFrameName,function(){return App.$window.off("."+App.currentFrameName)}),this.$arrow=this.$(".back_to_top"),this.$arrow.on("click",function(){return e.scrollToTop()}),this.positionArrow()},positionArrow:function(){var t;if(0!==this.$el.find(""+this.contentDiv).length)return t=this.$el.find(""+this.contentDiv).offset().left+this.$el.find(""+this.contentDiv).width()+this.backToTopArrowWidth,t+this.backToTopArrowWidth<App.$window.width()?(this.preventShowArrow=!1,this.$arrow.css({left:t})):(this.preventShowArrow=!0,this.hideArrow())},showHideArrow:function(){return this.arrowAnimating||this.preventShowArrow?void 0:this.navHeight+330<App.$window.scrollTop()?this.showArrow():this.hideArrow()},showArrow:function(){var t=this;return this.arrowAnimating=!0,this.$arrow.animate({top:"74px"},300,function(){return t.arrowAnimating=!1}).addClass("visible")},hideArrow:function(){var t=this;return this.arrowAnimating=!0,this.$arrow.animate({top:"0px"},300,function(){return t.arrowAnimating=!1}).removeClass("visible")},scrollToTop:function(){return this.scrollToPosition(0),this.hideArrow()},scrollToPosition:function(t){var e=this;return this.animating=!0,$("html, body").animate({scrollTop:t},function(){return e.animating=!1})}}}.call(this),function(){App.Mixins.CoverArt={minCoverHeight:220,maxCoverHeight:440,percentBrowserHeight:.45,getCoverHeight:function(){var t,e,r,o,i,n;return App.IS_PHONE?200:(r=this.maxCoverHeight,o=this.minCoverHeight,i=this.percentBrowserHeight,t=App.currentUser.accountCreated()?0:75,n=App.$window.height()-t,e=Math.floor(n*i),e>r?r:e)},renderCoverArt:function(){var t,e=this;return t=this.getCoverHeight(),t>this.minCoverHeight||App.IS_PHONE?this.$coverArt.show().heroUnit({$img:this.$coverArt.find("img:not(.skip-cover)"),height:t,afterImageLoadcont:function(){return e.afterCoverImageLoadcont()}}):this.$coverArt.hide()},destroyCoverArt:function(){return this.$coverArt.heroUnit("destroy")},afterCoverImageLoadcont:function(){return this.$coverArt.find("img").addClass("visible")}}}.call(this),function(){App.Mixins.FixedDimensionsThumbnails={setupFixedDimensionsThumbnails:function(){return this.$(".fixed_dimensions img").each(function(t,e){var r,o,i,n,s,a,l;return r=$(e),i=r.width(),o=r.height(),a=r.parent().width(),s=r.parent().height(),i/o>a/s?(n=(a-s*i/o)/2,r.css({left:""+n+"px",height:"100%"})):(l=(s-a*o/i)/2,r.css({top:""+l+"px",width:"100%"})),r.show()})}}}.call(this),function(){App.Mixins.InitializeArtworks={analyticsRemoveMessage:"Removed artwork from collection",analyticsSaveMessage:"Added artwork to collection",initializeArtworksFromDom:function(){var t,e,r,o,i;return e=this.$(".uninitialized"),e.length>0?(o=function(){var o,n,s;for(s=[],o=0,n=e.length;n>o;o++)r=e[o],t=$(r),i=App.Repositories.Artworks.get(t.attr("data-artwork")),i?s.push(new App.Views.ArtworksListItem({model:i,el:t,analyticsRemoveMessage:this.analyticsRemoveMessage,analyticsSaveMessage:this.analyticsSaveMessage})):s.push(void 0);return s}.call(this),this.initializeImpressionTracking(_.compact(o),e),this.syncSavedArtworks()):void 0},initializeArtworks:function(t){var e,r,o,i,n;return e=this.$("figure.uninitialized"),e.length>0?(n=function(){var n,s,a;for(a=[],o=n=0,s=t.length;s>n;o=++n)r=t[o],a.push(i=new App.Views.ArtworksListItem({model:r,el:e[o],analyticsRemoveMessage:this.analyticsRemoveMessage,analyticsSaveMessage:this.analyticsSaveMessage}));return a}.call(this),this.initializeImpressionTracking(n,e),this.syncSavedArtworks()):void 0},syncSavedArtworks:function(){var t;return t=App.currentUser.defaultArtworkCollection(),t?_.delay(function(){return t.syncSavedArtworks()},500):void 0},initializeImpressionTracking:function(t,e){var r,o;if(null!=t?t.length:void 0)return o=e.offset().top,r=t[0].model.get("id"),App.$window.on("scroll."+r,_.throttle(function(){var e;return App.$window.scrollTop()+App.$window.height()>o?(App.$window.off("."+r),e=_.compact(_.map(t,function(t){return t.$el.is(":visible")?t.model.get("id"):void 0})),App.viewedArtworkIds=App.viewedArtworkIds.concat(e)):void 0},500)),App.router.viewState.once("frameUnload:"+App.currentFrameName,function(){return App.$window.off("."+r)})}}}.call(this),function(){App.Mixins.RegisterToBid={registerToBid:function(t,e){return null==e&&(e={}),App.isLoggedIn()?t.get("currentUserRegistered")?void 0:App.currentUser.fetchCreditCards({success:function(r){return r.length>0?t.createBidder({success:function(){return t.set("currentUserRegistered",!0),"function"==typeof e.onSuccess?e.onSuccess():void 0}}):"function"==typeof e.onCreditCardRequired?e.onCreditCardRequired(t):void 0}}):(App.loginSignupDialog.show("registerToBid",{redirectUrl:"/auction-registration/"+t.get("id")+"?redirect_uri="+escape(window.location)}),void 0)},renderCreditCardForm:function(t){var e;return e="/auction-registration/"+t.get("id")+"?redirect_uri="+escape(window.location),App.router.navigate(e,{trigger:!0})}}}.call(this),function(){App.Mixins.ShareButtons={initializeShareButtons:function(t){return null==t&&(t={}),this.facebookCustom=new App.Views.FacebookCustom({el:this.$(".shares .facebook_like"),url:t.url,emailForm:this.$(".shares .email .popover")}),this.facebookCustom.render(),this.tweet=new App.Views.TwitterCustom({el:this.$(".shares .tweet"),url:t.url,text:t.text,emailForm:this.$(".shares .email .popover")}),this.tweet.render(),t.imageUrl?(this.pinterest=new App.Views.PinterestCustom({el:this.$(".shares .pin"),description:t.text,url:t.url,emailForm:this.$(".shares .email .popover"),media:t.imageUrl}),this.pinterest.render()):void 0}}}.call(this),function(){App.Mixins.ValidateBid={bidNotNumberError:"Your bid must be a number in US dollars like 12345.",pleaseEnterBidError:"Please enter a bid like 12345.",minimumBidError:function(t){return"Please enter a bid of $"+App.numberToMoney(t)+" or larger."},showBidError:function(t){return this.$(".errors").html(t).show(),this.$(".bid-input-container input").addClass("has_error")},validateBid:function(t,e){var r;return null==t&&(t=""),null==e&&(e=0),r=Number(t.replace("$","").split(",").join("").trim()),r=100*r,(null!=r?r.length:void 0)<1||1>r?(this.showBidError(this.minimumBidError(e)),!1):isNaN(Number(r))?(this.showBidError(this.bidNotNumberError),!1):e&&e>r?(this.showBidError(this.minimumBidError(e)),!1):r}}}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collection=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.nextPage=1,o.prototype.defaultPageSize=10,o.prototype.defaultSortOrder=null,o.prototype.doneFetching=!1,o.prototype.fetchPage=function(t,e,r){var o,i,n=this;return null==t&&(t=1),null==e&&(e=50),o=_.result(this,"url"),i={offset:(t-1)*e,size:e},this.defaultSortOrder&&(i.sort=this.defaultSortOrder),o=$.param.querystring(o,i),$.ajax({type:"GET",url:o,success:function(t,e){var o;return o=n.parse(t,e),null!=r?r.success(o):void 0}})},o.prototype.fetchNextPage=function(t){var e=this;if(!this.fetching)return this.fetching=!0,this.fetchPage(this.nextPage,this.defaultPageSize).then(function(r){return e.add(r),App.Repositories.Artworks.add(r),e.fetching=!1,r.length<e.defaultPageSize?(e.doneFetching=!0,null!=t&&"function"==typeof t.success&&t.success(r)):e.nextPage=e.nextPage+1,r})},o.prototype.fetchAllNextPage=function(t){var e=this;if(!this.fetching)return this.fetching=!0,this.fetchPage(this.nextPage,this.defaultPageSize).then(function(r){return e.add(r),App.Repositories.Artworks.add(r),e.fetching=!1,r.length<e.defaultPageSize?(null!=t&&t.success(),r):(e.nextPage=e.nextPage+1,e.fetchAllNextPage(t))})},o.prototype.fetchAllPages=function(t){return this.fetching?void 0:(this.remove(this.models),this.fetchAllNextPage(t))},o.prototype.hasAttrs=function(t){var e,r,o,i;for(i=this.models,r=0,o=i.length;o>r;r++)if(e=i[r],!e.hasAttrs(t))return!1;return this.length?!0:!1},o.fetchFromUrl=function(t,e){var r;return r=new this,r.url=t,null!=e&&"function"==typeof e.preload&&e.preload(),r.fetch(e),r},o.initWithData=function(t){var e;return e=new this,e.add(e.parse(t)),e},o}(Backbone.Collection)}.call(this),function(){App.Repository={urlCache:{},getOrFetch:function(t,e,r){var o;return o=this.get(t),null!=o?null==e||o.hasAttrs(e)?this._fakeSuccess(r,o):(null!=r&&"function"==typeof r.preload&&r.preload(),o.fetch(r)):(o=new this.model({id:t}),null!=r&&"function"==typeof r.preload&&r.preload(),o.fetch(r),this.add(o)),o},getUC:function(t,e){var r,o;return null==e&&(e={}),null==(o=e.id)&&(e.id=t),r=this.get(t),null!=r?r.moreData(e)||r.set(e):e.modelName?this.add(e):(r=new this.model(e),this.add(r)),r},getUCC:function(t){var e,r,o,i;if(null!=t.models)return t;for(e=new this.collectionClass,o=0,i=t.length;i>o;o++)r=t[o],null!=r&&e.add(this.getUC(r.id,r));return e},cacheByUrl:function(t,e){return this.urlCache[t]=e},getFromUrl:function(t,e){var r,o=this;return null==this.urlCache[t]?(null!=e&&"function"==typeof e.preload&&e.preload(),r=this.collectionClass.fetchFromUrl(t,{success:function(r,i){return o._fakeSuccess(e,r,i),o.getUCC(r.models),o.urlCache[t]=r,r},error:function(t,r){return null!=e?"function"==typeof e.error?e.error(t,r):void 0:void 0}})):(this._fakeSuccess(e,this.urlCache[t]),this.urlCache[t])},_fakeSuccess:function(t,e,r){return null!=t?"function"==typeof t.success?t.success(e,r):void 0:void 0}},App.Repository.extend=function(t){var e,r;return e=new t,r=_.extend(e,App.Repository),r.collectionClass=t,r}}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.View=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.getThenRender=function(t,e,r){var o,i,n=this;return i=t.pluralize().camelize().ucFirst(),o=$.Deferred(),this.model=App.Repositories[i].getOrFetch(e,r,{preload:function(){return n.renderPreloader()},success:function(){return _.defer(function(){return n.render(),n.delegateEvents(),o.resolve()})},error:function(){return n.renderError(),o.reject()}}),o.promise()},o.prototype.getFromUrlThenRender=function(t,e,r){var o,i=this;return this.fetchedFromUrl=e,o=t.pluralize().camelize().ucFirst(),this.collection=App.Repositories[o].getFromUrl(e,{preload:function(){return i.renderPreloader()},success:function(){return _.defer(function(){return i.render(),i.delegateEvents(),null!=(null!=r?r.success:void 0)?r.success():void 0})},error:function(){return i.renderError(),null!=(null!=r?r.error:void 0)?r.error():void 0}}),this},o.prototype.renderError=function(){},o.prototype.renderPreloader=function(){},o.prototype.toString=function(){return"App.Views."+this.className},o.prototype.fadeOut=function(t,e){var r=this;return null==t&&(t="fast"),this.$el.fadeOut(t,function(){return null!=e?e.apply(r):void 0})},o.prototype.fadeIn=function(t,e){return null==t&&(t="fast"),this.$el.fadeIn(t,function(){return null!=e?e():void 0})},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.DomainAbstract=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.getToString=function(t){var e;return null!=(e=this.get(t))?e:""},o.prototype.getRawToString=function(t){var e;return null!=(e=this.getRaw(t))?e:""},o.prototype.get=function(t,e){var r;return null==e&&(e={}),r=o.__super__.get.apply(this,arguments),"string"!=typeof r||(null!=e?e.htmlSafe:void 0)?r:this.escapeHtml(r)},o.prototype.getRaw=function(t){return Backbone.Model.prototype.get.call(this,t)},o.prototype.getAsSafeHtml=function(t){var e,r;return e=null!=(r=this.get(t))?r:"",App.markdownToHtml(e)},o.prototype.escapeHtml=function(t){return(t+"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/,"&#x27;")},o.prototype.setBlank=function(t){var e,r,o,i,n;e=function(t){return null==t||0===t.length},n=[];for(r in t)i=t[r],e(this.get(r))&&!e(i)?(o={},o[r]=i,n.push(this.set(o))):n.push(void 0);return n},o.prototype.fetch=function(t){return null!=t&&null!=t.properties?(null==this.originalUrl&&(this.originalUrl=this.url),this.url=function(){return""+this.originalUrl()+"?properties="+t.properties},o.__super__.fetch.call(this,t),this.url=this.originalUrl):o.__super__.fetch.call(this,t)},o.prototype.reset=function(t){var e,r,o,i,n;for(null==t&&(t={}),o=_.extend({},_.result(this,"defaults"),t),r=this.keys(),i=0,n=r.length;n>i;i++)e=r[i],e in o||e===this.idAttribute||this.unset(e);return this.set(o)},o.prototype.moreData=function(t){return _.keys(this.toJSON()).length>_.keys(t).length},o.prototype.hasAttrs=function(t){return _.isEqual(_.intersection(_.keys(this.attributes),t).sort(),t.sort())},o.prototype.set=function(t,e,r){var i;return _.isObject(t)?(i=t,r=e):(i={},i[t]=e),i=this._setEmbeddedRelations(i),o.__super__.set.call(this,i,r)},o.prototype._setEmbeddedRelations=function(t){var e,r,o,i,n,s;for(i=this.relations||[],r=0,o=i.length;o>r;r++)if(e=i[r],t[e.key]&&"function"!=typeof t[e.key].get)switch(e.type){case"HasOne":if(!App.Repositories[e.model.pluralize()])throw new Error("App.Repositories."+e.model.pluralize()+" does not exist!");t[e.key]=App.Repositories[e.model.pluralize()].getUC((null!=(n=t[e.key])?n.id:void 0)||(null!=(s=this.get(e.key))?"function"==typeof s.get?s.get("id"):void 0:void 0),t[e.key]);break;case"HasMany":if(!App.Repositories[e.model])throw new Error("App.Repositories."+e.model+" does not exist!");t[e.key]=App.Repositories[e.model].getUCC(t[e.key]);break;default:throw new Error("Unknown relation type: "+e.type)}return t},o.prototype.getRelationsByAttr=function(){var t,e,r,o,i;for(t={},i=this.relations,r=0,o=i.length;o>r;r++)e=i[r],t[e.key]=e;return t},o.prototype.toJSON=function(t){var e,r,i,n,s;if(r=o.__super__.toJSON.call(this),(null!=t?t.flatten:void 0)&&this.relations){n=this.getRelationsByAttr(),i={};for(e in r)s=r[e],s instanceof Backbone.Model||s instanceof Backbone.Collection?n[e].embedded&&(i[e]=s.toJSON(t)):i[e]=s}else i=r;return i},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Frame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.containerEl="#frames",o.prototype.animating=!1,o.prototype.initialize=function(){if(null==this.frameName)throw"You must define a `frameName` (associated with the route name)"},o.prototype.unrender=function(){return this.options.viewState.unrenderFrame(this.frameName)},o.prototype.scrollTopVal=0,o.prototype.load=function(t){var e;try{this.onLoad()}catch(r){e=r,"undefined"!=typeof console&&null!==console&&console.log(e),this.options.viewState.unrenderFrame(this.frameName)}this.$el.show();try{return this.afterLoad()}catch(r){if(e=r,this.options.viewState.unrenderFrame(this.frameName),"undefined"!=typeof console&&null!==console)return console.log(e)}finally{null!=t&&t()}},o.prototype.unload=function(t){var e,r=this;try{this.onUnload()}catch(o){e=o,"undefined"!=typeof console&&null!==console&&console.log(e),this.options.viewState.unrenderFrame(this.frameName)}return this.$el.fadeOut(160,function(){try{return r.afterUnload()}catch(o){return e=o,"undefined"!=typeof console&&null!==console&&console.log(e),r.options.viewState.unrenderFrame(r.frameName)}finally{null!=t&&t()}})},o.prototype.scrollToPosition=function(t){var e=this;return this.animating=!0,$("html, body").animate({scrollTop:t},function(){return e.animating=!1})},o.prototype.scrollToSection=function(t){return null!=(null!=t?t.offset():void 0)?this.scrollToPosition(t.offset().top-100):void 0},o.prototype.scrollToTop=function(){return this.scrollToPosition(0)},o.prototype.onLoad=function(){},o.prototype.afterLoad=function(){},o.prototype.onUnload=function(){},o.prototype.afterUnload=function(){},o.prototype.setDocumentTitle=function(){return App.$document.attr("title",null!=this.documentTitle?this.documentTitle:"Artsy - Discover, Research, and Collect the World's Best Art Online")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Router=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.currentRoute=null,o.prototype.initialize=function(){var t=this;return _.defer(function(){return t.startHistory()})},o.prototype.startHistory=function(){return Backbone.history.start()},o}(Backbone.Router)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.TabbedFrame=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabViews={},i.prototype.render=function(){return this.tabViews={}},i.prototype.initialize=function(){var t;if(i.__super__.initialize.apply(this,arguments),t=_.result(this,"defaultTabName"),null==t)throw"You must define a `defaultTabName`";if(null==this.baseUrl)throw"You must define a `baseUrl`";if(null==this.tabs)throw"You must define set of tabs";if(null==this.tabs[t])throw"You must define an init method for your default tab";return this.tabNames=_.keys(this.tabs).join(" ")},i.prototype.selectTab=function(t,e,r){var o,i,n,s,a;return null==e&&(e=!0),null==r&&(r=!1),t&&t===this.currentTabName?void 0:(null!=t?e&&App.router.navigate(""+this.baseUrl+"/"+t,{trigger:!1}):t=_.result(this,"defaultTabName"),this.currentTab&&("function"==typeof(o=this.currentTab).onUnload&&o.onUnload(),this.lastScrollTop=App.$window.scrollTop()),this.tabNames&&this.$el.removeClass(this.tabNames),this.$el.addClass(t),this.currentTabName=t,this.loadTab(t,r),(null!=(i=App.router.viewState)?null!=(n=i.frames[App.currentFrameName])?n.params:void 0:void 0)?null!=(s=App.router.viewState)?null!=(a=s.frames[App.currentFrameName])?a.params.tab=t:void 0:void 0:void 0)},i.prototype.loadTab=function(t,e){var r,o,i;return this.lastScrollTop=App.$window.scrollTop(),r=_.result(this,"inactiveSectionSelector"),r?this.$(""+r).hide():this.$("section:not(."+t+")").hide(),this.$(".tabs .active").removeClass("active"),this.tabViews[t]?"function"==typeof(o=this.tabViews[t]).onLoad&&o.onLoad():this.tabs[t]?this.tabViews[t]=this.tabs[t].call(this):(this.rendered=!1,this.currentTab=void 0,App.router.navigate(""+this.baseUrl,{trigger:!0}),this.selectTab()),this.currentTab=this.tabViews[t],this.$(".tabs ."+t).addClass("active"),null!=(i=this.currentTab)&&i.$el.show(),$("html, body").animate({scrollTop:this.lastScrollTop},0),e?this.trigger("tabChange",t):void 0},i.prototype.onLoad=function(){var t;return null!=(t=this.currentTab)?"function"==typeof t.onLoad?t.onLoad():void 0:void 0},i.prototype.onUnload=function(){var t;return this.scrollTopVal=App.$window.scrollTop(),null!=(t=this.currentTab)?"function"==typeof t.onUnload?t.onUnload():void 0:void 0},i.prototype.resetTabViews=function(){var t=this;return _.each(_.keys(this.tabs),function(e){return t.tabViews[e]?t.tabViews[e].remove():void 0}),delete this.tabViews,this.tabViews={}},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Models.Post=function(r){function i(){return this.save=e(this.save,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.urlRoot=function(){return"/api/v1/post/"},i.prototype.relations=[{type:"HasOne",key:"profile",model:"Profile"},{type:"HasMany",key:"attachments",model:"PostAttachments"},{type:"HasMany",key:"reposts",model:"Reposts"}],i.prototype.initialize=function(t,e){return null==e&&(e={}),null==this.get("reposts")&&this.set({reposts:new App.Collections.Reposts}),this.setLayout(),this.bind("change",this.setLayout,this),i.__super__.initialize.call(this,t,e)},i.prototype.get=function(t){return i.__super__.get.call(this,t,{htmlSafe:!0})},i.prototype.ensureRepostsFetched=function(t){var e=this;return this.get("reposts_count")>0&&0===this.get("reposts").length?$.ajax("/api/v1/reposts",{data:{post_id:this.get("id")},success:function(r){return _.each(r,function(t){return e.get("reposts").add(new App.Models.Repost(t))}),"function"==typeof t?t(e.get("reposts")):void 0}}):"function"==typeof t?t(this.get("reposts")):void 0},i.prototype.artworks=function(){var t;return t=this.get("attachments").filter(function(t){return"PostArtwork"===t.get("type")}),_.map(t,function(t){return t.get("artwork")})},i.prototype.relatedArtists=function(t){var e;return e=_.compact(this.artworks().map(function(t){return t.get("artist")})),new App.Collections.Artists(e.slice(0,t))},i.prototype.images=function(){return this.get("attachments").filter(function(t){return"PostImage"===t.get("type")})},i.prototype.defaultImage=function(){var t;return(null!=(t=_.first(this.artworks()))?t.primaryImage():void 0)||_.first(this.images())||new App.Models.DefaultImage
},i.prototype.links=function(){return this.get("attachments").filter(function(t){return"PostLink"===t.get("type")})},i.prototype.addArtwork=function(t,e){var r,o,i=this;return o=!1,_.each(this.artworks(),function(e){return o?void 0:o=t.get("id")===e.get("id")}),o?void 0:(r=new App.Models.PostArtwork({type:"PostArtwork",position:this.get("attachments").length+1}),r.attributes.artwork=t,this.get("attachments").add(r),$.ajax(""+this.url()+"/artwork/"+t.get("id"),{type:"POST",success:function(t){var o;return o=t.attachments[i.get("attachments").length-1],r.set({id:o.id,position:o.position}),i.get("attachments").trigger("reset"),null!=e?e.success():void 0},error:null!=e?e.error:void 0}))},i.prototype.removeAttachment=function(t){var e;if(t){switch(this.get("attachments").remove(t),"function"==typeof t.get?t.get("type"):void 0){case"PostArtwork":e=""+this.url()+"/artwork/"+t.get("artwork").get("id");break;case"PostImage":e=""+this.url()+"/image/"+t.get("id");break;case"PostLink":e=""+this.url()+"/link/"+t.get("id");break;case"PostEmbed":e=""+this.url()+"/embed/"+t.get("id")}return $.ajax(e,{type:"DELETE"})}},i.prototype.save=function(t,e){return this.isNew()?i.__super__.save.call(this,t,e):$.ajax({type:"PUT",url:this.url(),data:{id:this.get("id"),title:this.get("title"),body:this.getRaw("body"),published:this.get("published")},success:e.success,error:e.error})},i.prototype.feature=function(t){return $.ajax("/api/v1/post/"+this.get("id"),{type:"PUT",data:{featured:!0},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},i.prototype.unfeature=function(t){return $.ajax("/api/v1/post/"+this.get("id"),{type:"PUT",data:{featured:!1},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},i.prototype.flag=function(t){return $.ajax("/api/v1/post/"+this.get("id"),{type:"PUT",data:{flagged:!0},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},i.prototype.unflag=function(t){return $.ajax("/api/v1/post/"+this.get("id"),{type:"PUT",data:{flagged:!1},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},i.prototype.repost=function(t){var e,r=this;return e=new App.Models.Repost({profile:App.currentProfile}),this.get("reposts").add(e),$.ajax("/api/v1/repost",{type:"POST",data:{post_id:this.get("id")},success:function(o,i,n){return r.get("reposts").get(e.cid).set(o),null!=t?t.success(o,i,n):void 0},error:null!=t?t.error:void 0})},i.prototype.unrepost=function(t,e){return this.get("reposts").remove(t),$.ajax("/api/v1/repost/"+t.get("id"),{type:"DELETE",success:null!=e?e.success:void 0,error:null!=e?e.error:void 0})},i.prototype.hasContent=function(){var t;return(null!=(t=this.getRaw("body"))?t.length:void 0)>0||this.hasAttachments()},i.prototype.hasImagesOrVideos=function(){var t;return(null!=(t=this.links())?t.length:void 0)>0||this.hasImages()},i.prototype.hasImages=function(){var t;return(null!=(t=this.images())?t.length:void 0)>0},i.prototype.hasAttachments=function(){var t;return(null!=(t=this.get("attachments"))?t.length:void 0)>0},i.prototype.hasArtworks=function(){var t;return(null!=(t=this.get("artworks"))?t.length:void 0)>0},i.prototype.searchPath=function(){return"/post/"+this.get("id")},i.prototype.getShareableTitle=function(){var t,e;return this.get("title")&&(null!=(t=this.get("profile"))?t.displayName():void 0)?""+this.get("profile").displayName()+": "+this.get("title"):(null!=(e=this.get("profile"))?e.displayName():void 0)?""+this.get("profile").displayName()+" on Artsy":this.get("title")?""+this.get("title"):"Post on @artsy"},i.prototype.veryLargeTextMax=30,i.prototype.largeTextMax=300,i.prototype.setLayout=function(){var t,e,r;return t=this.get("title")?this.hasArtworks()||this.hasAttachments()?"":"right_body":(e=null!=(r=this.get("body"))?r.length:void 0,this.hasArtworks()||this.hasAttachments()?e<this.veryLargeTextMax?"very_large_text":300>e?"large_text":"":e<2*this.veryLargeTextMax?"very_large_text wide_body":e<2*this.largeTextMax?"large_text wide_body":"right_body"),this.set({layout:t})},i.prototype.getTextWidth=function(t){var e;return(null!=(e=this.get("layout"))?e.indexOf("wide_body"):void 0)>-1?484+t:""},i.prototype.likeSummary=function(){return null!=this.get("likes_count")&&this.get("likes_count")>0?App.pluralizeWithNumber(this.get("likes_count"),"Like"):""},i.prototype.incrementLikes=function(t){var e;return null==t&&(t=1),e=(this.get("likes_count")||0)+t,this.set({likes_count:0>e?0:e})},i.prototype.ensureFeatureArtworksFetched=function(t){var e=this;return this.get("feature_artworks")?"function"==typeof t?t(this.get("feature_artworks")):void 0:App.Collections.Artworks.fetchFromUrl("/api/v1/post/"+this.get("id")+"/features/artworks",{success:function(r){return e.set("feature_artworks",r),"function"==typeof t?t(r):void 0}})},i.prototype.ensureFeatureArtistsFetched=function(t){var e=this;return this.get("feature_artists")?"function"==typeof t?t(this.get("feature_artists")):void 0:App.Collections.Artists.fetchFromUrl("/api/v1/post/"+this.get("id")+"/features/artists",{success:function(r){return e.set("feature_artists",r),"function"==typeof t?t(r):void 0}})},i.prototype.fetchSets=function(){var t=this;return App.Repositories.OrderedSets.fetchItemsByOwner("Post",this.get("id")).then(function(e){return t.set("sets",e)})},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.User=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return"/api/v1/user/"+this.get("id")},o.prototype.relations=[{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.defaults={artworkCollections:[]},o.prototype.fetchWithProfile=function(t){return this.fetch({success:function(e){return e.set({profile:{id:e.get("default_profile_id")}}),e.get("profile").fetch({success:function(){return null!=t?"function"==typeof t.success?t.success(e):void 0:void 0},error:function(e,r){return null!=t?"function"==typeof t.error?t.error(e,r):void 0:void 0}})},error:function(e,r){return null!=t?"function"==typeof t.error?t.error(e,r):void 0:void 0}})},o.prototype.initializeDefaultArtworkCollection=function(t){var e;return(null!=(e=this.get("artworkCollections"))?e.length:void 0)>0||this.set({artworkCollections:[new App.Models.ArtworkCollection({userId:this.get("id")})]}),this.defaultArtworkCollection.fetched?void 0:this.defaultArtworkCollection().fetch(t)},o.prototype.defaultArtworkCollection=function(){return this.get("artworkCollections")[0]},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.ArtworkFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.defaults={priceBuckets:{},relatedGenes:{},mediums:{},colors:{},dimensions:{},genes:{},artworks:{},page:1,total:0,selectedGene:!1,selectedSort:"-date_added",selectedColor:!1,selectedMedium:!1,selectedDimensions:!1,selectedPriceBucket:!1,selectedRelatedGene:!1,filteringAvailable:!0,canFetchSuggestions:!0},o.prototype.currentRequest="",o.prototype.requestCount=0,o.prototype.emptyResults=0,o.prototype.pageSize=20,o.prototype.speed=260,o.prototype.baseUrl="/api/v1/search/filtered",o.prototype.params={},o.prototype.route="filter/artworks",o.prototype.acceptedFrameName="filterArtworks",o.prototype.initialize=function(t){var e=this;return o.__super__.initialize.apply(this,arguments),null!=(null!=t?t.params:void 0)&&(this.params=$.deparam(t.params)),null!=(null!=t?t.route:void 0)&&(this.route=t.route),null!=(null!=t?t.acceptedFrameName:void 0)&&(this.acceptedFrameName=t.acceptedFrameName),this.baseUrl=null!=(null!=t?t.geneId:void 0)?""+this.baseUrl+"/gene/"+t.geneId:null!=(null!=t?t.tagId:void 0)?""+this.baseUrl+"/tag/"+t.tagId:null!=(null!=t?t.fairId:void 0)?""+this.baseUrl+"/fair/"+t.fairId:""+this.baseUrl+"/main",this.set({artworks:new App.Collections.Artworks},{silent:!0}),this.bind("change:selectedGene",this.onSelectionChange,this),this.bind("change:selectedSort",this.onSelectionChange,this),this.bind("change:selectedColor",this.onSelectionWithFilterChange,this),this.bind("change:selectedMedium",this.onSelectionWithFilterChange,this),this.bind("change:selectedDimensions",this.onSelectionWithFilterChange,this),this.bind("change:selectedPriceBucket",this.onSelectionWithFilterChange,this),this.bind("change:selectedRelatedGene",this.onSelectionWithFilterChange,this),(null!=t?t.skipInitialTrigger:void 0)||(this.triggerSelectionOnce=_.once(function(){return e.trigger("change:selection")})),$.get(""+this.baseUrl+"/options",function(t){return e.processParams(),e.processOptions(t),e.getSuggestions()}).error(function(t){return t.suppressAppMessages=!0,e.set({filteringAvailable:!1})})},o.prototype.setNewParams=function(t){return this.params=$.deparam(t),this.processParams(!1)},o.prototype.triggerOptionsUpdate=function(){return this.trigger("change:mediums"),this.trigger("change:colors"),this.trigger("change:dimensions"),this.trigger("change:priceBuckets"),this.trigger("change:relatedGenes")},o.prototype.getSuggestions=function(){var t=this;if(this.get("canFetchSuggestions"))return $.get(""+this.baseUrl+"/suggest/?"+this.selectionParams(),function(e){return 0===e.total&&""===t.selectionParams()?t.set({filteringAvailable:!1}):(t.set({filteringAvailable:!0}),_.once(function(){return t.trigger("change:filteringAvailable")})(),t.processCounts(e))})},o.prototype.getArtworks=function(){var t,e=this;return t=""+this.baseUrl+"?"+this.selectionParams(!0),this.currentRequest!==t&&this.get("canFetchSuggestions")?(this.currentRequest=t,this.requestCount=this.requestCount+1,App.Collections.Artworks.fetchFromUrl(this.currentRequest,{success:function(t){return e.currentRequest="",e.emptyResults=0===t.length?e.emptyResults+1:0,App.Repositories.Artworks.add(t.models),e.set({artworks:t}),App.router.viewState.currentFrame===e.acceptedFrameName&&-1!==window.location.pathname.indexOf(e.route)?App.router.navigate("/"+e.route+"/"+e.selectionParams(!0),{trigger:!1,replace:!0}):void 0},error:function(){return e.currentRequest=""}})):void 0},o.prototype.getNextPage=function(){return this.isLastPage()?void 0:(this.set({page:parseInt(this.get("page"))+1}),this.getArtworks())},o.prototype.isLastPage=function(){return this.get("artworks").length===this.get("total")||this.emptyResults>1||0===this.get("artworks").length},o.prototype.processOptions=function(t){var e,r,o,i,n,s,a=this;return e={},null!=t.color&&_.each(t.color,function(t){return"*"!==t?e[t]={id:t,count:0}:void 0}),o={},null!=t.medium&&_.each(t.medium,function(t,e){return"*"!==t?o[t]={id:t,label:e,count:0}:void 0}),r={},null!=t.dimension&&_.each(t.dimension,function(t){return"*"!==t?r[t]={id:t,val:parseInt(t),count:0}:void 0}),s={},null!=t.related_genes&&_.each(t.related_genes,function(t,e){return s[t]={id:t,label:e,count:0}}),n={},i=[],i.push({id:"-1",val:-1,label:"$0"}),null!=t.price_bucket&&_.each(t.price_bucket,function(t){var e;return e=t.split(":"),null!=n[e[1]]||e[1]>75e4?void 0:(n[e[1]]=e,i.push({id:e[1],val:parseInt(e[1]),label:"$"+a.formatNumber(e[1])}))}),i.push({id:"1000000000000",val:1e12,label:"$1m+"}),this.set({mediums:o,colors:e,dimensions:r,priceBuckets:i,relatedGenes:s})},o.prototype.processCounts=function(t){var e,r,o,i,n,s,a,l,p=this;return e=this.get("colors"),_.size(e)>0&&(l=_.difference(_.keys(this.get("colors")),_.keys(t.color)),t.color||(l=_.keys(this.get("colors"))),_.each(l,function(t){var r;return null!=(r=e[t])?r.count=0:void 0}),_.each(t.color,function(t,r){var o;return null!=(o=e[r])?o.count=t:void 0}),this.trigger("change:colors")),i=this.get("mediums"),_.size(i)>0&&(s=this.get("selectedMedium"),l=_.difference(_.keys(i),_.keys(t.medium)),_.each(l,function(t){var e;return null!=(e=i[t])?e.count=0:void 0}),_.each(t.medium,function(t,e){var r;return null!=(r=i[e])?r.count=p.formatNumber(t):void 0}),s&&(i[s].count=this.formatNumber(t.total)),this.trigger("change:mediums")),r=this.get("dimensions"),s=this.get("selectedDimensions"),l=_.difference(_.keys(r),_.keys(t.dimension||[])),_.each(l,function(t){var e;return null!=(e=r[t])?e.count=0:void 0}),null!=t.dimension&&_.each(t.dimension,function(t,e){var o;if("*"!==e)return null!=(o=r[e])?o.count=t:void 0}),this.trigger("change:dimensions"),n=this.get("relatedGenes"),_.size(n)>0&&(s=this.get("selectedRelatedGene"),l=_.difference(_.keys(n),_.keys(t.related_gene)),_.each(l,function(t){var e;return null!=(e=n[t])?e.count=0:void 0}),_.each(t.related_gene,function(t,e){var r;return null!=(r=n[e])?r.count=p.formatNumber(t):void 0}),s&&(n[s].count=this.formatNumber(t.total)),this.trigger("change:relatedGenes")),o={},this.get("selectedMedium")&&(a=this.get("selectedGene"),_.each(t.filter,function(e,r){return o[e.s]={id:e.s,label:r,count:e.c},e.s===a?t.total=e.c:void 0})),this.set({genes:o,total:t.total}),this.get("total")===t.total&&this.trigger("change:total"),"function"==typeof this.triggerSelectionOnce?this.triggerSelectionOnce():void 0},o.prototype.processParams=function(t){var e;return null==t&&(t=!0),this.params?(e={},null!=this.params.filter&&(e.selectedGene=this.params.filter),null!=this.params.sort&&(e.selectedSort=this.params.sort),null!=this.params.color&&(e.selectedColor=this.params.color),null!=this.params.medium&&(e.selectedMedium=this.params.medium),null!=this.params.dimension&&(e.selectedDimensions=this.params.dimension),null!=this.params.price_range&&(e.selectedPriceBucket=this.params.price_range),null!=this.params.related_gene&&(e.selectedRelatedGene=this.params.related_gene),this.set(e,{silent:t})):void 0},o.prototype.selectionParams=function(t){var e;return null==t&&(t=!1),e=[],this.get("selectedPriceBucket")&&e.push("price_range="+this.get("selectedPriceBucket")),this.get("selectedMedium")&&e.push("medium="+this.get("selectedMedium")),this.get("selectedColor")&&e.push("color="+this.get("selectedColor")),this.get("selectedDimensions")&&e.push("dimension="+this.get("selectedDimensions")),this.get("selectedGene")&&e.push("filter="+this.get("selectedGene")),this.get("selectedRelatedGene")&&e.push("related_gene="+this.get("selectedRelatedGene")),t&&(this.get("selectedSort")&&e.push("sort="+this.get("selectedSort")),this.get("page")&&e.push("page="+this.get("page"))),e.join("&")},o.prototype.onSelectionWithFilterChange=function(){return this.set({page:1}),this.trigger("change:selection"),this.get("selectedGene")&&this.set({selectedGene:!1}),this.getSuggestions()},o.prototype.onSelectionChange=function(){return this.set({page:1}),this.trigger("change:selection"),this.getSuggestions()},o.prototype.formatNumber=function(t){var e;for(t+="",e=/(\d+)(\d{3})/;t.match(e);)t=t.replace(e,"$1,$2");return t},o.prototype.reset=function(t){return this.set({page:1,selectedGene:!1,selectedSort:"-date_added",selectedColor:!1,selectedMedium:!1,selectedDimensions:!1,selectedPriceBucket:!1,selectedRelatedGene:!1},t)},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Authentication=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return"/api/v1/me/authentications/"+this.get("provider")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.AdditionalImage=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.modelName="AdditionalImage",i.prototype.sizes=[["small",{width:200,height:200}],["tall",{width:260,height:800}],["medium",{width:1/0,height:260}],["large",{width:640,height:640}],["larger",{width:1024,height:1024}]],i.prototype.initialize=function(){var t;return t=this.aspectRatio(),this.isLandscape=null!=t&&t>1,i.__super__.initialize.apply(this,arguments)},i.prototype.hasImage=function(t){return null==t&&(t="small"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){return null==t&&(t="small"),App.imageUrl(this,t)},i.prototype.aspectRatio=function(){return this.get("aspect_ratio")},i.prototype.publicVersions=function(){return _.without(this.get("image_versions"),"normalized")},i.prototype.imageUrlForMaxSize=function(){var t,e,r,o,i;for(e=this.publicVersions(),i=["larger","large","tall","medium","square","small"],r=0,o=i.length;o>r;r++)if(t=i[r],_.contains(e,t))return this.imageUrl(t);return null},i.prototype.isDownloadable=function(){return!(!this.get("downloadable")||!this.imageUrlForMaxSize())},i.prototype.imageUrlFor=function(t,e){var r,o,i,n;for(n=this.sizes,o=0,i=n.length;i>o;o++)if(r=n[o],t<=r[1].width&&e<=r[1].height&&_.indexOf(this.get("image_versions"),r[0])>=0)return this.imageUrl(r[0]);return this.imageUrlForMaxSize()},i.prototype.imageUrlForHeight=function(t){var e;return e=this.aspectRatio(),null!=e?this.imageUrlFor(t*this.aspectRatio(),t):this.imageUrlFor(t,t)},i.prototype.imageUrlForWidth=function(t){var e;return e=this.aspectRatio(),null!=e?this.imageUrlFor(t,t/this.aspectRatio()):this.imageUrlFor(t,t)},i.prototype.maxHeightForWidth=function(t,e){var r,o;return r=this.aspectRatio(),e=e||this.get("original_height"),null!=r?(o=Math.round(t/this.aspectRatio()),o>e?e:Math.floor(o)):void 0},i.prototype.maxWidthForWidth=function(t,e){var r,o;return r=this.aspectRatio(),null!=r?(e?(o=t/this.aspectRatio(),o>e&&(o=e),t=o*this.aspectRatio()):e=this.get("original_width"),t>e?e:Math.floor(t)):void 0},i.prototype.formatWidth=function(t,e){var r;return t&&e?(r=t?t:this.maxWidthForWidth(e),r?"width: "+r+"px;":""):""},i.prototype.canDeepZoom=function(){return null!=this.get("tile_base_url")&&null!=this.get("tile_size")&&null!=this.get("tile_overlap")&&null!=this.get("tile_format")&&null!=this.get("max_tiled_height")&&null!=this.get("max_tiled_width")},i.prototype.deepZoomJson=function(){var t;return this.canDeepZoom()?(t=this.get("tile_base_url").replace(/\/?$/,"/"),{Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:t,Format:this.get("tile_format"),TileSize:this.get("tile_size"),Overlap:this.get("tile_overlap"),Size:{Width:this.get("max_tiled_width"),Height:this.get("max_tiled_height")}}}):{}},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.Artist=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.modelName="artist",i.prototype.relations=[{type:"HasMany",key:"artworks",model:"Artworks"}],i.prototype.url=function(){return"/api/v1/artist/"+this.get("id")},i.prototype.clientUrl=function(){return"/artist/"+this.get("id")},i.prototype.followMessage=function(){return"You are now following "+this.get("name")+" and will receive email alerts about new artworks and shows."},i.prototype.unfollowMessage=function(){return"You will no longer receive any updates about "+this.get("name")+"."},i.prototype.getMaxLengthName=function(t){var e;return this.has("name")?(e=this.get("name"),e.length<t?e:""+e.slice(0,+(t-5)+1||9e9)+" &hellip;"):""},i.prototype.fetchArtworks=function(t){var e,r,o,i,n,s,a,l=this;if(o=(null!=t?t.url:void 0)||""+this.url()+"/artworks",r=[],(null!=t?t.pageSize:void 0)&&(null!=t?t.page:void 0)&&(r.push(["page",t.page]),r.push(["size",t.pageSize])),(null!=t?t.published:void 0)&&r.push(["published",t.published]),null!=t?null!=(s=t.filters)?s.length:void 0:void 0)for(a=t.filters,i=0,n=a.length;n>i;i++)e=a[i],r.push(["filter[]",e]);return r.length&&(o=""+o+"?"+_.map(r,function(t){return""+t[0]+"="+t[1]}).join("&")),App.Repositories.Artworks.getFromUrl(o,{preload:null!=t?t.preload:void 0,success:function(e){return l.set({artworks:e}),null!=t?"function"==typeof t.success?t.success(e):void 0:void 0}})},i.prototype.fetchArtworksSortedByGene=function(t,e){var r,o=this;return r="/api/v1/artist/"+this.get("id")+"/artworks?gene_id="+t,(null!=e?e.pageSize:void 0)&&(r=""+r+"&page="+e.page+"&size="+e.pageSize),App.Repositories.Artworks.getFromUrl(r,{success:function(t){return o.set({artworks:t}),null!=e?"function"==typeof e.success?e.success(t):void 0:void 0}})},i.prototype.displayName=function(){return this.get("name")},i.prototype.searchPath=function(){return"/artist/"+this.get("id")},i.prototype.fetchPosterArtwork=function(){var t=this;return App.Repositories.Artworks.getFromUrl(""+this.url()+"/artworks?&page=1&size=1",{success:function(e){return t.set({poster_artwork:e.models[0]}),t}})},i.prototype.hasArtworks=function(){return this.get("published_artworks_count")>0},i.prototype.hasArtworksForSale=function(){return this.get("forsale_artworks_count")>0},i.prototype.hasArtworksNotForSale=function(){return this.get("published_artworks_count")-this.get("forsale_artworks_count")>0},i.prototype.follow=function(t){return App.currentUser.get("followArtistsFetched")?App.currentUser.get("followArtists").followArtist(this,t):!1},i.prototype.unfollow=function(t){return App.currentUser.get("followArtistsFetched")?App.currentUser.get("followArtists").unfollowArtist(this,t):!1},i.prototype.following=function(){return App.currentUser.get("followArtistsFetched")?App.currentUser.get("followArtists").following(this):!1},i.prototype.hasImage=function(t){return null==t&&(t="tall"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){return null==t&&(t="tall"),App.imageUrl(this,t)},i.prototype.fetchRelatedPosts=function(t){return App.Collections.FeedItems.fetchFromUrl("/api/v1/related/posts?artist[]="+this.get("id"),{success:function(e){return null!=t?t.success(e):void 0}})},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Artwork=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="artwork",o.prototype.relations=[{type:"HasOne",key:"artist",model:"Artist"},{type:"HasOne",key:"partner",model:"Partner"},{type:"HasMany",key:"images",model:"AdditionalImages"}],o.prototype.urlRoot="/api/v1/artwork/",o.prototype.primaryImage=function(){var t;return t=this.get("images"),t?t.primaryImage():null},o.prototype.defaultImage=function(){return this.primaryImage()||new App.Models.DefaultImage},o.prototype.hasDefaultImage=function(){var t;return t=this.get("images"),t&&t.length>0},o.prototype.hasWebsite=function(){return!!this.get("website")},o.prototype.titleAndYearWithArtist=function(){var t;return _.compact([null!=this.get("title")?'"'+this.get("title")+'"':null,null!=(t=this.get("artist"))?t.get("name"):void 0,this.get("date")]).join(", ")},o.prototype.titleAndYear=function(){return _.compact([null!=this.get("title")&&this.get("title").length>0?"<em>"+this.get("title")+"</em>":null,this.get("date")]).join(", ")},o.prototype.superScriptFractions=function(t){return t?t.replace(/([0-9]+)(?:\s+)([0-9]*\/[0-9]*)/g,"$1 <sup>$2</sup>"):null},o.prototype.saleMessage=function(){return"Contact For Price"===this.get("sale_message")?void 0:this.get("sale_message")},o.prototype.displayDimensions=function(){var t,e,r,o,i;return r=this.get("edition_sets"),1===r.length?(e=_.first(r),_.compact([this.superScriptFractions(null!=(o=e.dimensions)?o["in"]:void 0),null!=(i=e.dimensions)?i.cm:void 0,e.editions]).join("<br />")):r.length>1?void 0:(t=this.get("dimensions"),_.compact([this.superScriptFractions(null!=t?t["in"]:void 0),null!=t?t.cm:void 0,this.get("unique")?"Unique":void 0]).join("<br />"))},o.prototype.displayDimensionsForEdition=function(t){var e,r;return _.compact([this.superScriptFractions(null!=(e=t.dimensions)?e["in"]:void 0),null!=(r=t.dimensions)?r.cm:void 0]).join("<br />")},o.prototype.searchPath=function(){return"/artwork/"+this.get("id")},o.prototype.hasDimension=function(t){var e;return e=this.get(t),null==e?!1:"number"==typeof e&&e>0?!0:"string"==typeof e&&""===e?!1:"string"==typeof e&&e.parseFraction()>0?!0:!1},o.prototype.hasDepth=function(){return this.hasDimension("depth")},o.prototype.hasWidth=function(){return this.hasDimension("width")},o.prototype.hasHeight=function(){return this.hasDimension("height")},o.prototype.hasDiameter=function(){return this.hasDimension("diameter")},o.prototype.canViewInRoom=function(){var t;return(null!=(t=this.get("category"))?t.match(/sculpture|installation|design/i):void 0)?!1:this.hasDepth()?!1:this.hasWidth()&&this.hasHeight()&&this.convertDimensionTo("width","in")<600?!0:this.hasDiameter()?!0:!1},o.prototype.convertDimensionTo=function(t,e){var r;if(r=this.get(t),null==r)return r;if("string"==typeof r&&(r=r.parseFraction()),0>=r)return r;switch(e){case"in":return"cm"===this.get("metric")?Math.round(r/2.54):r;case"cm":return"in"===this.get("metric")?Math.round(2.54*r):r;default:return r}},o.prototype.getSafeHeight=function(){return!this.get("height")&&this.get("diameter")>0?this.get("diameter"):this.get("height")},o.prototype.hasMoreInfo=function(){return this.get("provenance")||this.get("exhibition_history")||this.get("artist")&&this.get("artist").get("blurb")||this.get("signature")||this.get("additional_information")||this.get("literature")},o.prototype.hasCollectingInstitution=function(){var t;return(null!=(t=this.get("collecting_institution"))?t.length:void 0)>0},o.prototype.partnerName=function(){return this.hasCollectingInstitution()?this.get("collecting_institution"):null!=this.get("partner")?this.get("partner").get("name"):""},o.prototype.partnerLink=function(){var t;return(t=this.get("partner"))?t.get("default_profile_public")&&t.has("default_profile_id")?"/"+t.get("default_profile_id"):t.hasWebsite()?t.get("website"):void 0:void 0},o.prototype.partnerLinkTarget=function(){var t;return t=this.get("partner").linkType(),"external"===t?"_blank":"_self"},o.prototype.save=function(t){return App.currentUser.defaultArtworkCollection().saveArtwork(this,t)},o.prototype.unsave=function(t){return App.currentUser.defaultArtworkCollection().unsaveArtwork(this,t)},o.prototype.isSaved=function(){var t;return t=App.currentUser.defaultArtworkCollection(),t&&t.isSaved(this)},o.prototype.isShareable=function(){return this.get("can_share")},o.prototype.isAcquireable=function(){return App.siteFeatureEnabled("Purchases",!1)?this.get("acquireable"):!1},o.prototype.hasComparableSales=function(){return this.get("comparables_count")>0},o.prototype.loadComparableSales=function(t){var e=this;return null==t&&(t={}),App.Collections.ComparableSales.fetchFromUrl(""+this.url()+"/comparable_sales",{success:function(t){return e.set({comparable_sales:t})}})},o.prototype.loadRelatedFairs=function(){var t=this;if(!this.get("relatedFairs"))return App.Collections.Fairs.fetchFromUrl("/api/v1/related/fairs?artwork[]="+this.get("id"),{success:function(e){return t.set({relatedFairs:e})}})},o.prototype.ensureRelatedFairs=function(t){return this.get("relatedFairs")?t():this.on("change:relatedFairs",t)},o.prototype.loadRelatedShows=function(){var t=this;if(!this.get("relatedShows"))return App.Collections.PartnerShows.fetchFromUrl("/api/v1/related/shows?artwork[]="+this.get("id"),{success:function(e){return t.set({relatedShows:e})}})},o.prototype.ensureRelatedShows=function(t){return this.get("relatedShows")?t():this.on("change:relatedShows",t)},o.prototype.loadRelatedSales=function(){var t=this;if(!this.get("relatedSales"))return App.Collections.Sales.fetchFromUrl("/api/v1/related/sales?artwork[]="+this.get("id"),{success:function(e){return t.set({relatedSales:e})}})},o.prototype.ensureRelatedSales=function(t){return this.get("relatedSales")?t():this.on("change:relatedSales",t)},o.prototype.loadRelatedFeatures=function(){var t=this;if(!this.get("relatedFeatures"))return App.Collections.Features.fetchFromUrl("/api/v1/related/features?artwork[]="+this.get("id"),{success:function(e){return t.set({relatedFeatures:e})}})},o.prototype.ensureRelatedFeatures=function(t){return this.get("relatedFeatures")?t():this.on("change:relatedFeatures",t)},o.prototype.isAuctionStyle=function(){var t;return null!=(t=this.currentSale())?t.get("is_auction"):void 0},o.prototype.currentFair=function(){var t;return null!=(t=this.get("relatedFairs"))?t.first():void 0},o.prototype.currentSale=function(){var t;return null!=(t=this.get("relatedSales"))?t.first():void 0},o.prototype.currentFeature=function(){var t;return null!=(t=this.get("relatedFeatures"))?t.first():void 0},o.prototype.websiteLabel=function(){return this.isAuctionStyle()?"See Full Lot Details":"Visit Website"},o.prototype.priceLabel=function(){return this.isAuctionStyle()?"Est.":"Price"},o.prototype.noPin=function(){return!this.get("can_share_image")},o.prototype.getContactText=function(){return this.partnerIsGallery()?"Contact Gallery":"Contact Seller"},o.prototype.partnerIsGallery=function(){var t;return null==this.get("partner")||(null!=(t=this.get("partner"))?t.isGallery():void 0)},o.prototype.fetchRelatedPosts=function(t){return App.Collections.FeedItems.fetchFromUrl("/api/v1/related/posts?artwork[]="+this.get("id"),{success:function(e){return null!=t?t.success(e):void 0}})},o.prototype.canDisplayPrice=function(){return this.get("forsale")&&this.get("price")&&(!this.get("edition_sets")||this.get("edition_sets").length<2)},o.prototype.getArtworkPageSaleMessage=function(){return this.get("forsale")||!this.get("inquireable")||this.get("sold")?this.get("sale_message"):"Work is Not for Sale"},o.prototype.getPriceStyle=function(){return this.get("price").length>23?"longest_price":this.get("price").length>19?"long_price":""},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.ArtworkCollection=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.allFetched=!1,o.prototype.defaultPageSize=20,o.prototype.defaultSortOrder="-position",o.prototype.unsavedCache=[],o.prototype.requestSlugMax=10,o.prototype.pendingRequests=[],o.prototype.completedRequests=[],o.prototype.url=function(){return"/api/v1/collection/"+this.get("id")},o.prototype.defaults={id:"saved-artwork"},o.prototype.initialize=function(){if(!this.get("userId"))throw"userId is required";return this.set("artworks",new App.Collections.Artworks)},o.prototype.saveArtwork=function(t,e){var r=this;return this._save(t,e),App.Repositories.Artworks.add(t),$.ajax(""+this.url()+"/artwork/"+t.get("id"),{type:"POST",data:{user_id:this.get("userId")},success:null!=e?e.success:void 0,error:function(o){return r._unsave(t,e),null!=e?"function"==typeof e.error?e.error(o):void 0:void 0}}),!1},o.prototype._save=function(t,e){return null!=(null!=e?e.silent:void 0)&&e.silent?this.get("artworks").add(t,{silent:!0,at:0}):(this.get("artworks").add(t,{at:0}),this.trigger("add:"+t.get("id"))),this.removeFromUnsavedCache(t)},o.prototype.unsaveArtwork=function(t,e){var r=this;return this._unsave(t,e),$.ajax(""+this.url()+"/artwork/"+t.get("id"),{type:"DELETE",data:{user_id:this.get("userId")},success:null!=e?e.success:void 0,error:function(o){return r._save(t,e),null!=e?"function"==typeof e.error?e.error(o):void 0:void 0}}),!1},o.prototype._unsave=function(t,e){return null!=(null!=e?e.silent:void 0)&&e.silent?this.get("artworks").remove(t,{silent:!0}):(this.get("artworks").remove(t),this.trigger("remove:"+t.get("id"))),this.unsavedCache.push(t.get("id")),this.unsavedCache.sort()},o.prototype.isSaved=function(t){return null!=this.get("artworks").get(t.get("id"))},o.prototype.broadcastSaved=function(){var t=this;return this.get("artworks").each(function(e){return t.trigger("add:"+e.get("id"))})},o.prototype.artworkIdsToSync=function(){var t,e;return t=[],e=App.Repositories.Artworks.pluck("id"),e.length>0&&(t=_.difference(e,this.get("artworks").pluck("id")),t=_.difference(t,this.unsavedCache)),t},o.prototype.removeFromUnsavedCache=function(t){var e;
return e=_.indexOf(this.unsavedCache,t.get("id"),!0),-1!==e?this.unsavedCache.splice(e,1):void 0},o.prototype.syncSavedArtworks=function(){var t,e,r,o,i=this;if(!App.currentUser.accountCreated())return!1;if(this.collectionExists=!0,this.broadcastSaved(),this.allFetched)return this.off("sync"),this.unsavedCache=this.pendingRequests=this.completedRequests=[],void 0;if(t=this.artworkIdsToSync(),0===t.length)return!1;for(0===this.unsavedCache.length?this.unsavedCache=t:_.each(t,function(t){return i.unsavedCache.push(t)}),this.unsavedCache.sort(),this.unsavedCache=_.uniq(this.unsavedCache,!0),e=t.slice(0),r=e.slice(0,+this.requestSlugMax+1||9e9);r.length>0;)e=e.slice(this.requestSlugMax),o=$.param({artworks:r}),-1===_.indexOf(this.completedRequests,o,!0)&&this.pendingRequests.push(o),r=e.slice(0,+this.requestSlugMax+1||9e9);return this.processRequests(),!0},o.prototype.processRequests=function(){var t,e=this;if(this.pendingRequests.length>0)return t=this.pendingRequests.pop(),this.fetchArtworks({params:t,success:function(){return e.completedRequests.push(t),e.completedRequests.sort(),e.processRequests()}})},o.prototype.displayable=function(){return!this.get("private")&&this.collectionExists},o.prototype.ensureFetched=function(t){return this.get("fetched")?t():this.on("change:fetched",t)},o.prototype.fetch=function(t){var e=this;return $.ajax(this.url(),{type:"GET",data:{user_id:this.get("userId"),"private":App.currentUser.get("id")===this.get("userId")},error:function(r){return e.collectionExists=!1,e.set({fetched:!0}),404===r.status&&(r.suppressAppMessages=!0),null!=t?"function"==typeof t.error?t.error(r):void 0:void 0},success:function(r){return e.collectionExists=!0,e.set(r),e.set({fetched:!0}),null!=t?"function"==typeof t.success?t.success(r):void 0:void 0}})},o.prototype.save=function(){return $.ajax(this.url(),{type:"PUT",data:{user_id:this.get("userId"),"private":this.get("private")},error:function(t){return 404===t.status&&(t.suppressAppMessages=!0),"undefined"!=typeof options&&null!==options?"function"==typeof options.error?options.error(t):void 0:void 0},success:function(t){return"undefined"!=typeof options&&null!==options?"function"==typeof options.success?options.success(t):void 0:void 0}})},o.prototype.fetchArtworks=function(t){var e=this;return this.ensureFetched(function(){return $.ajax(""+e.url()+"/artworks?"+t.params,{type:"GET",data:{user_id:e.get("userId"),"private":e.get("private")},error:function(e){return 404===e.status&&(e.suppressAppMessages=!0),null!=t?"function"==typeof t.error?t.error(e):void 0:void 0},success:function(r){var o;return o=[],_.each(r,function(t){var r;return r=new App.Models.Artwork(t),o.push(r),e.removeFromUnsavedCache(r),_.defer(function(){return e.trigger("add:"+t.id)})}),App.Repositories.Artworks.add(o,{silent:!0,merge:!0}),e.get("artworks").add(o,{silent:!0}),null!=t&&"function"==typeof t.success&&t.success(o),e.trigger("artworksFetched")}})})},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.ArtworkShare=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"artwork",model:"Artwork"}],o.prototype.urlRoot="/api/v1/me/share/artwork/",o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.BidderPosition=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return null!=App.currentUser?"/api/v1/me/bidder_position":"/api/v1/bidder_position"},o.prototype.create=function(t){return $.ajax({type:"POST",url:this.url(),data:{sale_id:t.saleId,artwork_id:t.artworkId,max_bid_amount_cents:t.maxBid},success:function(e){return"function"==typeof t.success?t.success(e):void 0},error:function(e){var r;return e.suppressAppMessages=!0,r=JSON.parse(e.responseText),"function"==typeof t.error?t.error([r.message||r.error||e.statusText]):void 0}})},o.prototype.formatMaximumBid=function(){return"$"+App.numberToMoney(this.get("max_bid_amount_cents"))},o.prototype.formatSuggestedNextBid=function(){return"$"+App.numberToMoney(this.get("suggested_next_bid_cents"))},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Bookmark=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="bookmark",o.prototype.urlRoot="/api/v1/me/bookmark/artist",o.prototype.isBlank=function(){return!(this.get("artist_name")||this.get("comment"))},o.prototype.getArtistName=function(){return this.get("artist_name")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Bookmarks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Bookmark,o.fetchAllBookmarks=function(t){var e,r=this;return null==t&&(t={}),e={interested:new this,collecting:new this},$.ajax({dataType:"json",type:"GET",url:"/api/v1/me/bookmark/artists",success:function(o){var i;return i=r.populate(e,o),"function"==typeof t.success?t.success(i):void 0},error:function(e,r){return"function"==typeof t.error?t.error(r):void 0}}),e},o.populate=function(t,e){var r,o,i;for(o=0,i=e.length;i>o;o++)r=e[o],t[r.bookmark_type]&&t[r.bookmark_type].add(new App.Models.Bookmark(r));return t},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.ComparableSale=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.displayDimensions=function(){return this.get("dimensions")?_.compact(_.values(this.get("dimensions"))).join("<br />"):""},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.CurrentPost=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.urlRoot="/api/v1/post/",o.prototype.modelName="post",o.create=function(t){var e;return e=new this,e.save({},t)},o.fetchFromCookie=function(t){var e,r;return e=new this,(r=App.readCookie("current_post"))?(e.set({id:r}),e.fetch({success:t.success,error:function(e,r){return r.suppressAppMessages=!0,t.error(e)}})):t.error(e)},o.fetchCurrentFromApiOrCreate=function(t){return App.currentProfile?App.currentProfile.fetchCurrentPost({success:t.success,error:function(){return App.Models.CurrentPost.create(t)}}):App.Models.CurrentPost.create(t)},o.fetchOrCreate=function(t){return App.Models.CurrentPost.fetchFromCookie({success:t.success,error:function(){return App.Models.CurrentPost.fetchCurrentFromApiOrCreate(t)}})},o}(App.Models.Post)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.CurrentUser=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url="/api/v1/me",o.prototype.relations=[{type:"HasMany",key:"followArtists",model:"FollowArtists"},{type:"HasMany",key:"followGenes",model:"FollowGenes"},{type:"HasMany",key:"followProfiles",model:"FollowProfiles"},{type:"HasOne",key:"location",model:"Location",embedded:!0},{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.initialize=function(){return this.set("followProfiles",new App.Collections.FollowProfiles),o.__super__.initialize.call(this)},o.prototype.defaults={followArtists:null,followArtistsFetched:!1,followGenes:null,followGenesFetched:!1,accountCreated:!0,artworkCollections:[]},o.prototype.isAdmin=function(){return"Admin"===this.get("type")&&!this.get("is_slumming")},o.prototype.accountCreated=function(){return this.get("accountCreated")},o.prototype.ensureFollowArtists=function(t){return this.get("followArtistsFetched")?t():this.on("change:followArtistsFetched",t)},o.prototype.ensureFollowGenes=function(t){return this.get("followGenesFetched")?t():this.on("change:followGenesFetched",t)},o.prototype.fetchFollowArtists=function(){var t=this;return this.set({followArtists:new App.Collections.FollowArtists({})}),this.get("followArtists").fetchAllPages({success:function(){return t.set({followArtistsFetched:!0})}})},o.prototype.fetchFollowGenes=function(){var t=this;return this.set({followGenes:new App.Collections.FollowGenes({})}),this.get("followGenes").fetchAllPages({success:function(){return t.set({followGenesFetched:!0})}})},o.prototype.hideFollowTooltip=function(){return this.get("display_follow_tooltip")?(this.set({display_follow_tooltip:!1}),this.save()):void 0},o.prototype.hideFilterTooltip=function(){return this.get("display_filter_tooltip")?(this.set({display_filter_tooltip:!1}),this.save()):void 0},o.prototype.hideInquiryTooltip=function(){return this.get("display_inquiry_tooltip")?(this.set({display_inquiry_tooltip:!1}),this.save()):void 0},o.prototype.loadAuthentications=function(t){return null==t&&(t={}),null!=this.authentications?null!=t?"function"==typeof t.success?t.success():void 0:void 0:this.authentications=App.Collections.Authentications.fetchFromUrl("/api/v1/me/authentications",{success:null!=t?t.success:void 0})},o.prototype.linkedTo=function(t){return this.authentications.find(function(e){return e.get("provider")===t})},o.prototype.unlinkAccount=function(t,e){var r;return null==e&&(e={}),r=this.linkedTo(t),r?r.destroy(e):void 0},o.prototype.validateAttrs=function(t){var e,r;return e={},this.get("email")!==t.email&&""===t.email_confirmation?e.email_confirmation="Please repeat the new email.":this.get("email")!==t.email&&null!=t.email_confirmation&&t.email_confirmation!==t.email&&(e.email_confirmation="Emails don't match up. Please try again."),""===(null!=(r=t.name)?r.trim():void 0)&&(e.name="Please enter your full name."),_.size(e)>0?e:void 0},o.prototype.hasLabFeature=function(t){return $.inArray(t,this.get("lab_features"))>=0},o.prototype.bookmarks=function(){var t;return null!=(t=this._bookmarks)?t:this._bookmarks=App.Models.Bookmarks.fetchAllBookmarks()},o.prototype.fetchCreditCards=function(t){return $.ajax(""+this.url+"/credit_cards",{type:"GET",success:null!=t?t.success:void 0})},o.prototype.addCreditCard=function(t){return $.ajax(""+this.url+"/credit_cards",{type:"POST",data:{uri:null!=t?t.uri:void 0},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},o.prototype.addToPendingOrder=function(t){return $.ajax(""+this.url+"/order/pending/items",{type:"POST",data:{artwork_id:t.artwork.get("id"),edition_set_id:t.edition_set_id,quantity:t.quantity,replace_order:!0},success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})},o.prototype.track=function(){return this.accountCreated()&&!this.isAdmin()?Analytics.registerCurrentUser(this):void 0},o.prototype.getUserFlag=function(t,e){var r;return null==e&&(e=!1),r=this.getUserFlags(),null!=r[t]?r[t]:e},o.prototype.setUserFlag=function(t,e){var r;return null==e&&(e=!0),r=this.getUserFlags(),r[t]=e,this.accountCreated()?$.ajax("/api/v1/me/user_flags",{type:"PUT",data:{key:t,value:e}}):App.createCookie("userFlags",JSON.stringify(r),!1)},o.prototype.getUserFlags=function(){var t;return this.accountCreated()?this.get("user_flags")||{}:(t=App.readCookie("userFlags"),null!=t?JSON.parse(t):{})},o}(App.Models.User)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.DefaultImage=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.missingImageUrl=function(){return"/assets/shared/missing_image.png"},o.prototype.imageUrl=o.prototype.missingImageUrl,o.prototype.aspectRatio=function(){return void 0},o.prototype.isDownloadable=function(){return!1},o.prototype.imageUrlFor=o.prototype.missingImageUrl,o.prototype.imageUrlForHeight=o.prototype.missingImageUrl,o.prototype.imageUrlForWidth=o.prototype.missingImageUrl,o.prototype.maxWidthForWidth=function(t){return t},o.prototype.maxHeightForWidth=function(t){return t},o.prototype.canDeepZoom=function(){return!1},o.prototype.deepZoomJson=function(){return null},o.prototype.formatWidth=function(t){return"width: "+t+"px;"},o.prototype.imageUrlForMaxSize=o.prototype.missingImageUrl,o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.Fair=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.url=function(){return"/api/v1/fair/"+this.get("id")},i.prototype.showsUrl=function(){return""+this.url()+"/shows"},i.prototype.regionsUrl=function(){return""+this.url()+"/partners/regions"},i.prototype.sectionsUrl=function(){return""+this.url()+"/sections"},i.prototype.partnersUrl=function(){return""+this.url()+"/partners"},i.prototype.artistsUrl=function(){return""+this.url()+"/artists"},i.prototype.relations=[{type:"HasMany",key:"partners",model:"Partners"},{type:"HasOne",key:"location",model:"PartnerLocation"},{type:"HasMany",key:"artists",model:"Artists"},{type:"HasOne",key:"organizer",model:"FairOrganizer"}],i.prototype.pageSize=30,i.prototype.artistsPage=1,i.prototype.exhibitorsPage=1,i.prototype.doneFetching=!1,i.prototype.defaults={regionsFetched:!1,featuredLinksFetched:!1,sectionsFetched:!1,profileFetched:!1},i.prototype.hasImage=function(t){return null==t&&(t="wide"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){return null==t&&(t="wide"),App.imageUrl(this,t)},i.prototype.fetchExhibitors=function(t){var e=this;if(this.doneFetching&&null!=t&&t.success([]),null==t.filter.filterName)throw"You must pass options.filter.filterName";return this.lastExhibitorFetchFilter&&t.filter.filterName!==this.lastExhibitorFetchFilter.filterName&&(this.exhibitorsPage=1,this.set("partnersFetched",!1),this.set("partners",new App.Collections.Partners)),this.get("partners")||this.set("partners",new App.Collections.Partners),App.Collections.Partners.fetchFromUrl(this.partnersUrl(),{update:!0,data:this.formatBackboneFetchObject({page:this.exhibitorsPage,pageSize:30,filter:t.filter}),success:function(r){return e.get("partners").add(r.models),e.exhibitorsPage=e.exhibitorsPage+1,r.length<e.pageSize&&e.set("partnersFetched",!0),e.lastExhibitorFetchFilter=t.filter,null!=t?t.success(r):void 0}})},i.prototype.fetchArtists=function(t){var e=this;if(this.doneFetching&&null!=t&&t.success([]),null==t.filter.filterName)throw"You must pass options.filter.filterName";return this.lastArtistFetchFilter&&t.filter.filterName!==this.lastArtistFetchFilter.filterName&&(this.artistsPage=1,this.set("artistsFetched",!1),this.set("artists",new App.Collections.Artists)),this.get("artists")||this.set("artists",new App.Collections.Artists),App.Collections.Partners.fetchFromUrl(this.artistsUrl(),{data:this.formatBackboneFetchObject({page:this.artistsPage,pageSize:30,filter:t.filter}),success:function(r){return e.get("artists").add(r.models),e.artistsPage=e.artistsPage+1,r.length<e.pageSize&&e.set("artistsFetched",!0),e.lastArtistFetchFilter=t.filter,null!=t?t.success(r):void 0}})},i.prototype.formatBackboneFetchObject=function(t){var e,r;if(null==(null!=(r=t.filter)?r.filterName:void 0))throw"You must pass filter.filterName";return e={},t.pageSize&&(e.size=t.pageSize),t.page&&(e.page=t.page),t.sortOrder&&(e.sortOrder=t.sortOrder),t.filter&&"all"!==t.filter.filterName&&(e[t.filter.filterType]=t.filter.filterName),t.artworks&&(e.artworks=!0),e},i.prototype.fetchShowForPartner=function(t,e){return App.Collections.FeedItems.fetchFromUrl(""+this.url()+"/shows?partner="+t,{success:function(t){return null!=e?e.success(t):void 0}})},i.prototype.fetchShowForArtist=function(t,e){return App.Collections.FeedItems.fetchFromUrl(""+this.url()+"/shows?artist="+t,{success:function(t){return null!=e?e.success(t):void 0}})},i.prototype.isAuction=function(){var t;return"AuctionProfile"===(null!=(t=this.get("profile"))?t.get("subtype"):void 0)},i.prototype.sortOrder=function(){return this.isAuction()?"start_at":"-updated_at"},i.prototype.fetchShows=function(t){var e;return e=new App.Collections.FeedItems,e.url=this.showsUrl(),e.fetch({data:this.formatBackboneFetchObject({page:1,filter:t.filter,pageSize:3,sortOrder:this.sortOrder(),artworks:t.onlyShowsWithArtworks}),success:function(e){return null!=t?t.success(e):void 0}})},i.prototype.displayLocation=function(){var t,e,r,o;return null!=(null!=(t=this.get("location"))?t.get("city"):void 0)?null!=(e=this.get("location"))?e.get("city"):void 0:null!=(null!=(r=this.get("location"))?r.get("display"):void 0)?null!=(o=this.get("location"))?o.get("display"):void 0:""},i.prototype.displayTimeAndLocation=function(){var t,e;return e=App.timespanInWords(this.get("start_at"),this.get("end_at")),t=this.displayLocation(),_.filter([e,t],function(t){return null!=t&&(null!=t?t.length:void 0)>0}).join(", ")},i.prototype.fetchRegions=function(t){var e,r=this;return(null!=(e=this.get("regions"))?e.length:void 0)?"function"==typeof t.success?t.success(this.get("regions")):void 0:$.get(this.regionsUrl(),function(e){return r.set("regions",e),r.set({regionsFetched:!0}),null!=t?"function"==typeof t.success?t.success(e):void 0:void 0})},i.prototype.fetchFeaturedLinks=function(){var t=this;return App.Repositories.OrderedSets.fetchItemsByOwner("Fair",this.get("id")).then(function(e){return e.each(function(e){return t.set(""+e.get("key")+"Links",e)}),t.set("featuredLinksFetched",!0)})},i.prototype.fetchSections=function(t){var e,r=this;return(null!=(e=this.get("sections"))?e.length:void 0)?null!=t?"function"==typeof t.success?t.success(this.get("sections")):void 0:void 0:$.get(this.sectionsUrl(),function(e){return r.set("sections",e),r.set("sectionsFetched",!0),null!=t?"function"==typeof t.success?t.success(e):void 0:void 0})},i.prototype.ensureProfileFetched=function(t){var e=this;return this.get("profile")?"function"==typeof t?t():void 0:this.get("organizer")?App.Repositories.Profiles.getOrFetch(this.get("organizer").get("profile_id"),["owner_type"],{success:function(r){return e.set({profile:r}),"function"==typeof t?t():void 0}}):"function"==typeof t?t():void 0},i.prototype.ensureRegionsFetched=function(t){return this.get("regionsFetched")?t():(this.fetchingRegions||(this.fetchRegions(),this.fetchingRegions=!0),this.on("change:regionsFetched",t))},i.prototype.ensureFeaturedLinksFetched=function(t){return this.get("featuredLinksFetched")?t():(this.fetchingFeaturedLinks||(this.fetchFeaturedLinks(),this.fetchingFeaturedLinks=!0),this.on("change:featuredLinksFetched",t))},i.prototype.ensureSectionsFetched=function(t){return this.get("sectionsFetched")?t():(this.fetchingSections||(this.fetchSections(),this.fetchingSections=!0),this.on("change:sectionsFetched",t))},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FairOrganizer=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.ensureDefaultFairFetched=function(t){var e=this;return this.get("defaultFair")?"function"==typeof t?t():void 0:App.Repositories.Fairs.getOrFetch(this.get("default_fair_id"),["name"],{success:function(r){return e.set({defaultFair:r}),"function"==typeof t?t():void 0}})},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.Feature=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.urlRoot="/api/v1/feature/",i.prototype.url=function(){return""+this.urlRoot+this.get("id")},i.prototype.relations=[{type:"HasMany",key:"sets",model:"OrderedSet"},{type:"HasOne",key:"profile",model:"Profile"}],i.prototype.page=1,i.prototype.pageSize=30,i.prototype.fetchSets=function(){var t=this;return App.Repositories.OrderedSets.fetchItemsByOwner("Feature",this.get("id")).then(function(e){return t.set("sets",e)})},i.prototype.hasImage=function(t){return null==t&&(t="wide"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.searchPath=function(){return"/feature/"+this.get("id")},i.prototype.imageUrl=function(t){return null==t&&(t="wide"),App.imageUrl(this,t)},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.FeaturedLink=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.modelName="featured_link",i.prototype.url=function(){return"/api/v1/featured_link/"+this.get("id")},i.prototype.imageUrl=function(t){return null==t&&(t="medium"),App.imageUrl(this,t)},i.prototype.hasImage=function(t){var e;return null==t&&(t="medium"),"original"===t&&(null!=(e=this.get("image_versions"))?e.length:void 0)>0?!0:o.call(this.get("image_versions")||[],t)>=0},i.prototype.layoutStyle=function(){switch(!1){case 1!==this.collection.length:return"full";case 2!==this.collection.length:return"half";case 3!==this.collection.length:return"third";case!(this.collection.length>3):return"quarter"}},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FeedItem=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="feed_item",o.prototype.defaults={top:0,bottom:0,height:0,index:0,active:!1,isAbove:!1,initialArtworkSize:3},o.prototype.relations=[{type:"HasMany",key:"artworks",model:"Artworks"},{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.initialize=function(){return o.__super__.initialize.call(this),"Post"!==this.get("_type")||App.Repositories.Posts.get(this.get("id"))?void 0:App.Repositories.Posts.add(new App.Models.Post(this.attributes))},o.prototype.artworks=function(t){var e,r,o;return e="Post"===this.get("_type")?null!=(r=this.toChildModel())?r.artworks():void 0:null!=(o=this.get("artworks"))?o.models:void 0,t?e.slice(0,+t+1||9e9):e},o.prototype.flagged=function(){return this.get("flagged")},o.prototype.initialArtworks=function(){var t;return"Post"===this.get("_type")?this.artworks():null!=(t=this.get("artworks"))?t.first(this.get("initialArtworkSize")):void 0},o.prototype.toChildModel=function(){var t;return"Post"===this.get("_type")?App.Repositories.Posts.get(this.get("id")):this.get("_type")?null!=(t=this.childModel)?t:this.childModel=new(App.Models[this.get("_type")])(this.attributes):void 0},o.prototype.getType=function(){return""+this.get("_type").underscore()+" "+this.toChildModel().get("layout")},o.prototype.isArtworkColumns=function(){var t;return(null!=(t=this.toChildModel().get("layout"))?t.indexOf("artwork_columns"):void 0)>-1},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Feedback=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="feedback",o.prototype.url=function(){return"/api/v1/feedback/"},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FollowArtist=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"artist",model:"Artist"},{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.url=function(){return"/api/v1/me/follow/artist/"+this.get("id")},o.prototype.follow=function(t){return this.get("artist").follow(t)},o.prototype.unfollow=function(t){return this.get("artist").unfollow(t)},o.prototype.getArtistName=function(){return this.get("artist").get("name")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FollowGene=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasMany",key:"followgenes",model:"FollowGene"}],o.prototype.url=function(){return"/api/v1/me/follow/gene/"+this.get("id")},o.prototype.initialize=function(t){return this.set({gene:new App.Models.Gene(t.gene)})},o.prototype.follow=function(t){return this.get("gene").follow(t)},o.prototype.unfollow=function(t){return this.get("gene").unfollow(t)},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FollowProfile=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"user",model:"User"},{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.url=function(){return"/api/v1/me/follow/profile/"+this.get("id")},o.prototype.follow=function(t){return this.get("profile").follow(t)},o.prototype.unfollow=function(t){return this.get("profile").unfollow(t)},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.Gene=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.urlRoot="/api/v1/gene/",i.prototype.modelName="gene",i.prototype.followMessage=function(){return"You are now following the "+this.get("name")+" gene."},i.prototype.unfollowMessage=function(){return"You will no longer receive any updates about the "+this.get("name")+" gene."},i.prototype.hasInfoIcon=function(){return this.get("description")&&!this.get("influential_artist")},i.prototype.searchPath=function(){return"/gene/"+this.get("id")},i.prototype.displayName=function(){return this.get("name")},i.prototype.subjectMatterGeneTypes=["content","medium","concrete contemporary","abstract contemporary","concept","technique","appearance genes"],i.prototype.isSubjectMatter=function(){var t,e=this;return null!=this.get("subjectMatterGene")?this.get("subjectMatterGene"):null==this.get("type")?(this.set({subjectMatterGene:!1}),!1):(t=_.filter(this.subjectMatterGeneTypes,function(t){var r;return-1!==(null!=(r=e.get("type"))?r.name.toLowerCase().indexOf(t):void 0)}),t=t.length>0,this.set({subjectMatterGene:t}),t)},i.prototype.toLayer=function(){return new App.Models.Layer({id:this.get("id"),name:this.get("name"),group:"Genes",description:this.get("description"),more_info_url:this.searchPath()})},i.prototype.follow=function(t){return App.currentUser.get("followGenesFetched")?App.currentUser.get("followGenes").followGene(this,t):!1},i.prototype.unfollow=function(t){return App.currentUser.get("followGenesFetched")?App.currentUser.get("followGenes").unfollowGene(this,t):!1},i.prototype.following=function(){return App.currentUser.get("followGenesFetched")?App.currentUser.get("followGenes").following(this):!1},i.prototype.imageUrl=function(t){return null==t&&(t="tall"),App.imageUrl(this,t)},i.prototype.hasImage=function(t){return null==t&&(t="tall"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.fetchArtworks=function(t){var e,r,o,i,n,s,a,l=this;if(o="/api/v1/gene/"+this.get("id")+"/artworks",r=[],(null!=t?t.pageSize:void 0)&&(null!=t?t.page:void 0)&&(r.push(["page",t.page]),r.push(["size",t.pageSize])),null!=t?null!=(s=t.filters)?s.length:void 0:void 0)for(a=t.filters,i=0,n=a.length;n>i;i++)e=a[i],r.push(["filter[]",e]);return r.length&&(o=""+o+"?"+_.map(r,function(t){return""+t[0]+"="+t[1]}).join("&")),App.Repositories.Artworks.getFromUrl(o,{preload:null!=t?t.preload:void 0,success:function(e){return l.set({artworks:e}),null!=t?"function"==typeof t.success?t.success(e):void 0:void 0}})},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.HeroUnit=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="heroUnit",o.prototype.url=function(){return"/api/v1/site_hero_unit/"+this.get("id")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Models.Invitation=function(r){function i(){return this.validateAttrs=e(this.validateAttrs,this),this.initialize=e(this.initialize,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.emailRegex=App.emailRegex,i.prototype.url=function(){return"/api/v1/me/invitation"},i.prototype.initialize=function(){return this.errors={}},i.prototype.validationMessages={empty_email:"Please enter your friend's email address.",invalid_email:"Please enter a valid email address."},i.prototype.getErrorMessage=function(t){return this.validationMessages[t]},i.prototype.validateAttrs=function(t){var e,r;return null==t&&(t=this.attributes),this.errors={},e=null!=(r=t.email||this.attributes.email)?r.trim():void 0,e||(this.errors.email=this.getErrorMessage("empty_email")),e&&e.match(this.emailRegex)||(this.errors.email=this.getErrorMessage("invalid_email")),_.size(this.errors)>0?this.errors:void 0},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.LabFeatures=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url="/api/v1/me/labs",o.prototype.fetch=function(t){var e=this;return $.getJSON(this.url,function(r){return e.set({features:r}),null!=t?"function"==typeof t.success?t.success(r):void 0:void 0})},o.prototype.toggle=function(t){var e,r;return t||(t={}),r="/api/v1/me/lab/"+t.id+"/",e=t.enable?"post":"delete",$.ajax({url:r,type:e,success:function(){return App.currentUser.fetch()},error:function(e){return null!=t?"function"==typeof t.failure?t.failure(e.statusText):void 0:void 0}})},o}(App.Models.DomainAbstract)
}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Layer=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.artworksUrl=function(){var t;return t=$.param({artwork:[this.get("queryArtwork").id]}),"/api/v1/related/layer/"+this.get("type")+"/"+this.get("id")+"/artworks?"+t},o.prototype.initialize=function(){return this.set({artworks:new App.Collections.Artworks})},o.prototype.loadArtworks=function(t){var e=this;return App.Repositories.Artworks.getFromUrl(this.artworksUrl(this.get("page")),{preload:null!=t?t.preload:void 0,success:function(r){return e.get("artworks").add(r.models),null!=t?"function"==typeof t.success?t.success(r):void 0:void 0},error:null!=t?t.error:void 0})},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Location=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.defaults=function(){return{raw:"",address:"",address_2:"",city:"",state:"",state_code:"",postal_code:"",country:"",coordinates:null,summary:""}},o.prototype.setFromGoogleResult=function(t){var e;return e=new GeoFormatter(t),this.reset({city:e.getCity()||"",state:e.getState()||"",state_code:e.getStateCode()||"",postal_code:e.getPostalCode()||"",country:e.getCountry()||"",coordinates:e.getCoordinates()||null})},o.prototype.toString=function(){return this.get("raw")||_.compact([this.get("city"),this.get("state_code")]).join(", ")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Marketplace=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return"/api/v1/marketplace"},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.OrderLineItem=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{key:"artwork",type:"HasOne",model:"Artwork"},{key:"partner",type:"HasOne",model:"Partner"},{key:"partner_location",type:"HasOne",model:"PartnerLocation"}],o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.OrderedSet=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.urlRoot="/api/v1/set/",o.prototype.initialize=function(){var t;return t=this.get("item_type"),null!=t?this.set("items",new(App.Collections[t.pluralize()])(this.get("items"))):void 0},o.prototype.fetchItems=function(t){var e,r,o,i,n=this;return r=this.get("item_type"),e=$.Deferred(),i=""+this.url()+"/items",t&&(o=$.param(t),(null!=o?o.length:void 0)>0&&(i=""+i+"?"+o)),App.Collections[r.pluralize()].fetchFromUrl(i,{success:function(t){return n.set("items",new(App.Collections[r.pluralize()])(t.models)),e.resolve(t)}}),e.promise()},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Page=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return"/api/v1/page/"+this.get("id")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Partner=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.defaults={initialShowsFetched:!1,showsFetched:!1,artistsFetched:!1},o.prototype.artistsPage=1,o.prototype.showsPage=1,o.prototype.pageSize=30,o.prototype.initialize=function(){return this.set({partnerArtists:new App.Collections.PartnerArtists,representedArtists:new App.Collections.PartnerArtists,nonRepresentedArtists:new App.Collections.PartnerArtists})},o.prototype.url=function(){return"/api/v1/partner/"+this.get("id")},o.prototype.displayName=function(){return this.get("name")},o.prototype.searchPath=function(){var t;return t=this.get("default_profile_id"),t?"/"+t:null},o.prototype.linkType=function(){return this.get("link_to_profile")&&this.has("default_profile_id")?"local":this.hasWebsite()?"external":"none"},o.prototype.hasWebsite=function(){return this.has("website")&&""!==this.get("website")},o.prototype.hasImage=function(){return this.has("icon")},o.prototype.toString=function(){return this.get("name")},o.prototype.isGallery=function(){return"Gallery"===this.get("type")||""===this.get("type")},o.prototype.getMailTo=function(){var t;return this.has("email")&&this.get("email").length>0?(t=window.encodeURIComponent("Connecting with "+this.get("name")+" via Artsy"),"mailto:"+this.get("email")+"?subject="+t+"&cc=inquiries@artsy.net"):""},o.prototype.allArtistsFetched=function(){return this.get("artistsFetched")},o.prototype.allShowsFetched=function(){return this.get("showsFetched")},o.prototype.initialShowsFetched=function(){return this.get("initialShowsFetched")},o.prototype.hasTab=function(t){return this.isGallery()?this.hasGalleryTab(t):this.hasInstitutionTab(t)},o.prototype.hasGalleryTab=function(t){var e;switch(t){case"shows":return this.get("has_full_profile")&&this.get("displayable_shows_count")>0;case"artists":return this.get("has_full_profile")&&this.get("partner_artists_count")>0;case"posts":return e=App.Repositories.Profiles.get(this.get("default_profile_id")),null!=e&&this.get("has_full_profile")&&e.hasPosts();case"tour":return this.has("floored_tour")&&this.get("floored_tour")&&App.currentUser.hasLabFeature("Partner Tour");default:return!1}},o.prototype.hasInstitutionTab=function(t){var e;switch(t){case"shows":return this.get("displayable_shows_count")>0;case"collection":return this.get("published_not_for_sale_artworks_count")>0;case"shop":return this.get("published_for_sale_artworks_count")>0;case"posts":return e=App.Repositories.Profiles.get(this.get("default_profile_id")),null!=e&&e.hasPosts();default:return!1}},o.prototype.fetchShows=function(t){var e,r=this;return e=new App.Collections.PartnerShows,e.url=""+this.url()+"/shows?sort=-featured,-end_at&page="+this.showsPage+"&size="+this.pageSize,e.fetch({success:function(e){return r.showsPage=r.showsPage+1,e.each(function(t){return t.set({partner:r,artworks:new App.Collections.Artworks})}),App.Repositories.PartnerShows.add(e,{merge:!0}),r.get("shows")?r.get("shows").add(e.models):r.set({shows:e,initialShowsFetched:!0}),e.length<r.pageSize&&r.set({showsFetched:!0}),null!=t?t.success(e):void 0}})},o.prototype.fetchLocations=function(t){var e,r=this;return this.get("locationsFetched")?null!=t?t.success(this.get("locations")):void 0:(e=new App.Collections.PartnerLocations,e.url=""+this.url()+"/locations",e.fetch({success:function(e){return e.each(function(t){return t.set({partner:r})}),App.Repositories.PartnerLocations.add(e,{merge:!0}),r.set({locations:e,locationsFetched:!0}),null!=t?t.success(e):void 0}}))},o.prototype.formatLocationText=function(){var t,e;return(null!=(t=this.get("locations"))?t.length:void 0)>4?""+this.get("locations").length+" locations":(null!=(e=this.get("locations"))?e.length:void 0)>0?_.uniq(_.flatten(this.get("locations").map(function(t){return _.compact([t.get("city"),t.get("state")]).join(", ")}))).join(", "):""},o.prototype.fetchAllShows=function(){var t=this;if(!this.allShowsFetched())return this.fetchShows({success:function(){return t.fetchAllShows()}})},o.prototype.handleFetchedArtists=function(t){var e,r,o,i=this;return o=[],e=[],r=[],_.each(t.models,function(t){var r;return null!=(r=t.get("artist"))&&r.set({partner:i}),t.get("represented_by")?o.push(t):t.get("published_artworks_count")>0?e.push(t):void 0}),this.get("partnerArtists").add(t.models),this.get("representedArtists").add(o),this.get("nonRepresentedArtists").add(e)},o.prototype.fetchArtists=function(t){var e,r=this;if(!this.allArtistsFetched())return e=new App.Collections.PartnerArtists,e.url=""+this.url()+"/partner_artists?page="+this.artistsPage+"&size="+this.pageSize,e.fetch({success:function(){return r.artistsPage=r.artistsPage+1,r.handleFetchedArtists(e),e.length<r.pageSize&&r.set({artistsFetched:!0}),null!=t?t.success(e):void 0}})},o.prototype.fetchAllArtists=function(){var t=this;if(!this.allArtistsFetched())return this.fetchArtists({success:function(){return t.fetchAllArtists()}})},o.prototype.initializeForSaleArtworks=function(){var t,e;return this.has("forSaleArtworks")?this.get("forSaleArtworks"):(t=new App.Collections.Artworks,e={defaultPageSize:24,nextPage:1,url:""+this.url()+"/artworks/?published=true&for_sale_sold_on_hold=true"},_.extend(t,e),this.set("forSaleArtworks",t),t)},o.prototype.initializeNotForSaleArtworks=function(){var t,e;return this.has("notForSaleArtworks")?this.get("notForSaleArtworks"):(t=new App.Collections.Artworks,e={defaultPageSize:24,nextPage:1,url:""+this.url()+"/artworks/?published=true&not_for_sale=true"},_.extend(t,e),this.set("notForSaleArtworks",t),t)},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.PartnerArtist=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.relations=[{type:"HasOne",key:"artist",model:"Artist"}],i.prototype.defaults={image_versions:[]},i.prototype.hasImage=function(t){return null==t&&(t="four_thirds"),o.call(this.get("image_versions"),t)>=0},i.prototype.imageUrl=function(t){return null==t&&(t="four_thirds"),App.imageUrl(this,t)},i.prototype.showImage=function(){return this.hasImage("four_thirds")&&this.get("published_artworks_count")>0},i.prototype.artistId=function(){return this.get("artist").get("id")},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.PartnerLocation=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="partner_location",o.prototype.relations=[{key:"partner",type:"HasOne",model:"Partner"},{key:"fair",type:"HasOne",model:"Fair"}],o.prototype.lines=function(){return _.compact([this.get("address"),this.get("address2"),_.compact([this.get("city"),_.compact([this.get("state"),this.get("postal_code")]).join(" ")]).join(", "),this.get("country")])},o.prototype.singleLine=function(){return _.compact([this.get("city"),this.get("address")]).join(", ")},o.prototype.toHtml=function(){var t;return this.get("phone")&&(t="Tel: "+this.get("phone")),_.flatten([this.lines(),t]).join("<br/>")},o.prototype.displayAddress=function(){return this.lines()?this.lines().join(", "):""},o.prototype.displayName=function(){return this.get("display")?this.get("display"):this.get("name")},o.prototype.googleMapsLink=function(){var t;return(t=this.displayAddress())?App.Lib.GoogleMaps.getMapLink(t):void 0},o.prototype.mapImageSrc=function(t,e){var r;return(r=this.displayAddress())?App.Lib.GoogleMaps.getMapImageSrc({size:""+t+"x"+e,center:r,markers:"color:0x873ff0|"+r}):void 0},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.PartnerShow=function(r){function n(){return this.fetchMoreArtworks=e(this.fetchMoreArtworks,this),this.fetchAllArtworks=e(this.fetchAllArtworks,this),t=n.__super__.constructor.apply(this,arguments)}return o(n,r),n.prototype.modelName="partner_show",n.prototype.maxDisplayedArtists=5,n.prototype.pageSize=10,n.prototype.relations=[{type:"HasMany",key:"artworks",model:"Artworks"},{type:"HasMany",key:"artists",model:"Artists"},{type:"HasOne",key:"partner",model:"Partners"},{type:"HasOne",key:"default_artwork",model:"Artwork"},{type:"HasOne",key:"location",model:"PartnerLocation"},{type:"HasOne",key:"fair_location",model:"PartnerLocation"},{type:"HasOne",key:"fair",model:"Fairs"}],n.prototype.defaults={artworks:[],image_versions:[],layout:"artwork_columns wide_body"},n.prototype.upcoming=function(){return"upcoming"===this.get("status")},n.prototype.running=function(){return"running"===this.get("status")},n.prototype.closed=function(){return"closed"===this.get("status")},n.prototype.renderable=function(){return this.get("eligible_artworks_count")>0||this.get("images_count")>3},n.prototype.featurable=function(){return this.renderable()},n.prototype.linkable=function(){return this.renderable()},n.prototype.url=function(){return this.has("partner")?"/api/v1/partner/"+this.get("partner").get("id")+"/show/"+this.get("id"):"/api/v1/show/"+this.get("id")},n.prototype.clientUrl=function(){return"/show/"+this.get("id")},n.prototype.searchPath=function(){return this.clientUrl()},n.prototype.fairUrl=function(){return this.has("fair")&&this.get("fair").has("organizer")?"/"+this.get("fair").get("organizer").get("profile_id")+"/browse/show/"+this.get("partner").get("id"):""},n.prototype.getArtistNames=function(t){var e,r;return null==t&&(t=1/0),this.has("artists")?(r=this.get("artists").map(function(t){return t.get("name")}),_.isEmpty(null!=r?r[0]:void 0)?this.get("artworks").length>0?(e=this.get("artworks").map(function(t){var e;return null!=(e=t.get("artist"))?e.get("name"):void 0}),_.compact(_.uniq(e).slice(0,+(t-1)+1||9e9))):[]:r.slice(0,+(t-1)+1||9e9)):[]},n.prototype.formatArtists=function(t){var e;return null==t&&(t=1/0),this.has("artists")?(e=this.get("artists").map(function(t){return"<a href='"+t.searchPath()+"'>"+t.get("name")+"</a>"}),(null!=e?e.length:void 0)<=t?e.join(", "):""+e.slice(0,+(t-1)+1||9e9).join(", ")+" and "+(e.slice(t-1).length-1)+" more"):""},n.prototype.getShareableTitle=function(){var t;return this.get("fair_location")?""+this.get("name")+", "+(null!=(t=this.get("fair_location"))?t.displayName():void 0)+". See it on @artsy":'See "'+this.get("name")+'" at '+this.get("partner").displayName()+" on @artsy"},n.prototype.formatHeading=function(){var t;return(null!=(t=this.get("name"))?t.length:void 0)>0?this.get("name"):this.formatArtists(this.maxDisplayedArtists)},n.prototype.getLeadHeading=function(){return this.running()?"Current Show":this.upcoming()?"Upcoming Show":this.closed()?"Past Show":void 0},n.prototype.defaultLink=function(){return this.get("fair")&&this.get("fair").get("id"),this.get("partner")?this.get("partner").get("id"):void 0},n.prototype.formatCity=function(){var t;return null!=(t=this.get("location"))?t.get("city"):void 0},n.prototype.formatLocation=function(){return this.get("location")?_.compact([this.get("location").get("city"),this.get("location").get("country")]).join(", "):void 0},n.prototype.formatDateAndLocation=function(){return _.compact([App.timespanInWords(this.get("start_at"),this.get("end_at")),this.formatCity()]).join(", ")},n.prototype.imageUrl=function(t){return null==t&&(t="tall"),App.imageUrl(this,t)},n.prototype.hasImage=function(t){return null==t&&(t="large"),i.call(this.get("image_versions")||[],t)>=0},n.prototype.posterImageUrl=function(t){var e;return null==t&&(t=!1),e=t?"featured":"large",this.hasImage(e)?this.imageUrl(e):t&&(e="larger",this.hasImage(e))?this.imageUrl(e):!1},n.prototype.fetchInstallShots=function(t){var e,r=this;return e=new App.Collections.AdditionalImages,e.url="/api/v1/partner_show/"+this.get("id")+"/images?default=false",e.fetch({success:function(e){return r.set("installShots",e),null!=t?"function"==typeof t.success?t.success():void 0:void 0}})},n.prototype.installShotsWithImages=function(){return _.filter(this.get("installShots").models,function(t){return t.hasImage("large")})},n.prototype.fetchPosterImage=function(){var t=this;return 0===this.get("image_versions").length&&this.get("eligible_artworks_count")>0&&0===this.get("artworks").length?App.Repositories.Artworks.getFromUrl(""+this.url()+"/artworks?published=true",{success:function(e){return t.get("artworks").add(e.models)}}):void 0},n.prototype.fetchAllArtworks=function(t){var e=this;return this.fetchMoreArtworks({success:function(){return e.doneFetching?null!=t?t.success():void 0:e.fetchAllArtworks(t)}})},n.prototype.fetchMoreArtworks=function(t){var e,r,o=this;if(!this.fetching&&!this.doneFetching)return this.previousNumberArtworksReturned||(this.previousNumberArtworksReturned=0),this.fetching=!0,e=null!=(null!=t?t.pageSize:void 0)?t.pageSize:this.pageSize,r={published:!0,size:e,offset:this.previousNumberArtworksReturned||0},App.Repositories.Artworks.getFromUrl(""+this.url()+"/artworks?"+$.param(r),{success:function(e){var r;return o.previousNumberArtworksReturned+=e.length,r=o.get("artworks"),r.add(e.models),o.fetching=!1,(r.length>=o.get("eligible_artworks_count")||0===(null!=e?e.models.length:void 0))&&(o.doneFetching=!0),null!=t?"function"==typeof t.success?t.success(e):void 0:void 0},error:function(e,r){return null!=t?"function"==typeof t.error?t.error(e,r):void 0:void 0}})},n}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.PostArtwork=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="post_artwork",o.prototype.relations=[{type:"HasOne",key:"artwork",model:"Artwork"}],o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.PostEmbed=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="post_embed",o.prototype.url=function(){var t;return t=null!=this.get("post")?this.get("post").get("id"):App.postDialog.model.get("id"),"/api/v1/post/"+t+"/embed/"+(this.get("id")||"")},o.prototype.imageSrc=function(){return"/assets/posts/video-placeholder.png"},o.prototype.errorMessage=function(){return"We're sorry, that embed code is unsupported."},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.PostImage=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.modelName="post_image",i.prototype.url=function(){var t;return t=null!=this.get("post")?this.get("post").get("id"):App.postDialog.model.get("id"),"/api/v1/post/"+t+"/image/"+(this.get("id")||"")},i.prototype.hasImage=function(t){return null==t&&(t="small"),"original"===t?!0:o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){var e;return null==t&&(t="small"),e=App.imageUrl(this,t),-1===e.indexOf("missing")?e:App.imageUrl(this,"original")},i.prototype.thumbnailUrl=function(){return this.hasImage("small")?App.imageUrl(this,"small"):App.imageUrl(this,"original")},i}(App.Models.AdditionalImage)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.PostLink=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="post_link",o.prototype.pollTimeout=15e3,o.prototype.fetchDelay=null,o.prototype.url=function(){var t;return t=null!=this.get("post")?this.get("post").get("id"):App.postDialog.model.get("id"),"/api/v1/post/"+t+"/link/"+(this.get("id")||"")},o.prototype.hasEmbed=function(){return this.isVideo()||this.isRich()?null!=this.get("oembed_json").html:!1},o.prototype.isVideo=function(){var t;return"video"===(null!=(t=this.get("oembed_json"))?t.type:void 0)},o.prototype.isImage=function(){var t;return"photo"===(null!=(t=this.get("oembed_json"))?t.type:void 0)},o.prototype.isRich=function(){var t;return"rich"===(null!=(t=this.get("oembed_json"))?t.type:void 0)},o.prototype.safeEmbedElement=function(t){var e,r,o;return null==t&&(t=600),r=$(this.get("oembed_json").html).empty(),r.attr("src")?(r.attr("src",r.attr("src").replace(/^https?:/,"")),o=parseInt(r.attr("width")),e=parseInt(r.attr("height")),o>t&&(r.attr("width",t),r.attr("height",t*(e/o))),r):void 0},o.prototype.safeEmbedHtml=function(t){return null==t&&(t=600),this.safeEmbedElement(t).wrap("<div></div>").parent().html()},o.prototype.canBeDisplayed=function(){return this.isImage()||this.hasEmbed()&&this.safeEmbedElement()},o.prototype.title=function(){return this.get("oembed_json").title},o.prototype.sourceName=function(){return this.get("oembed_json").provider_name},o.prototype.errorMessage=function(){var t;return(null!=(t=this.get("oembed_json"))?t.error_message:void 0)||("invalid"===this.get("oembed_status")?"Please enter a URL to an image or video.":void 0)},o.prototype.imageSrc=function(){return this.isImage()?this.get("url"):this.get("oembed_json").thumbnail_url},o.prototype.imageWidth=function(){return this.isImage()?this.get("oembed_json").width:this.get("oembed_json").thumbnail_width},o.prototype.imageHeight=function(){return this.isImage()?this.get("oembed_json").height:this.get("oembed_json").thumbnail_height},o.prototype.maxHeightForWidth=function(t){var e,r;return e=this.aspectRatio(),null!=e?(r=Math.round(t/e),r>this.imageHeight()?this.imageHeight():r):t},o.prototype.maxWidthForWidth=function(t){return t>this.imageWidth()?this.imageWidth():t},o.prototype.aspectRatio=function(){var t,e;return e=this.imageWidth(),t=this.imageHeight(),e&&t?e/t:null},o.prototype.poll=function(t,e){var r,o=this;return null==t&&(t=500),null==(r=this.fetchStart)&&(this.fetchStart=new Date),this.fetchDelay=_.delay(function(){return o.fetch({success:function(r){var i;if(i=r.get("oembed_status"),new Date-o.fetchStart>o.pollTimeout&&"pending"===i)return null!=e&&"function"==typeof e.error&&e.error(r),window.clearTimeout(o.fetchDelay),r.destroy(),void 0;switch(r.get("oembed_status")){case"success":return null!=e?"function"==typeof e.success?e.success(r):void 0:void 0;case"pending":return r.poll(t,e);default:return null!=e?"function"==typeof e.error?e.error(r):void 0:void 0}},error:null!=e?e.error:void 0})},t)},o.prototype.save=function(t,e){var r,o=this;return r=this.isNew()?"POST":"PUT",$.ajax({type:r,url:this.url(),data:{id:this.get("id"),url:this.get("url")},success:function(t){return o.set(t),e.success(o,t)},error:function(t){var r;return o.set({oembed_status:null!=(r=$.parseJSON(t.responseText))?r.oembed_status:void 0}),e.error(o,t)}})},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Profile=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.GALLERY_OWNER_TYPES=["PartnerGallery"],o.prototype.INSTITUTION_OWNER_TYPES=["PartnerMuseum","PartnerArtistEstate","PartnerPrivateCollection","PartnerFoundation","PartnerPublicDomain","PartnerImageArchive","PartnerNonProfit"],o.prototype.HUMANIZED_PARTNER_OWNER_TYPES={PartnerGallery:"Gallery",PartnerMuseum:"Museum",PartnerArtistEstate:"Artist Estate",PartnerPrivateCollection:"Private Collection",PartnerFoundation:"Foundation",PartnerPublicDomain:"Public Domain",PartnerImageArchive:"Image Archive",PartnerNonProfit:"Non-Profit"},o.prototype.USER_OWNER_TYPES=["User","Admin"],o.prototype.urlRoot="/api/v1/profile",o.prototype.relations=[{type:"HasOne",key:"icon",model:"ProfileIcon"},{type:"HasOne",key:"cover_image",model:"ProfileCover"}],o.prototype.get=function(t){var e,r;return"owner"===t?(r=o.__super__.get.apply(this,arguments),"function"==typeof(null!=r?r.get:void 0)?r:(e=this.isUser()?new App.Models.User(r):"FairOrganizer"===this.get("owner_type")?new App.Models.FairOrganizer(r):this.isPartner()?new App.Models.Partner(r):null,this.set({owner:e},{silent:!0}),e)):o.__super__.get.apply(this,arguments)},o.prototype.isUser=function(){return _.contains(this.USER_OWNER_TYPES,this.get("owner_type"))},o.prototype.isPartner=function(){return this.isInstitution()||this.isGallery()},o.prototype.isInstitution=function(){return _.contains(this.INSTITUTION_OWNER_TYPES,this.get("owner_type"))},o.prototype.isGallery=function(){return _.contains(this.GALLERY_OWNER_TYPES,this.get("owner_type"))},o.prototype.frameName=function(){var t,e;if("FairOrganizer"===this.get("owner_type"))return"small_fair"===(null!=(t=this.get("owner"))?null!=(e=t.get("defaultFair"))?e.get("layout"):void 0:void 0)?"smallFairProfile":"fairProfile";if(this.isPartner()){if(this.isInstitution())return"institutionProfile";if(this.isGallery())return"galleryProfile"}return"userProfile"},o.prototype.ensureSubmodelsFetched=function(t){return"FairOrganizer"===this.get("owner_type")?this.get("owner").ensureDefaultFairFetched(t):"function"==typeof t?t():void 0},o.prototype.fetchCurrentPost=function(t){return this.get("id")?App.Collections.Posts.fetchFromUrl("/api/v1/profile/"+this.get("id")+"/posts/unpublished",{success:function(e){return e.length>0?null!=t?t.success(e.first()):void 0:null!=t?t.error():void 0}}):null!=t?t.error():void 0},o.prototype.fetchCoverImage=function(t){var e=this;return this.get("id")?this.get("coverFetched")?this.get("cover_image"):$.ajax("/api/v1/profile/"+this.get("id")+"/cover_image",{type:"GET",success:function(r){var o;return o=new App.Models.ProfileCover(r),e.set("coverFetched",!0),e.set("cover_image",o),r?null!=t?t.success(o):void 0:null!=t?t.error():void 0},error:function(r){return e.set("coverFetched",!0),404===r.status&&(r.suppressAppMessages=!0),null!=t?"function"==typeof t.error?t.error(r):void 0:void 0}}):null!=t?t.error():void 0},o.prototype.hasPosts=function(){return this.get("posts_count")>0||this.get("reposts_count")>0},o.prototype.isCurrentProfile=function(){return null!=App.currentProfile&&this.get("id")===App.currentProfile.get("id")},o.prototype.defaultIconInitials=function(){var t;return null!=this.iconInitials?this.iconInitials:(this.iconInitials="",this.isPartner()&&(t=function(t,e){return e[0]?t+e[0]:t},this.iconInitials=_.reduce(this.displayName().split(" "),t,"").slice(0,3)),this.iconInitials)},o.prototype.displayName=function(){var t;return null!=(t=this.get("owner"))?t.getRaw("name"):void 0},o.prototype.iconClass=function(){return this.get("default_icon_version")},o.prototype.followMessage=function(){return"You are now following "+this.displayName()+"."},o.prototype.unfollowMessage=function(){return"You will no longer receive any updates from "+this.displayName()+"."},o.prototype.follow=function(t){return App.currentUser.get("followProfiles").followProfile(this,t)},o.prototype.unfollow=function(t){return App.currentUser.get("followProfiles").unfollowProfile(this,t)},o.prototype.following=function(){return App.currentUser.get("followProfiles").following(this)},o.prototype.formatFollowText=function(){var t;if(this.has("follows_count"))return t=this.get("follows_count"),""+App.formatNumber(t)+" Follower"+(1===t?"":"s")},o.prototype.formatPartnerType=function(){return this.HUMANIZED_PARTNER_OWNER_TYPES[this.get("owner_type")]},o.prototype.formatLocationText=function(){return this.isPartner()?this.get("owner").formatLocationText():this.get("location")?this.get("location").toString():void 0},o.prototype.formatLocationAndPartnerType=function(){return _.compact(_.flatten([this.formatPartnerType(),this.formatLocationText()])).join(" - ")},o.prototype.searchPath=function(){return"/"+this.get("id")},o.prototype.getDisplayType=function(){return"FairOrganizer"===this.get("owner_type")?"AuctionProfile"===this.get("subtype")?"auction":"fair":void 0},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.ProfileCover=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.defaults={profileId:-1},i.prototype.url=function(){return"/api/v1/profile/"+this.get("profileId")+"/cover_image"},i.prototype.hasImage=function(t){return null==t&&(t="circle"),o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){return this.hasImage(t)?App.imageUrl(this,t):!1},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.ProfileIcon=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.defaults={profileId:-1},i.prototype.url=function(){return"/api/v1/profile/"+this.get("profileId")+"/icon"},i.prototype.hasImage=function(t){return null==t&&(t="circle"),o.call(this.get("versions")||[],t)>=0},i.prototype.imageUrl=function(t){return this.hasImage(t)?App.imageUrl(this,t).replace(".jpg",".png"):!1},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Models.RelatedArtworksSet=function(r){function i(){return this.syncId=e(this.syncId,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.relatedUrlRoot=function(){return"/api/v1/me/related/artwork/"+this.get("queryArtwork").id},i.prototype.unrelatedUrlRoot=function(){return"/api/v1/me/unrelated/artwork/"+this.get("queryArtwork").id},i.prototype.queryParams=function(){return null!=this.searchIndex?"?search_index="+this.searchIndex:""},i.prototype.initialize=function(t){if(this.set({queryArtwork:t.queryArtwork,searchIndex:t.searchIndex}),!this.get("id")&&!this.get("queryArtwork").id)throw"You must specify a query artwork or an ID";return null!=this.get("id")?this.setAttributesFromId():this.setIdFromAttributes(),this.bind("change:queryArtwork",this.syncId),this.bind("change:searchIndex",this.syncId),this.bind("change:id",this.syncId)},i.prototype.syncId=function(){return this.hasChanged("id")?this.setAttributesFromId():this.hasChanged("queryArtwork")||this.hasChanged("searchIndex")?this.setIdFromAttributes():void 0},i.prototype.setAttributesFromId=function(){return this.set({queryArtwork:App.Repositories.Artworks.getOrFetch(this.get("id").split(":")[0]),searchIndex:this.get("id").split(":")[1]},{silent:!0})},i.prototype.setIdFromAttributes=function(){var t;return this.set({id:""+this.get("queryArtwork").id+":"+(null!=(t=this.get("searchIndex"))?t:"")},{silent:!0})},i.prototype.fetch=function(t){var e=this;return $.getJSON(this.relatedArtworksUrl(),function(r){return e.set({relatedArtworks:r}),null!=t?"function"==typeof t.success?t.success(r):void 0:void 0
}),$.getJSON(this.unrelatedArtworksUrl(),function(r){return e.set({unrelatedArtworks:r}),null!=t?"function"==typeof t.success?t.success(r):void 0:void 0})},i.prototype.relatedArtworksUrl=function(){return""+this.relatedUrlRoot()+"/artworks"+this.queryParams()},i.prototype.unrelatedArtworksUrl=function(){return""+this.unrelatedUrlRoot()+"/artworks"+this.queryParams()},i.prototype.markRelatedUrl=function(t){return""+this.relatedUrlRoot()+"/artwork/"+t.id+this.queryParams()},i.prototype.markUnrelatedUrl=function(t){return""+this.unrelatedUrlRoot()+"/artwork/"+t.id+this.queryParams()},i.prototype.markArtworkRelated=function(t){var e=this;return $.ajax(this.markUnrelatedUrl(t),{type:"DELETE",success:function(){return $.ajax(e.markRelatedUrl(t),{type:"POST",success:function(){var r;return e.markArtworkRelatedLocally(t),null!=(r=e.reciprocalSet(t))?r.markArtworkRelatedLocally(e.get("queryArtwork")):void 0}})}}),!1},i.prototype.markArtworkRelatedLocally=function(t){return this.isUnrelated(t)&&this.set({unrelatedArtworks:_.reject(this.get("unrelatedArtworks"),function(e){return e.id===t.get("id")})}),this.set({relatedArtworks:this.get("relatedArtworks").concat([t])}),this.trigger("relationChange-"+t.id)},i.prototype.unmarkArtworkRelated=function(t){var e=this;return $.ajax(this.markRelatedUrl(t),{type:"DELETE",success:function(){var r;return e.unmarkArtworkRelatedLocally(t),null!=(r=e.reciprocalSet(t))?r.unmarkArtworkRelatedLocally(e.get("queryArtwork")):void 0}}),!1},i.prototype.unmarkArtworkRelatedLocally=function(t){return this.isRelated(t)?(this.set({relatedArtworks:_.reject(this.get("relatedArtworks"),function(e){return e.id===t.get("id")})}),this.trigger("relationChange-"+t.id)):void 0},i.prototype.markArtworkUnrelated=function(t){var e=this;return $.ajax(this.markRelatedUrl(t),{type:"DELETE",success:function(){return $.ajax(e.markUnrelatedUrl(t),{type:"POST",success:function(){var r;return e.markArtworkUnrelatedLocally(t),null!=(r=e.reciprocalSet(t))?r.markArtworkUnrelatedLocally(e.get("queryArtwork")):void 0}})}}),!1},i.prototype.markArtworkUnrelatedLocally=function(t){return this.isRelated(t)&&this.set({relatedArtworks:_.reject(this.get("relatedArtworks"),function(e){return e.id===t.get("id")})}),this.set({unrelatedArtworks:this.get("unrelatedArtworks").concat([t])}),this.trigger("relationChange-"+t.id)},i.prototype.unmarkArtworkUnrelated=function(t){var e=this;return $.ajax(this.markUnrelatedUrl(t),{type:"DELETE",success:function(){var r;return e.unmarkArtworkUnrelatedLocally(t),null!=(r=e.reciprocalSet(t))?r.unmarkArtworkUnrelatedLocally(e.get("queryArtwork")):void 0}}),!1},i.prototype.unmarkArtworkUnrelatedLocally=function(t){return this.isUnrelated(t)?(this.set({unrelatedArtworks:_.reject(this.get("unrelatedArtworks"),function(e){return e.id===t.get("id")})}),this.trigger("relationChange-"+t.id)):void 0},i.prototype.reciprocalSet=function(t){var e;return e=""+t.id+":"+this.get("searchIndex"),App.Repositories.RelatedArtworksSets.get(e)},i.prototype.isRelated=function(t){return _.find(this.get("relatedArtworks"),function(e){return e.id===t.id})},i.prototype.isUnrelated=function(t){return _.find(this.get("unrelatedArtworks"),function(e){return e.id===t.id})},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Repost=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"profile",model:"Profile"}],o.prototype.isMine=function(){var t,e;return(null!=(t=App.currentProfile)?t.get("id"):void 0)&&(null!=(e=this.get("profile"))?e.get("id"):void 0)===App.currentProfile.get("id")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Sale=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.modelName="sale",o.prototype.relations=[{type:"HasOne",key:"profile",model:"Profile"},{type:"HasMany",key:"sets",model:"OrderedSet"},{type:"HasMany",key:"saleArtworks",model:"SaleArtworks"}],o.prototype.urlRoot="/api/v1/sale/",o.prototype.url=function(){return""+this.urlRoot+this.get("id")},o.prototype.page=1,o.prototype.pageSize=30,o.prototype.doneFetching=function(){return this.get("saleArtworksFetched")},o.prototype.initialize=function(){return this.on("change",this.updateState)},o.prototype.calculateOffsetTimes=function(t){var e=this;return null==t&&(t={}),App.serverTime({success:function(r){var o,i,n;return n=moment(e.get("start_at")).unix(),o=moment(e.get("end_at")).unix(),i=r.unix-moment().unix(),e.set("offsetStartAtInSeconds",n-i),e.set("offsetEndAtInSeconds",o-i),e.updateState(),null!=(null!=t?t.success:void 0)?t.success():void 0},error:null!=t?t.error:void 0})},o.prototype.started=function(){return moment().unix()>=this.get("offsetStartAtInSeconds")},o.prototype.ended=function(){return moment().unix()>=this.get("offsetEndAtInSeconds")},o.prototype.updateState=function(){return null!=this.get("offsetEndAtInSeconds")&&this.get("offsetStartAtInSeconds")?this.ended()?this.set("auctionState","closed"):this.started()?this.set("auctionState","open"):this.set("auctionState","preview"):void 0},o.prototype.fetchSaleArtworks=function(t){var e=this;return this.doneFetching()?null!=t?t.success(this):void 0:App.Collections.SaleArtworks.fetchFromUrl(""+this.url()+"/sale_artworks?size="+this.pageSize+"&page="+this.page,{success:function(r){return App.Repositories.SaleArtworks.add(r.models,{merge:!0}),e.page=e.page+1,e.get("saleArtworks")||e.set("saleArtworks",new App.Collections.SaleArtworks),e.get("saleArtworks").add(r.models),(e.get("saleArtworks").length>=e.get("eligible_sale_artworks_count")||r.length<1)&&e.set("saleArtworksFetched",!0),null!=t?t.success(e,r):void 0}})},o.prototype.createBidder=function(t){return null==t&&(t={}),$.ajax("/api/v1/bidder",{type:"POST",data:{sale_id:this.get("id")},success:null!=t?t.success:void 0})},o.prototype.isRegisterable=function(){return this.get("auction_state")&&"closed"!==this.get("auction_state")},o.prototype.checkCurrentUserRegistered=function(t){var e=this;return null==t&&(t={}),$.ajax("/api/v1/me/bidders",{data:{sale_id:this.get("id")},success:function(r){return e.set("currentUserRegistered",r.length>0),null!=t?t.success():void 0}})},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.SaleArtwork=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasOne",key:"artwork",model:"Artwork"}],o.prototype.reserveFormat={no_reserve:void 0,reserve_met:"Reserve met",reserve_not_met:"Reserve not met"},o.prototype.urlRoot="/api/v1/sale/",o.prototype.formatOpeningBid=function(){return"$"+App.numberToMoney(this.get("opening_bid_cents")||100)},o.prototype.formatHighestBid=function(){return null!=this.get("highest_bid_amount_cents")?"$"+App.numberToMoney(this.get("highest_bid_amount_cents")):"N/A"},o.prototype.formatMinimumNextBid=function(){return"$"+App.numberToMoney(this.get("minimum_next_bid_cents"))},o.prototype.formatEstimate=function(){var t;return null!=this.get("low_estimate_cents")||null!=this.get("high_estimate_cents")?null!=this.get("low_estimate_cents")&&null!=this.get("high_estimate_cents")?"$"+App.numberToMoney(this.get("low_estimate_cents"))+"&ndash;$"+App.numberToMoney(this.get("high_estimate_cents")):(t=_.compact([this.get("low_estimate_cents"),this.get("high_estimate_cents")])[0],"$"+App.numberToMoney(t)):void 0},o.prototype.formatBidsAndReserve=function(){var t,e,r;return this.get("bidder_positions_count")>0&&(t=App.pluralizeWithNumber(this.get("bidder_positions_count"),"Bid")),r=this.reserveFormat[this.get("reserve_status")],e=_.compact([t,r]).join(", "),e?"("+e+")":void 0},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.SearchRow=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.relations=[{type:"HasMany",key:"artworks",model:"Artworks"},{type:"HasMany",key:"display_genes",model:"Genes"}],o.prototype.hasGenes=function(){return null!=this.get("display_genes")&&0!==this.get("display_genes")},o.prototype.hasArtworks=function(){return null!=this.get("artworks")&&0!==this.get("artworks")},o.prototype.isInfluenceCategory=function(){return-1!==this.get("category").name.toLowerCase().indexOf("influence")},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.SearchSuggestion=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Tag=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.urlRoot="/api/v1/tag/",o.prototype.searchPath=function(){return"/tag/"+this.get("id")},o.prototype.displayName=function(){return"Artwork related to &#x201C;"+this.get("name")+"&#x201D"},o}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t},o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};App.Models.Video=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.modelName="Video",i.prototype.defaults={image_versions:[],defaultImageSize:"small_square"},i.prototype.imageSizes=[["small_square",{width:100,height:100}],["medium_square",{width:200,height:200}],["large_square",{width:400,height:400}],["medium_rectangle",{width:260,height:195}],["large_rectangle",{width:640,height:480}],["large_cinematic",{width:1600,height:900}]],i.prototype.hasImage=function(t){return null==t&&(t=this.defaultImageSize),o.call(this.get("image_versions")||[],t)>=0},i.prototype.imageUrl=function(t){return null==t&&(t=this.defaultImageSize),App.imageUrl(this,t)},i.prototype.aspectRatio=function(){return this.get("original_width")/this.get("original_height")},i.prototype.posterUrl=function(t){return this.hasImage(t)?this.imageUrl(t):this.imageUrl()},i.prototype.srcUrl=function(t,e){return null==e&&(e="high"),"high"===e?""+this.get("hr_video_url")+t:""+this.get("lr_video_url")+t},i.prototype.layoutStyle=function(){switch(!1){case 1!==this.collection.length:return"full";case 2!==this.collection.length:return"half";case 3!==this.collection.length:return"third";case!(this.collection.length>3):return"quarter"}},i}(App.Models.DomainAbstract)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.FairFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.getCurrentRoute=function(t){var e,r;return r="","filter"===this.get("tab")?(e="all"===this.get("filterName")?"":""+this.get("filterType")+"="+this.get("filterName"),(null!=e?e.length:void 0)>1&&(r="/"+e)):"partnerShowsList"===this.get("tab")?this.get("filterName")&&"all"!==this.get("filterName")&&(r="/"+this.get("filterType")+"="+this.get("filterName")):"artist"===this.get("tab")?r="/"+this.get("artistId"):"partnerShow"===this.get("tab")&&(r="/"+this.get("partnerId")),"/"+t+r},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.GenePage=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.defaults={artistPageSize:12,artworkPageSize:24,artists:[],artworks:[],filteringRequested:!1},o.prototype.initialize=function(t){return this.bind("change:geneId",this.onGeneIdUpdate,this),null!=(null!=t?t.params:void 0)?this.params=$.deparam(t.params):void 0},o.prototype.onGeneIdUpdate=function(){var t;return t=this.get("geneId"),this.filter=new App.Models.ArtworkFilter({params:this.params,geneId:t}),this.filter.bind("change:filteringAvailable",this.onFilteringAcquired,this)},o.prototype.onFilteringAcquired=function(){var t=this;return this.set({filteringRequested:!0}),App.Repositories.Genes.getOrFetch(this.get("geneId"),["name","type"],{success:function(e){return e.isSubjectMatter()?t.set({gene:e}):App.Collections.Artists.fetchFromUrl("/api/v1/gene/"+e.get("id")+"/artists?size="+t.get("artistPageSize")+"&exclude_artists_without_artworks=true&min_value=50",{success:function(r){return t.set({gene:e}),t.set({artists:r})}})}})},o.prototype.getUnfilteredArtworks=function(){var t=this;return App.Repositories.Artworks.getFromUrl("/api/v1/gene/"+this.get("gene").get("id")+"/artworks?size="+this.get("artworkPageSize")+"&min_value=50",{success:function(e){return t.set({artworks:e})}})},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Password=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.url=function(){return"/api/v1/me/password"},o.prototype.validationMessages={new_password_min:"Minimum 6 characters.",new_password_same:"Your new password must be different.",password_confirmation:"Passwords don't match up. Please try again.",current_password:"Your current password is incorrect. Please try again."},o.prototype.getErrorMessage=function(t){return this.validationMessages[t]},o.prototype.validate=function(t){var e;return e={},t.new_password&&t.new_password.length<6?e.new_password=this.getErrorMessage("new_password_min"):t.new_password&&t.new_password===t.current_password&&(e.new_password=this.getErrorMessage("new_password_same")),t.password_confirmation&&t.password_confirmation!==t.new_password&&(e.password_confirmation=this.getErrorMessage("password_confirmation")),_.size(e)>0?e:void 0},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Recommendations=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.fetchRelated=function(t){return $.getJSON("/api/v1/me/suggested/artworks",function(e){var r;return r=e.error?e:_.map(e,function(t){var e,r;return e=_.map(t.artworks,function(t){return new Artwork(t)}),r=new App.Collections.Artworks(e),{categoryName:t.category.name,categoryId:t.category.id,description:"Recommended",artworks:r,genes:t.display_genes,searchHash:function(){var e;return e=$.deparam(window.location.hash.replace("#search/","")),delete e.category,e.max_works_per_category=120,e.category=[t.category.id],$.param.fragment.noEscape("[]"),$.param.fragment("",e)},isCurrent:function(){var e;return e=$.deparam(window.location.hash).category,e?e.toString()===t.category.id:!1}}}),t(r)})},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.Templates=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.name="ArtsyTemplates",o.prototype.options={optimize:!0},o.prototype.render=function(t,e,r){return this.getOrCreate(t)(e,r)},o.prototype.getOrCreate=function(t){return this.get(t)||this.create(t)},o.prototype.set=function(t){var e;return e={},e[t]=Haml(t,this.options),o.__super__.set.call(this,e)},o.prototype.create=function(t){return this.set(t),this.get(t)},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Models.ViewState=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.frames={},o.prototype.currentFrame=null,o.prototype.defaults={isLoading:!0,browseIsOn:!1},o.prototype.initialize=function(t){var e=this;return this.frames=t,App.$document.ajaxStart(function(){return e.set({isLoading:!0})}),App.$document.ajaxStop(function(){return e.set({isLoading:!1})})},o.prototype.isRendered=function(t,e){var r,o,i,n,s;return null==e&&(e={}),r=null!=(null!=(o=this.frames[t])?o.frame:void 0)&&null!=(null!=(i=this.frames[t])?i.params:void 0)&&_.isEqual(this.frames[t].params,e),!(!r&&!(null!=(n=this.frames[t])?null!=(s=n.frame)?"function"==typeof s.isRendered?s.isRendered(e):void 0:void 0:void 0))},o.prototype.setFrame=function(t,e){var r,o,i,n=this;return null==e&&(e={}),t===this.currentFrame&&_.isEqual(this.frames[t].params,e)?void 0:(i=_.clone(e),i.viewState=this,this.isRendered(t,e)&&this.frames[t]?(o=this.frames[t].frame,o.options=i,r="frameLoad"):(o=new this.frames[t].obj(i),r="frameRender"),null!=this.currentFrame?(this.trigger("frameUnload:"+this.currentFrame),this.ensureOnlyOneVisibleFrame(),this.frames[this.currentFrame].frame.unload(function(){return App.$window.scrollTop(0),App.$body.hasClass("clip")&&App.$body.removeClass("clip").trigger("overflowUpdate"),n.trigger(""+r+":"+t),"frameRender"===r?(o.render(),o.setDocumentTitle()):n.frames[t].frame.load(function(){return n.ensureOnlyOneVisibleFrame(),App.$window.scrollTop(n.frames[t].frame.scrollTopVal),o.setDocumentTitle()}),n.currentFrame=t})):(this.currentFrame=t,this.trigger(""+r+":"+t),o.render()),App.currentFrameView=this.frames[t].frame=o,this.frames[t].params=e,App.previousFrameName=App.currentFrameName,App.currentFrameName=t,_.defer(function(){return n.unrenderOldFrames()}))},o.prototype.unrenderOldFrames=function(){var t=this;return _.map(_.keys(this.frames),function(e){return t.frames[e]&&t.frames[e].frame&&e!==App.previousFrameName&&e!==App.currentFrameName?t.unrenderFrame(e):void 0})},o.prototype.unrenderFrame=function(t){return this.frames[t]&&null!=this.frames[t].frame?(this.trigger("frameUnload:"+t),this.frames[t].frame.onUnload(),this.frames[t].frame.stopListening(),this.frames[t].frame.$el.empty(),delete this.frames[t].frame,delete this.frames[t].params):void 0},o.prototype.ensureOnlyOneVisibleFrame=function(){var t,e=this;return t=$("#frames > .frame:visible"),t.length>1?t.each(function(t,r){return r.id!==e.frames[e.currentFrame].frame.el.id?$(r).hide():void 0}):void 0},o.prototype.saveScrollPosition=function(){var t;return null!=this.currentFrame?null!=(t=this.frames[this.currentFrame].frame)?t.scrollTopVal=App.$window.scrollTop():void 0:void 0},o}(Backbone.Model)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.AdditionalImages=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.AdditionalImage,App.Repositories.AdditionalImages=App.Repository.extend(o),o.prototype.primaryImage=function(){var t;return t=this.find(function(t){return t.get("is_default")}),t||(t=this.first()),t},o.prototype.defaultImage=function(){return this.primaryImage()||new App.Models.DefaultImage},o.prototype.hasDefaultImage=function(){return this.length>0},o.prototype.comparator=function(t){return t.get("is_default")?0:t.get("position")||1},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Artists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Artist,o.prototype.withArtworks=function(){return this.filter(function(t){return t.get("published_artworks_count")>0})},App.Repositories.Artists=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.ArtworkShares=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.ArtworkShare,o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Artworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Artwork,o.formatSeeMoreText=function(t){var e;return e=t>1?"s":"","See "+t+" More Artwork"+e},App.Repositories.Artworks=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Authentications=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Authentication,o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.BidderPositions=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.BidderPosition,o.prototype.urlRoot="/api/v1/me/bidder_positions",o.prototype.url=function(){return""+this.urlRoot+"?sale_id="+this.get("sale_id")+"&artwork_id="+this.get("artwork_id")},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.ComparableSales=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.ComparableSale,App.Repositories.ComparableSales=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.FairOrganizers=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.FairOrganizer,App.Repositories.FairOrganizers=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Fairs=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Fair,App.Repositories.Fairs=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.FeaturedArtworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Artwork,App.Repositories.FeaturedArtworks=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.FeaturedLinks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.FeaturedLink,App.Repositories.FeaturedLinks=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Features=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Feature,App.Repositories.Features=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Collections.FeedItems=function(r){function i(){return this.parse=e(this.parse,this),this.fetchFeedItems=e(this.fetchFeedItems,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.model=App.Models.FeedItem,i.prototype.urlRoot="/api/v1/me/feed",i.prototype.pageSize=3,i.prototype.nextPage=1,i.prototype.fetchRetryMax=1,i.prototype.fetchRetries=0,i.prototype.doneFetching=!1,i.prototype.fetchFeedItems=function(t){var e,r,o,i,n=this;if(!this.fetching&&!this.doneFetching)return this.fetching=!0,r=t.pageSize||this.pageSize,o={size:r},this.cursor&&(o.cursor=this.cursor),this.page&&(o.page=this.page),this.feedId&&(o.feed=this.feedId),t.artworks&&(o.artworks=t.artworks),t.sort&&(o.sort=t.sort),i=this.urlRoot+"?"+$.param(o),t.additionalParams&&(e=$.param(t.additionalParams),(null!=e?e.length:void 0)>0&&(i=""+i+"&"+e)),App.Collections.FeedItems.fetchFromUrl(i,{success:function(e){return n.add(e.models),null!=e.cursor?(n.cursor=e.cursor,n.feedId=e.feedId,null==n.cursor&&(n.doneFetching=!0)):(n.page||(n.page=1),n.page=n.page+1,0===e.models.length&&(n.doneFetching=!0)),n.fetching=!1,null!=t?"function"==typeof t.success?t.success(e):void 0:void 0},error:function(e,r){return null!=t?"function"==typeof t.error?t.error(e,r):void 0:void 0}})},i.prototype.getNearestItem=function(t){var e,r,o,i,n;for(n=this.models,o=0,i=n.length;i>o;o++)r=n[o],r.get("top")<=t&&r.get("bottom")>=t&&(e=r);return e},i.prototype.getActiveItem=function(){var t,e,r,o;for(o=this.models,e=0,r=o.length;r>e;e++)if(t=o[e],t.get("active"))return t},i.prototype.parse=function(t){return t.results?(this.cursor=t.next,this.feedId=t.feed,t.results):t},i.prototype.removeFlagged=function(){var t;return t=this.filter(function(t){return!t.flagged()||t.get("author").id===App.currentUser.get("id")||App.currentUser.isAdmin()}),this.reset(t)},App.Repositories.FeedItems=App.Repository.extend(i),i}(App.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Collections.FollowArtists=function(r){function i(){return this.getByArtist=e(this.getByArtist,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.urlRoot="/api/v1/me/follow/artist",i.prototype.url="/api/v1/me/follow/artists",i.prototype.model=App.Models.FollowArtist,i.prototype.followArtist=function(t,e){var r=this;return $.ajax(""+this.urlRoot+"?artist_id="+t.get("id"),{type:"POST",success:function(o){return r.add(new App.Models.FollowArtist(o)),(null!=e?e.silent:void 0)||r.trigger("add:"+t.get("id")),null!=e?"function"==typeof e.success?e.success(o):void 0:void 0},error:null!=e?e.error:void 0}),!1},i.prototype.unfollowArtist=function(t,e){var r;return r=this.getByArtist(t),this.remove(r),(null!=e?e.silent:void 0)||this.trigger("remove:"+t.get("id")),$.ajax(""+this.urlRoot+"/"+r.get("id"),{type:"DELETE",success:null!=e?e.success:void 0,error:null!=e?e.error:void 0}),!1},i.prototype.following=function(t){return null==this.models?!1:null!=this.getByArtist(t)},i.prototype.getByArtist=function(t){return _.filter(this.models,function(e){return t.id===e.get("artist").get("id")})[0]},i}(App.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Collections.FollowGenes=function(r){function i(){return this.getByGene=e(this.getByGene,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.urlRoot="/api/v1/me/follow/gene",i.prototype.url="/api/v1/me/follow/genes",i.prototype.model=App.Models.FollowGene,i.prototype.followGene=function(t,e){var r=this;return $.ajax(""+this.urlRoot+"?gene_id="+t.get("id"),{type:"POST",success:function(o){return r.add(new App.Models.FollowGene(o)),r.trigger("add:"+t.get("id")),null!=e?"function"==typeof e.success?e.success(o):void 0:void 0},error:null!=e?e.error:void 0}),!1},i.prototype.unfollowGene=function(t,e){var r;return(r=this.getByGene(t))?(this.remove(r),this.trigger("remove:"+t.get("id")),$.ajax(""+this.urlRoot+"/"+r.get("id"),{type:"DELETE",success:null!=e?e.success:void 0,error:null!=e?e.error:void 0}),!1):void 0},i.prototype.following=function(t){return null!=this.getByGene(t)},i.prototype.getByGene=function(t){return _.filter(this.models,function(e){return t.id===e.get("gene").get("id")})[0]},i}(App.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Collections.FollowProfiles=function(r){function i(){return this.getByProfile=e(this.getByProfile,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.urlRoot="/api/v1/me/follow/profile",i.prototype.url="/api/v1/me/follow/profiles",i.prototype.model=App.Models.FollowProfile,i.prototype.followProfile=function(t,e){var r=this;return $.ajax(""+this.urlRoot+"?profile_id="+t.get("id"),{type:"POST",success:function(o){return r.add(new App.Models.FollowProfile(o)),t.set("follows_count",o.profile.follows_count),r.trigger("add:"+t.get("id"),"add"),null!=e?"function"==typeof e.success?e.success(o):void 0:void 0},error:null!=e?e.error:void 0}),!1},i.prototype.unfollowProfile=function(t,e){var r,o=this;return r=this.getByProfile(t),this.remove(r),$.ajax(""+this.urlRoot+"/"+r.get("id"),{type:"DELETE",success:function(r){return t.set("follows_count",r.profile.follows_count),o.trigger("remove:"+t.get("id"),"remove"),null!=e?"function"==typeof e.success?e.success(r):void 0:void 0},error:null!=e?e.error:void 0}),!1},i.prototype.following=function(t){return null!=this.getByProfile(t)},i.prototype.getByProfile=function(t){return _.filter(this.models,function(e){return t.id===e.get("profile").get("id")})[0]},i.prototype.syncFollows=function(){var t,e,r=this;if(App.currentUser.accountCreated()&&(e=_.filter(App.Repositories.Profiles.pluck("id"),function(t){var e;return t!==(null!=(e=App.currentProfile)?e.get("id"):void 0)}),t=e,this.length>0&&(t=_.map(this.models,function(t){return t.get("profile").get("id")}),t=_.difference(e,t)),0!==t.length))return $.ajax(""+this.url+"?"+$.param({profiles:t}),{type:"GET",success:function(t){var e;return e=[],_.each(t,function(t){return e.push(new App.Models.FollowProfile(t)),r.trigger("add:"+t.profile.id,"add")
}),r.add(e)},error:function(t){return 404===t.status?t.suppressAppMessages=!0:void 0}})},i}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Genes=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Gene,o.prototype.url="/api/v1/genes",App.Repositories.Genes=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.HeroUnits=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.HeroUnit,o.prototype.urlRoot="/api/v1/site_hero_units?enabled=true&desktop=true",o.prototype.url=function(){return this.urlRoot},App.Repositories.HeroUnits=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Invitations=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Invitation,o.prototype.url="/api/v1/me/invitations",o.prototype.initialize=function(){var t=this;return this.unsentInvites=[],this.sentInvites=[],this.failedInvites=[],this.invitesToSend=[],this.bind("add",function(e){return t.unsentInvites.push(e)}),this.bind("reset",this.onReset,this),App.currentUser.bind("reset",this.onReset,this),this.trigger("reset")},o.prototype.unsent=function(){return this.unsentInvites||[]},o.prototype.sent=function(){return this.sentInvites||[]},o.prototype.failed=function(){return this.failedInvites||[]},o.prototype.justSent=function(){return this.justSentInvites||[]},o.prototype.sendable=function(){return _.filter(this.unsent(),function(t){return t.get("name")||t.get("email")})},o.prototype.onReset=function(){var t,e,r,o,i=this;for(this.unsentInvites=[],this.sentInvites=[],this.failedInvites=[],this.invitesToSend=[],o=this.models,e=0,r=o.length;r>e;e++)t=o[e],this.sentInvites.push(t);return _(3).times(function(){return i.add(new App.Models.Invitation)})},o.prototype.save=function(t){var e,r,o,i,n,s,a,l,p,u,h=this;for(this.errors={},this.justSentInvites=[],this.failedInvites=[],this.invitesToSend=this.sendable(),a=this.invitesToSend,o=0,n=a.length;n>o;o++)r=a[o],e=r.validateAttrs(),null!=e&&_.size(e)>0&&(this.errors.collection="");if(0===_.size(this.invitesToSend)&&(this.errors.collection="Please enter at least one e-mail address."),(null!=(l=this.errors.collection)?l.length:void 0)<1)return null!=t?"function"==typeof t.error?t.error(this,""):void 0:void 0;for(p=this.invitesToSend,u=[],i=0,s=p.length;s>i;i++)r=p[i],u.push(r.save(r.attributes,{silent:!0,success:function(e){return h.invitesToSend=_.without(h.invitesToSend,e),h.sentInvites.push(e),h.justSentInvites.push(e),h.unsentInvites=_.without(h.unsentInvites,e),h.onSent(t)},error:function(e,r){var o;return r.responseText?(r.suppressAppMessages=!0,e.errors.email=null!=(o=JSON.parse(r.responseText).text)?o:r.statusText,h.failedInvites.push(e)):null!=t&&"function"==typeof t.error&&t.error(),h.invitesToSend=_.without(h.invitesToSend,e),h.onSent(t)}}));return u},o.prototype.onSent=function(t){var e=this;return 0===this.invitesToSend.length?(_(3-this.unsentInvites.length).times(function(){return e.add(new App.Models.Invitation)}),null!=t?"function"==typeof t.success?t.success(this,200):void 0:void 0):void 0},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Layers=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Layer,o.prototype.initialize=function(t){return this.artwork=null!=t?t.artwork:void 0},o.prototype.layersUrl=function(t){var e;return e=$.param({artwork:[t.id]}),"/api/v1/related/layers?"+e},o.prototype.url=function(){return this.layersUrl(this.artwork)},o.prototype.parse=function(t){var e=this;return _.each(t,function(t){return t.queryArtwork=e.artwork}),o.__super__.parse.apply(this,arguments)},o.prototype.isMainLayer=function(t){return"main"===t.get("id")&&"synthetic"===t.get("type")},o.prototype.isFairLayer=function(t){return"fair"===t.get("type")},o.prototype.isForSaleLayer=function(t){return"for-sale"===t.get("id")&&"synthetic"===t.get("type")},o.prototype.getMainLayers=function(){var t,e,r=this;return e=_.filter(this.models,function(t){return r.isMainLayer(t)?t:void 0}),t=_.filter(this.models,function(t){return r.isFairLayer(t)?t:void 0}),t.length?t:e},o.prototype.hasMainLayers=function(){return this.getMainLayers().length>0},o.prototype.getForSaleLayers=function(){var t=this;return _.filter(this.models,function(e){return t.isForSaleLayer(e)?e:void 0})},o.prototype.getDisplayLayers=function(){var t=this;return _.filter(this.models,function(e){return t.isMainLayer(e)||t.isForSaleLayer(e)||t.isFairLayer(e)?void 0:e})},o.prototype.select=function(t){return this.selection=t,this.trigger("change:selection")},o.prototype.currentLayer=function(){var t;return this.get(null!=(t=this.selection)?t:_.first(this.getMainLayers()).id)},o.prototype.currentArtworks=function(){return this.currentLayer().get("artworks")},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Locations=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Location,App.Repositories.Locations=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.OrderedSets=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.OrderedSet,App.Repositories.OrderedSets=App.Repository.extend(o),o}(App.Collection),_.extend(App.Repositories.OrderedSets,{uniqueKeyItemsCache:{},cacheByKey:function(t,e){return this.uniqueKeyItemsCache[t]=e},fetchItemsByOwner:function(t,e){return this.fetchItems("/api/v1/sets?owner_type="+t+"&owner_id="+e+"&sort=key",""+t+":"+e)},fetchItemsByUniqueKey:function(t,e){return this.fetchItems("/api/v1/sets?key="+t+"&published=true",t,e)},fetchItemByUniqueKey:function(t,e){return this.fetchItemsByUniqueKey(t,e).pipe(function(e){var r,o,i;return r=$.Deferred(),i=e.at(0),i?r.resolve(i):(o=""+t+" not found","undefined"!=typeof console&&null!==console&&console.log(o),r.reject(o)),r.promise()})},fetchItems:function(t,e,r){var o,i,n=this;return i=$.Deferred(),o=this.uniqueKeyItemsCache[e],o?_.defer(function(){return i.resolve(o)}):App.Collections.OrderedSets.fetchFromUrl(t,{success:function(t){var o;return o=t.map(function(t){return t.fetchItems(r)}),$.when.apply($,o).then(function(){return n.uniqueKeyItemsCache[e]=t,i.resolve(t)})}}),i.promise()}})}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Pages=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Page,App.Repositories.Pages=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.PartnerArtists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.PartnerArtist,o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.PartnerLocations=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.PartnerLocation,App.Repositories.PartnerLocations=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.PartnerShows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.PartnerShow,o.prototype.current=function(t){return null==t&&(t=null),new App.Collections.PartnerShows(_.filter(this.models,function(e){return e.running()&&e.renderable()&&e!==t}))},o.prototype.upcoming=function(t){return null==t&&(t=null),new App.Collections.PartnerShows(_.filter(this.models,function(e){return e.upcoming()&&e.renderable()&&e!==t}))},o.prototype.past=function(t){return null==t&&(t=null),new App.Collections.PartnerShows(_.filter(this.models,function(e){return e.closed()&&e.renderable()&&e!==t}))},o.prototype.overviewShows=function(t,e){var r;return null==t&&(t=null),null==e&&(e=6),r=this.current(t).models,r.length<e&&this.upcoming(t).each(function(t){return r.push(t)}),r.length<e&&this.past(t).each(function(t){return r.push(t)}),new App.Collections.PartnerShows(r)},o.prototype.featured=function(){var t,e;return e=this.findWhere({featured:!0}),null!=e?e:(t=this.current().filter(function(t){return t.featurable()}),t=_.sortBy(t,function(t){return moment(t.get("end_at")).unix()}),t.length>0?t[0]:(t=this.upcoming().filter(function(t){return t.featurable()}),t=_.sortBy(t,function(t){return moment(t.get("start_at")).unix()}),t.length>0?t[0]:(t=this.past().filter(function(t){return t.featurable()}),t.length>0?t[0]:void 0)))},App.Repositories.PartnerShows=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Partners=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Partner,App.Repositories.Partners=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.PostAttachments=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=function(t,e){switch(null!=t?t.type:void 0){case"PostArtwork":return new App.Models.PostArtwork(t,e);case"PostLink":return new App.Models.PostLink(t,e);case"PostImage":return new App.Models.PostImage(t,e);case"PostEmbed":return new App.Models.PostEmbed(t,e);default:return o.__super__.model.apply(this,arguments)}},o.prototype.comparator=function(t){return t.get("position")},o.prototype.forFeaturedPostThumb=function(){return _.filter(this.models,function(t){return"PostArtwork"===t.get("type")||"PostImage"===t.get("type")})[0]},App.Repositories.PostAttachments=App.Repository.extend(o),o}(Backbone.Collection)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Collections.Posts=function(r){function i(){return this.parse=e(this.parse,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.model=App.Models.Post,App.Repositories.Posts=App.Repository.extend(i),i.prototype.parse=function(t){return t.results?(this.cursor=t.next,this.feedId=t.feed,t.results):t},i}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.ProfileCovers=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.ProfileCover,App.Repositories.ProfileCovers=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.ProfileIcons=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.ProfileIcon,App.Repositories.ProfileIcons=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Profiles=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Profile,App.Repositories.Profiles=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.RelatedArtworksSets=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.RelatedArtworksSet,App.Repositories.RelatedArtworksSets=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Reposts=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Repost,App.Repositories.Reposts=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.SaleArtworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.SaleArtwork,o.prototype.url="/api/v1/sale",App.Repositories.SaleArtworks=App.Repository.extend(o),o.prototype.comparator=function(t){return t.get("position")},o.prototype.artistComparator=function(t){var e,r;return null!=(e=t.get("artwork"))?null!=(r=e.get("artist"))?r.get("sortable_id"):void 0:void 0},o.prototype.getArtworksSortedByArtist=function(){var t,e;return e=this.comparator,this.comparator=this.artistComparator,this.sort(),t=_.map(this.models,function(t){return t.get("artwork")}),this.comparator=e,this.sort(),t},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Sales=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Sale,App.Repositories.Sales=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.SearchRows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.SearchRow,App.Repositories.SearchRows=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.SearchSuggestions=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.SearchSuggestion,o.prototype.urlRoot="/api/v1/suggested_additions",o.prototype.addSuggestion=function(t,e){var r=this;return $.ajax(""+this.urlRoot,{data:{query:t},type:"POST",success:function(t){var o;return o=new App.Models.SearchSuggestion(t),r.add(o),null!=e?"function"==typeof e.success?e.success(o):void 0:void 0}}),!1},o}(Backbone.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.SuggestedArtworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Artwork,App.Repositories.SuggestedArtworks=App.Repository.extend(o),_.extend(App.Repositories.SuggestedArtworks,{itemsCache:{},key:"homepage:suggested-artworks",cache:function(t){return this.itemsCache[this.key]=t},fetchItems:function(){return this.fetchFromUrlCached("/api/v1/me/suggested/artworks/homepage")},fetchFromCache:function(){return this.itemsCache[this.key]},fetchFromUrlCached:function(t){var e,r,o=this;return r=$.Deferred(),e=this.fetchFromCache(),e?_.defer(function(){return r.resolve(e)}):App.Collections.SuggestedArtworks.fetchFromUrl(t,{success:function(t){return o.cache(t),r.resolve(t)}}),r.promise()}}),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Tags=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Tag,App.Repositories.Tags=App.Repository.extend(o),o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Users=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.User,App.Repositories.Users=App.Repository.extend(o),o.prototype.fetchAvailableRepresentative=function(t){var e=this;if(!this.fetching&&!this.doneFetching)return App.Collections.Users.fetchFromUrl("/api/v1/admins/available_representatives",{success:function(r){var o;return o=r.models[0],o?(e.add(o),o.fetchWithProfile(t)):(e.addDefaultRep(),null!=t?t.success():void 0)},error:function(e,r){return null!=t?"function"==typeof t.error?t.error(e,r):void 0:void 0}})},o.prototype.addDefaultRep=function(){var t;return t=new App.Models.User({name:"Rebecca Bronfein Raphael",email:"rebecca@artsymail.com"}),this.add(t)},o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Collections.Videos=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.model=App.Models.Video,o}(App.Collection)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Shared.AToZFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype["class"]="a-to-z-frame",o.prototype.defaultPageSize=100,o.prototype.render=function(){var t=this;return this.$el.addClass("loading").show(),this.setDocumentTitle(),this.collection=this.getCollection(),this.collection.defaultPageSize=this.defaultPageSize,this.collection.fetchAllPages().then(function(){return t.onAllPagesFetched()})},o.prototype.getCollection=function(){throw new Error("getCollection() must be implemented")},o.prototype.getListViewClass=function(){throw new Error("getListViewClass() must be implemented")},o.prototype.onAllPagesFetched=function(){var t,e;return e=this.getListViewClass(),t=new e({collection:this.collection}),t.render(),this.$el.html(t.$el).removeClass("loading")},o.prototype.setDocumentTitle=function(){throw new Error("setDocumentTitle() must be implemented")},o}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Shared.AToZList=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.numColumns=App.IS_PHONE?2:3,o.prototype.render=function(){var t;return t=JST["templates/shared/a_to_z_list"]({table:this.formatTable(),heading:this.getHeaderText(),subheading:this.getSubheadingText()}),this.$el.html(t).show()},o.prototype.getHeaderText=function(){throw new Error("getHeaderText() not implemented")},o.prototype.getSubheadingText=function(){return""},o.prototype.formatTable=function(){var t,e,r=this;return t=this.getItemsByLetter(),e=_.keys(t),e.sort(),_.map(e,function(e){var o,i,n;return o=t[e],i=_.sortBy(o,function(t){return t.get("sortable_id")}),n=r.formatItems(i),{letter:e,columns:r.itemsToColumns(n)}})},o.prototype.getItemsByLetter=function(){var t=this;return this.collection.groupBy(function(e){return t.getLetter(e)})},o.prototype.getItemDisabled=function(){return!1},o.prototype.getItemName=function(t){return t.displayName()},o.prototype.getItemHref=function(t){return t.searchPath()},o.prototype.getLetter=function(t){var e,r;return e=t.get("sortable_id")||t.get("id"),r=e[0],/^\d$/.test(r)?"0-9":r.toUpperCase()},o.prototype.formatItems=function(t){var e=this;return _.map(t,function(t){return e.formatItem(t)})},o.prototype.formatItem=function(t){return{disabled:this.getItemDisabled(t),name:this.getItemName(t),href:this.getItemHref(t)}},o.prototype.itemsToColumns=function(t){var e,r,o,i,n;for(r=Math.floor(t.length/this.numColumns),n=[],e=o=0,i=this.numColumns;i>=0?i>=o:o>=i;e=i>=0?++o:--o)n.push(t.slice(this.getStart(e,r),+this.getEnd(e,r)+1||9e9));return n},o.prototype.getStart=function(t,e){return t*e+t},o.prototype.getEnd=function(t,e){return(t+1)*e+t},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.AngleTooltip=function(r){function i(){return this.show=e(this.show,this),this.hide=e(this.hide,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.className="tooltip",i.prototype.animating=!1,i.prototype.speed=120,i.prototype.initialize=function(t){return _.extend(this,t),this.show()},i.prototype.hide=function(){var t=this;return this.animating?void 0:(this.animating=!0,this.$el.find(".layer.two").removeClass("on"),_.delay(function(){return t.$el.find(".layer.one").removeClass("on"),t.animating=!1},this.speed))},i.prototype.show=function(){var t=this;return this.animating?void 0:(this.animating=!0,this.$el.show().find(".layer.one").show().addClass("on"),_.delay(function(){return t.$el.find(".layer.two").addClass("on"),t.animating=!1},this.speed))},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.BalancedForm=function(i){function n(){return this.showError=e(this.showError,this),this.tokenizeCard=e(this.tokenizeCard,this),this.isCardSecurityCode=e(this.isCardSecurityCode,this),this.isCardExpiration=e(this.isCardExpiration,this),this.isCardNumber=e(this.isCardNumber,this),this.isZip=e(this.isZip,this),this.isState=e(this.isState,this),this.isPresent=e(this.isPresent,this),t=n.__super__.constructor.apply(this,arguments)}return o(n,i),n.prototype.errors={missingOrMalformed:"Your card appears to be missing or malformed. Please try another card or contact <a href='mailto:support@artsy.net'>support</a>.",couldNotAuthorize:"Your card could not be authorized. Please try another card or contact <a href='mailto:support@artsy.net'>support</a>.",paymentError:"Your payment could not be processed. Please try again or contact <a href='mailto:support@artsy.net'>support</a>.",other:"There was a problem processing your order. Please try another card or contact <a href='mailto:support@artsy.net'>support</a>."},n.prototype.injectBalancedJS=function(){var t;if(App.render3rdPartyAssets&&!($("#balancedJS").length>0))return t=window.document.createElement("script"),t.id="balancedJS",t.src="https://js.balancedpayments.com/v1/balanced.js",window.document.body.appendChild(t)},n.prototype.setUpFields=function(){return this.$billingAddress=this.$(".billing_address .address"),this.fields={"name on card":{el:this.$form.find("input[name=card_name]"),validator:this.isPresent},"card number":{el:this.$form.find("input[name=card_number]"),validator:this.isCardNumber},expiration:{el:this.$form.find(".card_expiration select"),validator:this.isCardExpiration},"security code":{el:this.$form.find("input[name=card_security_code]"),validator:this.isCardSecurityCode},billing_street:{el:this.$billingAddress.find("input.street"),validator:this.isPresent,label:"street"},billing_city:{el:this.$billingAddress.find("input.city"),validator:this.isPresent,label:"city"},billing_state:{el:this.$billingAddress.find("input.region"),validator:this.isState,label:"state"},billing_zip:{el:this.$billingAddress.find("input.postal_code"),validator:this.isZip,label:"zip"}},this.internationalizeFields()},n.prototype.internationalizeFields=function(){var t=this;return this.$billingAddress.find("select.country").change(function(){return"USA"===t.$billingAddress.find("select.country").val()?(t.$billingAddress.removeClass("not_usa"),t.$billingAddress.find(".postal_code label").text("Zip Code")):(t.$billingAddress.addClass("not_usa"),t.$billingAddress.find(".postal_code label").text("Postal Code"))})},n.prototype.isPresent=function(t){return null!=t.val()&&t.val().trim().length>0},n.prototype.isState=function(t){return this.isPresent(t)||"USA"!==t.parents(".address").find("select.country").val()},n.prototype.isZip=function(t){return this.isPresent(t)&&("USA"!==t.parents(".address").find("select.country").val()||t.val().trim().match(/^\d{5}/))},n.prototype.isCardNumber=function(t){return window.balanced.card.isCardNumberValid(t.val())},n.prototype.isCardExpiration=function(t){return window.balanced.card.isExpiryValid(t.first().val(),t.last().val())},n.prototype.isCardSecurityCode=function(t){return window.balanced.card.isSecurityCodeValid(this.fields["card number"].el.val(),t.val())},n.prototype.cardData=function(){return{name:this.fields["name on card"].el.val(),card_number:this.fields["card number"].el.val(),expiration_month:this.fields.expiration.el.first().val(),expiration_year:this.fields.expiration.el.last().val(),security_code:this.fields["security code"].el.val(),street_address:this.fields.billing_street.el.val(),postal_code:this.fields.billing_zip.el.val(),country:this.$form.find("select[name='billing_address[country]']").val()}},n.prototype.refreshCardBrand=function(){var t;return this.$(".cc_brands .icon").removeClass("selected"),t=window.balanced.card.cardType(this.fields["card number"].el.val()),this.$(".cc_brands .icon[data-brand='"+t+"']").addClass("selected")},n.prototype.tokenizeCard=function(){var t,e=this;return t=new App.Models.Marketplace,t.fetch({success:function(t){return window.balanced.init(t.get("uri")),window.balanced.card.create(e.cardData(),e.cardCallback)},error:function(){return e.showError(e.errors.other,"Error fetching the balanced marketplace")}})},n.prototype.validateForm=function(){var t,e,o,i;t={},this.clearErrors(),i=this.fields;for(e in i)r.call(i,e)&&(o=i[e],o.el.is(":visible")&&!o.validator(o.el)&&(t[e]=o.message||"Invalid "+(o.label||e),o.el.addClass("has_error"),o.el.last().after("<div class='error'>"+t[e]+"</div>")));return _.isEmpty(t)},n.prototype.showError=function(t,e){var r,o;return"string"==typeof t?o=t:null!=t.responseText?(t.suppressAppMessages=!0,r=JSON.parse(t.responseText),o="payment_error"===r.type?this.errors.paymentError:this.errors.other):o=this.errors.other,this.$submit.removeClass("loading").before("<div class='error'>"+o+"</div>"),null!=e?Analytics.error(e):void 0},n.prototype.clearErrors=function(){return this.$form.find(".has_error").removeClass("has_error"),this.$form.find(".error").remove()},n}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.CreateAccountFormBase=function(r){function i(){return this.handleError=e(this.handleError,this),this.enableErrorState=e(this.enableErrorState,this),this.disableLoading=e(this.disableLoading,this),this.enableLoading=e(this.enableLoading,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.loading=!1,i.prototype.setupFormInputs=function(){return this.$name=this.$("#user_name"),this.$email=this.$("#user_email"),this.$password=this.$("#user_password"),this.$nameMsg=this.$(".name_msg"),this.$emailMsg=this.$(".email_msg"),this.$passwordMsg=this.$(".password_msg"),this.$email.artsyplaceholder("Email"),this.$name.artsyplaceholder("Full Name"),this.$password.artsyplaceholder("Password"),this.debouncePasswordValidation(),this.debounceNameValidation(),this.debounceEmailValidation(),this.$name.focus()},i.prototype.enableLoading=function(t){var e;return this.loading=!0,t.addClass("loading"),e=t.find(".spinner"),e.length||(e=t.next(".spinner")),e.show()},i.prototype.disableLoading=function(t){return t.removeClass("loading"),this.$(".spinner").hide(),this.loading=!1},i.prototype.enableErrorState=function(t){return this.$(".error").html("<p>"+html_escape(t)+"</p>").fadeIn(200),this.$form.find("button").addClass("error")},i.prototype.handleError=function(t){var e,r,o,i,n,s;if(t.suppressAppMessages=!0,0===t.status&&""===t.responseText)return this.redirectAfterLogin();if(this.disableLoading(this.$userSubmit),r=""+t.status+": "+t.statusText,t.responseText)try{o=jQuery.parseJSON(t.responseText),r=null!=(i=null!=(n=null!=(s=null!=o?o.text:void 0)?s:null!=o?o.error:void 0)?n:o.message)?i:r}catch(a){e=a}return Analytics.error("Create Account: "+r),this.enableErrorState(r)},i.prototype.validatePassword=function(){return this.$password.val().length<6?(this.$passwordMsg.fadeIn("fast"),!1):(this.$passwordMsg.fadeOut("fast"),!0)},i.prototype.validateName=function(){return 0===this.$name.val().length?(this.$nameMsg.fadeIn("fast"),!1):(this.$nameMsg.fadeOut("fast"),!0)},i.prototype.validateEmail=function(){return 0===this.$email.val().length?(this.$emailMsg.fadeIn("fast"),!1):(this.$emailMsg.fadeOut("fast"),!0)},i.prototype.redirectAfterLogin=function(){return window.location.href=App.redirectUrl&&"/"!==App.redirectUrl&&"/log_in"!==App.redirectUrl&&"/sign_up"!==App.redirectUrl?App.redirectUrl:"/personalize"},i.prototype.debounceNameValidation=function(){var t=this;return this.$name.keyup(_.debounce(function(e){return 9!==e.keyCode?t.validateName():void 0},500))},i.prototype.debounceEmailValidation=function(){var t=this;return this.$email.keyup(_.debounce(function(e){return 9!==e.keyCode?t.validateEmail():void 0},500))},i.prototype.debouncePasswordValidation=function(){var t=this;
return this.$password.keyup(_.debounce(function(e){return 9!==e.keyCode?t.validatePassword():void 0},500))},i}(Backbone.View)}.call(this),function(){App.timespanInWords=function(t,e){var r,o,i,n,s;return t=moment(t),e=moment(e),s=t.format("MMM"),4!==t.month()&&(s+="."),n=t.format("Do"),o=e.format("MMM"),4!==e.month()&&(o+="."),r=e.format("Do"),t.year()===e.year()?(i=t.month()===e.month()&&t.date()===e.date()?""+s+" "+n:t.month()===e.month()?""+s+" "+n+" &#x2013; "+r:""+s+" "+n+" &#x2013; "+o+" "+r,t.year()!==moment(new Date).year()?""+i+" "+t.year():i):""+s+" "+n+", "+t.format("YYYY")+" &#x2013; "+o+" "+r+", "+e.format("YYYY")}}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ModalDialog=function(r){function i(){return this.hideWithoutPreventDefault=e(this.hideWithoutPreventDefault,this),this.hide=e(this.hide,this),this.onResize=e(this.onResize,this),this.show=e(this.show,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.width=function(){return 500},i.prototype.events={"click .ui-dialog-titlebar-close":"hide","click .close-dialog":"hide"},i.prototype.onShow=function(){},i.prototype.onHide=function(){},i.prototype.show=function(t,e){var r=this;if(null==e&&(e=!1),null==this.handle)throw"You must set handle";return App.IS_PHONE||App.$body.css({height:App.$body.height(),overflow:"hidden"}),this.showBackground(),this.$el.css({width:this.width()}),this.$el.css({left:this.getLeftOffset()}),e?this.$el.show():this.$el.fadeIn(200),App.$document.bind("keyup."+this.handle,function(t){return t.keyCode===$.ui.keyCode.ESCAPE?r.hide():void 0}),App.$window.bind("resize."+this.handle,_.throttle(this.onResize,100)),Analytics.funnel("Viewed "+this.handle+" form"),this.onShow(t)},i.prototype.getLeftOffset=function(){return App.$window.width()/2-this.width()/2},i.prototype.onResize=function(){return this.sizeBackground(),this.$el.css({left:this.getLeftOffset()})},i.prototype.hide=function(){return this.hideWithoutPreventDefault(),!1},i.prototype.hideWithoutPreventDefault=function(){return this.$el.fadeOut(200),App.$document.unbind(this.handle),App.$body.css({height:"auto",overflow:"auto"}),this.removeBackground(),this.onHide()},i.prototype.showBackground=function(){var t;return t=$(".ui-widget-overlay"),t.length>0?this.$background=t:(this.$el.before('<div class="ui-widget-overlay"></div>'),this.$background=$(".ui-widget-overlay"),$("header").css({"z-index":2})),this.$background.click(this.hide),this.sizeBackground()},i.prototype.sizeBackground=function(){return this.$background.css({width:App.IS_PHONE?480:App.$window.width(),height:App.IS_PHONE?760:App.$window.height(),"z-index":1e3})},i.prototype.removeBackground=function(){var t,e=this;return null!=(t=this.$background)?t.fadeOut(200,function(){return e.$background.remove(),$("header").css({"z-index":6})}):void 0},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Tabs=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.updateLocation=!0,o.prototype.triggerRoute=!1,o.prototype.events={"click a":"navigate"},o.prototype.initialize=function(){return null!=this.options.updateLocation&&(this.updateLocation=this.options.updateLocation),null!=this.options.triggerRoute?this.triggerRoute=this.options.triggerRoute:void 0},o.prototype.clearSelectedTab=function(){return this.$("a.active").removeClass("active")},o.prototype.selectTab=function(t,e){return null==e&&(e=!0),this.clearSelectedTab(),this.$("a[data-tab="+t+"]").addClass("active"),this.activeTab=t,e?this.trigger("tabChange",this.activeTab):void 0},o.prototype.navigate=function(t){var e,r;return e=$(t.target),window.location.pathname===e.attr("href")?!1:(this.updateLocation&&App.router.navigate(e.attr("href"),{trigger:this.triggerRoute}),r=e.data("tab")?e.data("tab"):_.last($(t.target).attr("href").split("/")),this.selectTab(r),!1)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ZigZagTooltip=function(r){function i(){return this.setPosition=e(this.setPosition,this),this.getPositionLeft=e(this.getPositionLeft,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el=".zigzag_tooltip",i.prototype.events={"click .close":"hide"},i.prototype.layerOneWidth="155px",i.prototype.layerTwoWidth="75px",i.prototype.marginLeft=17,i.prototype.getWidth=function(){return $.browser.msie&&"8.0"===$.browser.version?"330px":"300px"},i.prototype.getPositionLeft=function(){return this.$parent.offset().left+this.$parent.width()+this.marginLeft},i.prototype.initialize=function(t){return this.$parent=t.parent,this.$el=$(JST["templates/artists/tooltip"]({text:t.text})),this.$el=this.$el.appendTo(t.appendTo),App.$window.bind("resize.position",this.setPosition),this.setPosition()},i.prototype.setPosition=function(){return this.$parent?this.$el.css({left:this.getPositionLeft()}):void 0},i.prototype.show=function(){var t,e=this;return this.$el.find(".close").click(function(){return e.hide()}),this.animating?void 0:(t=this.getWidth(),this.animating=!0,this.$el.show().find(".layer.one").animate({width:this.layerOneWidth},300,function(){return e.$el.find(".layer.two").animate({width:e.layerTwoWidth},300,function(){return e.$el.find(".layer.three").animate({width:t},300,function(){return e.animating=!1,e.$el.addClass("done")})})}))},i.prototype.hide=function(){var t=this;return this.animating?void 0:(this.animating=!0,this.$el.removeClass("done").find(".layer.three").animate({width:"0px"},300,function(){return t.$el.find(".layer.two").animate({width:"0px"},300,function(){return t.$el.find(".layer.one").animate({width:"0px"},300,function(){return t.animating=!1,t.$el.hide(),t.remove(),App.currentUser.hideFollowTooltip()})})}))},i.prototype.remove=function(){return App.$window.unbind("resize.position",this.setPosition)},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedSet=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){var t,e=this;return t=App.Repositories.OrderedSets.fetchItemByUniqueKey(this.key,{size:this.maxItemsPerFeature,has_image:!0}),t.then(function(t){return e.render(t)}),t.fail(function(){return e.remove()})},o.prototype.render=function(t){var e,r=this;return(null!=(e=t.get("items"))?e.length:void 0)>0?(this.$el.html(JST[this.template]({orderedSet:t})),this.options.width&&this.setWidth(this.options.width),this.$el.imagesLoaded(function(){return r.$("img").removeClass("loading")})):this.remove()},o.prototype.setWidth=function(t){return this.$el.width(t)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtistFollow=function(r){function i(){return this.followArtist=e(this.followArtist,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .follow a":"followArtist","click .following a":"unfollowArtist","mouseenter .following a":"followingEnter","mouseleave .following a":"followingLeave"},i.prototype.initialize=function(){var t=this;if(null==this.model)throw"You must pass a model";if(!App.currentUser.get("followArtistsFetched"))throw"Ensure the current user's follow artists have been fetched.";return this.artist=this.options.model,this.$el=this.options.el,App.currentUser.get("followArtists").on("add:"+this.artist.get("id"),function(){return t.onFollowChange(!0)}),App.currentUser.get("followArtists").on("remove:"+this.artist.get("id"),function(){return t.onFollowChange(!1)}),this.render()},i.prototype.render=function(){return this.$followLink=this.$(".artist a"),this.onFollowChange(this.artist.following())},i.prototype.followArtist=function(t){var e=this;if(App.currentUser.accountCreated())return this.$followLink.removeClass("committed"),App.follow(t,this.artist,{success:function(){return e.$followLink.addClass("committed")},error:function(){return e.onFollowChange(!1)}}),this.onFollowChange(!0),App.showMessage(this.artist.followMessage()),Analytics.click("Followed artist from artist result row",this.artist),!1},i.prototype.unfollowArtist=function(t){var e=this;if(App.currentUser.accountCreated())return this.$followLink.removeClass("committed"),App.unfollow(t,this.artist,{success:function(){return e.$followLink.addClass("committed")},error:function(){return e.onFollowChange(!0)}}),this.removeOnUnfollow&&this.$el.slideUp().fadeOut("fast"),this.onFollowChange(!1),App.showMessage(this.artist.unfollowMessage()),Analytics.click("Unfollowed artist from artist result row",this.artist),!1},i.prototype.onFollowChange=function(t){return t?this.$followLink.removeClass("over").text("Following").parent().addClass("following").removeClass("follow"):this.$followLink.removeClass("over").text("Follow").parent().addClass("follow").removeClass("following")},i.prototype.followingEnter=function(){return this.artist.following()?this.$followLink.addClass("over").text("Unfollow"):void 0},i.prototype.followingLeave=function(){return this.artist.following()?this.$followLink.removeClass("over").text("Following"):void 0},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ArtistBlurb=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.updateOnResize=this.options.updateOnResize||!1,this.displayLineCount=this.options.displayLineCount||6,this.listenTo(App.router.viewState,"frameLoad:"+App.currentFrameName,this.onFrameLoad),this.listenTo(App.router.viewState,"frameUnload:"+App.currentFrameName,this.detachProfileEllipsis),this.onFrameLoad()},o.prototype.onFrameLoad=function(){var t=this;return this.updateOnResize&&App.$window.on("resize."+this.cid+"ArtistBlurb",function(){return t.moreSeen?void 0:t.attachProfileEllipsis()}),_.defer(function(){return t.attachProfileEllipsis()})},o.prototype.attachProfileEllipsis=function(){var t,e=this;if(this.$el.length>0)return t=$('<span class="see_more_profile">... <a href="#">Show more</a></span>'),this.$el.dotdotdot({ellipsis:"",after:t,height:this.displayLineCount*parseInt(this.$el.css("lineHeight"))+6,wrap:"word",watch:!1}),this.$el.trigger("isTruncated",function(){return e.$(".see_more_profile a").click(function(){return e.detachProfileEllipsis(),e.moreSeen=!0,!1})})},o.prototype.detachProfileEllipsis=function(){var t=this;return _.delay(function(){return t.$el.trigger("destroy")},260),App.$window.off("resize."+this.cid+"ArtistBlurb")},o}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtistsListItem=function(r){function i(){return this.followArtist=e(this.followArtist,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .follow a":"followArtist","click .following a":"unfollowArtist","mouseenter .following a":"followingEnter","mouseleave .following a":"followingLeave"},i.prototype.numberArtworks=15,i.prototype.initialize=function(){var t,e=this;if(null==this.model)throw"You must pass a model";if(!App.currentUser.get("followArtistsFetched"))throw"Ensure the current user's follow artists have been fetched.";return this.artist=this.options.model,this.$artistsUL=this.options.parent,this.removeOnUnfollow=null!=this.options.removeOnUnfollow?this.options.removeOnUnfollow:!1,this.$followLink=this.$("h2 .artist a"),this.onFollowChange(this.artist.following()),App.currentUser.get("followArtists").bind("add:"+this.artist.get("id"),function(){return e.onFollowChange(!0)}),App.currentUser.get("followArtists").bind("remove:"+this.artist.get("id"),function(){return e.onFollowChange(!1)}),this.$followLink.fadeIn("fast"),this.artist.bind("change:artworks",this.addArtworks,this),(null!=(t=this.artist.get("artworks"))?t.length:void 0)>0?this.addArtworks():void 0},i.prototype.addArtworks=function(){var t,e;return t=this.$(".artworks"),e=this.artist.get("artworks"),e.reset(e.models.slice(0,+this.numberArtworks+1||9e9),{silent:!0}),t.html(JST["templates/artworks/artworks"]({artworks:e.models})),new App.Views.ArtworkRowGroup({artworks:e,el:this.$("section.artworks"),displaySeeMoreButton:!0,useResponsiveRowHeight:!1,initialPageSize:1})},i.prototype.followArtist=function(t){var e=this;if(App.currentUser.accountCreated())return this.$followLink.removeClass("committed"),App.follow(t,this.artist,{success:function(){return e.$followLink.addClass("committed")},error:function(){return e.onFollowChange(!1)}}),this.onFollowChange(!0),App.showMessage(this.artist.followMessage()),Analytics.click("Followed artist from artist result row",this.artist),!1},i.prototype.unfollowArtist=function(t){var e=this;if(App.currentUser.accountCreated())return this.$followLink.removeClass("committed"),App.unfollow(t,this.artist,{success:function(){return e.$followLink.addClass("committed")},error:function(){return e.onFollowChange(!0)}}),this.removeOnUnfollow&&this.$el.slideUp().fadeOut("fast"),this.onFollowChange(!1),App.showMessage(this.artist.unfollowMessage()),Analytics.click("Unfollowed artist from artist result row",this.artist),!1},i.prototype.onFollowChange=function(t){return t?this.$followLink.removeClass("over").text("Following").parent().addClass("following").removeClass("follow"):this.$followLink.removeClass("over").text("Follow").parent().addClass("follow").removeClass("following")},i.prototype.followingEnter=function(){return this.artist.following()?this.$followLink.addClass("over").text("Unfollow"):void 0},i.prototype.followingLeave=function(){return this.artist.following()?this.$followLink.removeClass("over").text("Following"):void 0},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PostRelatedArtists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.FixedDimensionsThumbnails),o.prototype.initialize=function(){var t=this;return this.maxArtists=this.options.maxArtists,this.post=this.options.post,this.artists=this.post.relatedArtists(this.maxArtists).models,this.renderOnce=_.after(this.artists.length,function(){return t.render()}),this.getArtistImages()},o.prototype.render=function(){var t=this;return 0===this.artists.length?this.$el.remove():(this.$el.html(JST["templates/artists/post_related_artists/related_artists_banner"]({artists:this.artists})),App.isLoggedIn()&&this.followButtons(),this.$el.imagesLoaded(function(){return t.$el.show(),t.setupFixedDimensionsThumbnails(),t.$(".img_container img").removeClass("loading")}))},o.prototype.getArtistImages=function(){var t,e,r,o,i;for(o=this.artists,i=[],e=0,r=o.length;r>e;e++)t=o[e],t.once("change:poster_artwork",this.renderOnce),t.fetchPosterArtwork(),i.push(t);return i},o.prototype.followButtons=function(){var t,e,r,o,i;for(o=this.artists,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(new App.Views.ArtistFollow({el:this.$(".follow_actions[data-artist="+t.get("id")+"]"),model:t}));return i},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ArtistsRowSet=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .see_more button":"seeMore","click h2 span.subject":"saveScrollPos"},o.prototype.page=1,o.prototype.artworksPerPage=15,o.prototype.initialize=function(t){return this.pageSize=t.size||6},o.prototype.render=function(){var t=this;return App.currentUser.ensureFollowArtists(function(){return t.onFollowArtistsFetched()})},o.prototype.onFollowArtistsFetched=function(){var t=this;return App.currentUser.unbind("change:followArtists",function(){return t.onFollowArtistsFetched}),this.$el.parent().removeClass("loading"),this.renderArtistRows(this.artists)},o.prototype.renderArtistRows=function(t){var e,r,o,i,n,s;for(r=function(){var r,o,i,n;for(i=t.models,n=[],r=0,o=i.length;o>r;r++)e=i[r],n.push(JST["templates/artists/artist_row"]({artist:e}));return n}().join(""),this.$("ul.artists").append(r),o=this.$("ul.artists"),s=t.models,i=0,n=s.length;n>i;i++)e=s[i],this.fetchArtworks(e,o);return t.length<this.pageSize?this.$(".see_more").hide():void 0},o.prototype.fetchArtworks=function(t,e){var r=this;return t.fetchArtworks({pageSize:this.artworksPerPage,page:1,success:function(){return new App.Views.ArtistsListItem({el:r.$("li[data-artist="+t.get("id")+"]"),parent:e,model:t})}})},o.prototype.seeMore=function(t){var e=this;return this.page++,App.Collections.Artists.fetchFromUrl(this.nextPageUrl(this.page),{preload:function(){return $(t.target).addClass("loading")},success:function(r){return $(t.target).removeClass("loading"),e.artists.reset(e.artists.models.concat(r.models)),_.defer(function(){return e.renderArtistRows(r)}),r.length<e.pageSize&&e.$(".see_more").hide(),Analytics.click("Clicked 'See More' from artist result row")}})},o.prototype.nextPageUrl=function(){throw"Extending views must define nextPageUrl()"},o.prototype.saveScrollPos=function(){return App.router.viewState.saveScrollPosition()},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.AdditionalImages=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el=".additional_images",o.prototype.arrowsWidth=60,o.prototype.events={"click img.thumbnail.selectable":"select","click a.left_arrow":"clickLeft","click a.right_arrow":"clickRight"},o.prototype.initialize=function(){var t=this;return this.$img=$("img.main"),this.$images=this.$("img.thumbnail"),this.$below=this.$(".below"),this.resetSlidePosition(),this.$slideWrapper=this.$(".slide_wrapper"),this.$slide=this.$(".slide"),this.$leftArrow=this.$("a.left_arrow"),this.$rightArrow=this.$("a.right_arrow"),this.additionalImagesCount=this.$images.length,this.fitThumbnailsThrottled=_.throttle(function(){return t.fitThumbnails()},200),App.$window.on("resize.additionalImages",this.fitThumbnailsThrottled),this.render()},o.prototype.render=function(){var t=this;return this.$el.imagesLoaded(function(){return t.$el.show(),t.fitThumbnailsThrottled(),t.$images.fadeIn(200).css({display:"inline-block"})})},o.prototype.fitThumbnails=function(){var t,e;return t=$(this.$images[0]).outerWidth()+$(this.$images[1]).outerWidth()+20,e=this.$img.width(),this.renderArrows(e)?2===this.additionalImagesCount&&t>e?(e=t,this.$slideWrapper.width(e),this.$below.width(e)):this.additionalImagesCount>2&&t+this.arrowsWidth>e?(this.$leftArrow.fadeIn(200).css({display:"inline-block"}),this.$rightArrow.fadeIn(200).css({display:"inline-block"}),e=t,this.$slideWrapper.width(e),this.$below.width(e+this.arrowsWidth)):(this.$leftArrow.fadeIn(200).css({display:"inline-block"}),this.$rightArrow.fadeIn(200).css({display:"inline-block"}),this.$slideWrapper.width(e-this.arrowsWidth),this.$below.width(this.$img.width())):(this.hideArrows(),this.$slideWrapper.width(e),this.$below.width(this.$img.width())),this.$slide.css({left:this.left})},o.prototype.hideArrows=function(){return this.$leftArrow.hide(),this.$rightArrow.hide()},o.prototype.renderArrows=function(t){var e,r,o,i,n;for(r=0,n=this.$images,o=0,i=n.length;i>o;o++)e=n[o],r+=$(e).outerWidth(!0);return r>t?!0:!1},o.prototype.select=function(t){var e,r;return this.$("img.selected").removeClass("selected").addClass("selectable"),$(t.target).addClass("selected").removeClass("selectable"),r=$(t.target).attr("data-id"),e=this.options.model.get("images").get(r),this.trigger("selected",e)},o.prototype.clickLeft=function(){var t=this;return this.$slide.addClass("ease"),this.$slide.css({left:this.movePixels("left")}),_.delay(function(){return t.$slide.removeClass("ease")},1e3)},o.prototype.clickRight=function(){var t=this;return this.$slide.addClass("ease"),this.$slide.css({left:this.movePixels("right")}),_.delay(function(){return t.$slide.removeClass("ease")},1e3)},o.prototype.resetSlidePosition=function(){return this.left=0,this.firstImage=0},o.prototype.movePixels=function(t){var e,r,o,i,n,s,a,l,p,u;if(n=0,e=this.firstImage,r=this.$slideWrapper.width(),"left"===t){if(!(this.firstImage>0))return;for(p=this.$images.slice(0,this.firstImage),s=p.length-1;s>=0&&(o=p[s],i=$(o).outerWidth(!0),this.moveMoreThumbnails({width:n+i,wrapper_width:r,index:e}));s+=-1)n+=i,e-=1;this.left=this.left+n}else if("right"===t){for(u=this.$images.slice(this.firstImage,+this.additionalImagesCount+1||9e9),a=0,l=u.length;l>a&&(o=u[a],i=$(o).outerWidth(!0),this.moveMoreThumbnails({width:n+i,wrapper_width:r,index:e}));a++)n+=i,e+=1;e>=this.additionalImagesCount||(this.left=this.left-n)}return this.firstImage=e,this.left},o.prototype.moveMoreThumbnails=function(t){return t.width<=t.wrapper_width&&t.index<this.additionalImagesCount},o.prototype.onUnload=function(){return App.$window.off("resize.additionalImages")},o}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtworkArtistInfo=function(r){function i(){return this.renderContainer=e(this.renderContainer,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.artworksPerPage=5,i.prototype.rowHeight=130,i.prototype.initialize=function(){return this.excludedArtworkId=this.options.excludedArtworkId,this.doneRendering=this.options.doneRendering,this.id=this.options.id},i.prototype.renderPreloader=function(){return this.$el.html('<div class="pre_loader"></div>')},i.prototype.render=function(){return this.renderPreloader(),this.renderArtwork(),this.trigger("onRender"),this},i.prototype.renderArtwork=function(){var t=this;return this.model.fetchArtworks({pageSize:this.artworksPerPage,page:1,published:!0,success:function(e){return e=t.getFilteredArtworks(e),t.artworks=new App.Collections.Artworks(e),t.renderContainer(t.artworks),e.length>0&&(t.attachArtworkRowGroup(t.artworks),t.$(".blurb").addClass("has_artworks")),"function"==typeof t.doneRendering?t.doneRendering():void 0}})},i.prototype.getFilteredArtworks=function(t){var e=this;return t=this.excludedArtworkId?t.reject(function(t){return t.get("id")===e.excludedArtworkId}):t.models},i.prototype.renderContainer=function(t){return t||this.model.get("blurb")?(this.$el.parent().show(),this.$el.html(JST["templates/artworks/about_artist"]({artist:this.model,rowHeight:this.rowHeight,artworks:t.models.slice(0,+this.artworksPerPage+1||9e9)})),this.attachEllipsis()):void 0},i.prototype.attachArtworkRowGroup=function(t){return this.allArtworksFetched=!1,new App.Views.ArtworkRowGroup({artworks:t,el:this.$("section.artworks"),artworksPerPage:this.artworksPerPage,initialPageSize:1,rowHeight:this.rowHeight,useResponsiveRowHeight:!1}),this.removeLastArtworkMargin()},i.prototype.toggleForSaleFilter=function(){return this.onlyForSale=!this.onlyForSale,this.renderArtwork(),!0},i.prototype.attachEllipsis=function(){var t,e,r;return t=this.$(".blurb"),t.length>0?(e=140,r=$("<span class='see_artist'>... <a href='"+this.model.searchPath()+"'>Read more</a></span>"),t.dotdotdot({ellipsis:"",after:$(r),height:e,wrap:"word",watch:!1})):void 0},i.prototype.removeLastArtworkMargin=function(){return this.$("section.artworks figure:last").css("margin-right","0")},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtworkRowGroup=function(r){function i(){return this.storeCurrentArtworkSet=e(this.storeCurrentArtworkSet,this),this.attachImageLoad=e(this.attachImageLoad,this),this.getLastRowArtworks=e(this.getLastRowArtworks,this),this.removeLastRow=e(this.removeLastRow,this),this.hideLastRow=e(this.hideLastRow,this),this.hideAllRows=e(this.hideAllRows,this),this.showAllRows=e(this.showAllRows,this),this.hideRows=e(this.hideRows,this),this.showRows=e(this.showRows,this),this.showNextPage=e(this.showNextPage,this),this.attachFillWidth=e(this.attachFillWidth,this),this.beforeNewRowsHandler=e(this.beforeNewRowsHandler,this),this.afterFillWidthHandler=e(this.afterFillWidthHandler,this),this.beforeFillWidthHandler=e(this.beforeFillWidthHandler,this),this.responsiveRowHeight=e(this.responsiveRowHeight,this),this.getRowHeight=e(this.getRowHeight,this),this.addArtworks=e(this.addArtworks,this),this.appendArtworks=e(this.appendArtworks,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via fillwidth",i.prototype.analyticsSaveMessage="Added artwork to collection, via fillwidth",i.prototype.breakPoints={"0-1024":140,"1024-1260":160,"1260-1420":180,"1420-1660":200,"1660-1900":220,"1900-2540":240,"2540-2560":260},i.prototype.currentPage=0,i.prototype.pageSize=3,i.prototype.initialPageSize=2,i.prototype.artworksPerPage=15,i.prototype.rowHeight=200,i.prototype.hideLastRow=!1,i.prototype.displaySeeMoreButton=!0,i.prototype.firstRender=!0,i.prototype.events={"click a.img_container":"storeCurrentArtworkSet"},i.prototype.initOptions=function(){var t,e,r,o,i;return this.useResponsiveRowHeight=this.options.useResponsiveRowHeight,this.largeRows=null!=(t=this.options.largeRows)?t:this.largeRows,this.rowHeight=this.useResponsiveRowHeight?this.getRowHeight():null!=(e=this.options.rowHeight)?e:this.rowHeight,this.hideLastRow=null!=(r=this.options.hideLastRow)?r:this.hideLastRow,this.initialPageSize=null!=(o=this.options.initialPageSize)?o:this.initialPageSize,this.displaySeeMoreButton=this.options.displaySeeMoreButton,this.artworksPerPage=null!=(i=this.options.artworksPerPage)?i:this.artworksPerPage,this.relatedArtworksSet=this.options.relatedArtworksSet,this.fetchMoreArtworks=this.options.fetchMoreArtworks,this.artworks=this.options.artworks},i.prototype.renderIncomplete=!1,i.prototype.initialize=function(){var t=this;return this.initOptions(),this.attachImageLoad(),_.defer(function(){return t.render()}),this.frameName=App.router.viewState.currentFrame,App.router.viewState.bind("frameLoad:"+this.frameName,function(){return _.defer(function(){return t.renderIncomplete?t.render():void 0})})},i.prototype.render=function(){if(null==this.el)throw"You must pass an el";return this.artworks.bind("addCollection",this.addArtworks),this.$seeMoreButton=this.$el.siblings(".see_more").find("button"),this.addArtworks(this.artworks)},i.prototype.renderSeeMore=function(){return this.seeMoreButton||(this.seeMoreButton=new App.Views.SeeMoreButton({el:this.$seeMoreButton,parent:this}))},i.prototype.appendArtworks=function(t){var e;return this.$el.append($(function(){var r,o,i,n;for(i=t.models,n=[],r=0,o=i.length;o>r;r++)e=i[r],n.push(JST["templates/artworks/_show"]({artwork:e,maxDimension:!1,fixedWidth:!1,imageSize:"medium"}));return n}().join(""))),this.$(".img_container").height(this.rowHeight)},i.prototype.addArtworks=function(t){var e=this;return this.attachFillWidth(),_.defer(function(){return e.displaySeeMoreButton?e.renderSeeMore():e.$seeMoreButton.hide(),e.initializeArtworks(t.models),e.seeMoreButton?e.seeMoreButton.toggleSeeMoreBtn():void 0})},i.prototype.getRowHeight=function(){var t;return t=App.fillwidthRowHeight(),this.largeRows?t=Math.min(1.3*t,260):void 0},i.prototype.responsiveRowHeight=function(){var t,e,r,o,i,n,s,a;for(t=this.getRowHeight(),s=this.rows,a=[],i=0,n=s.length;n>i;i++)o=s[i],a.push(function(){var i,n,s,a;for(s=o.lis,a=[],i=0,n=s.length;n>i;i++)e=s[i],r=t/e.$el.find("img").height()*e.$el.find("img").width(),e.$el.width(r),e.$el.height("auto"),a.push(e.$el.children(".img_container").height(t));return a}());return a},i.prototype.beforeFillWidthHandler=function(){return null!=this.rows&&(this.options.hideLastRow||this.displaySeeMoreButton)?this.showAllRows():void 0},i.prototype.afterFillWidthHandler=function(){return this.renderIncomplete=!this.$el.is(":visible"),this.rows=this.$el.fillwidth("rowObjs"),this.hideRows(),this.renderIncomplete=!this.$el.is(":visible")},i.prototype.beforeNewRowsHandler=function(){return null!=this.rows&&this.useResponsiveRowHeight?this.responsiveRowHeight():void 0},i.prototype.attachFillWidth=function(t){var e,r,o,i,n,s;return null==t&&(t={}),o={resizeLandscapesBy:null!=(i=t.resizeLandscapesBy)?i:50,resizeRowBy:null!=(n=t.resizeRowBy)?n:50,landscapeRatios:null!=(s=t.landscapeRatios)?s:function(){var t,e;for(e=[],r=t=10;50>=t;r=t+=3)e.push(r/10);return e}().reverse(),liWidths:function(){var t,r,o,i;for(o=this.artworks.models,i=[],t=0,r=o.length;r>t;t++)e=o[t],i.push(Math.round((e.defaultImage().aspectRatio()||1)*this.rowHeight));return i}.call(this),initStyling:{padding:this.$el.css("padding"),margin:this.$el.css("margin")},beforeFillWidth:this.beforeFillWidthHandler,afterFillWidth:this.afterFillWidthHandler,beforeNewRows:this.beforeNewRowsHandler,lockedHeight:!0,childSelector:"figure"},this.$el.fillwidth(o)},i.prototype.showNextPage=function(t){var e=this;return this.currentPage++,this.fetchMoreArtworks?this.fetchMoreArtworks(this.currentPage+1,function(t){return e.artworks.add(t),t=new App.Collections.Artworks(t),e.appendArtworks(t),e.addArtworks(t),e.showRows()},t):this.showRows()},i.prototype.initialHideRows=function(){var t,e,r,o,i;for(o=this.rows.slice(this.initialPageSize,+this.rows.length+1||9e9),i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.hide());return i},i.prototype.showRows=function(){var t,e,r,o;for(o=this.rows.slice(this.currentPage,+(this.currentPage*this.pageSize)+1||9e9),e=0,r=o.length;r>e;e++)t=o[e],t.show();return this.attachImageLoad(),this.artworks.each(function(t){return t.trigger("visible")})},i.prototype.hideRows=function(){var t,e,r,o,i;if(this.firstRender||this.currentPage<1)return this.initialHideRows(),this.firstRender=!1;for(o=this.rows.slice(this.currentPage*this.pageSize+1,+this.rows.length+1||9e9),i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.hide());return i},i.prototype.showAllRows=function(){var t,e,r,o,i;for(o=this.rows,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.show());return i},i.prototype.hideAllRows=function(){var t,e,r,o,i;for(o=this.rows,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.hide());return i},i.prototype.hideLastRow=function(){return this.rows.length<=1?void 0:this.rows[this.rows.length-1].hide()},i.prototype.removeLastRow=function(){var t,e,r,o,i;if(this.rows.length>1){for(o=this.rows[this.rows.length-1].lis,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.$el.remove());return i}},i.prototype.getLastRowArtworks=function(){var t,e;return this.rows.length>1?(e=this.rows[this.rows.length-1].lis.length,t=this.options.artworks.length,this.options.artworks.models.slice(t-e,+(t-1)+1||9e9)):[]},i.prototype.onLoad=function(){return this.attachFillWidth(),this.attachImageLoad()},i.prototype.attachImageLoad=function(){var t=this;return this.$el.imagesLoaded(function(){return t.artworks.each(function(t){return t.trigger("visible")
}),t.$("img").removeClass("loading")}),this.$("img").on("load.row_group",function(){return $(this).removeClass("loading")})},i.prototype.onUnload=function(){var t=this;return this.seeMoreButton&&this.seeMoreButton.onUnload(),_.delay(function(){return t.artworks.unbind("addCollection",t.addArtworks)},1e3),this.$("img").off(".row_group")},i.prototype.storeCurrentArtworkSet=function(t){var e,r,o;return e=$(t.target).parent(".img_container"),App.currentArtworkSet=this.artworks.models,App.currentArtworkIndex=this.$(".img_container").index(e),"artwork"===App.currentFrameName?App.currentArtworkSet=void 0:(App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=null!=(r=App.router.viewState.frames[App.currentFrameName])?null!=(o=r.frame)?o.frameTitle:void 0:void 0)},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtworksInfoPanelBidForm=function(r){function i(){return this.placeBid=e(this.placeBid,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.AuctionPopover),_.extend(i.prototype,App.Mixins.ValidateBid),_.extend(i.prototype,App.Mixins.RegisterToBid),i.prototype.events={"click .button.bid":"placeBid","click .bidder-register":"registerUser","submit .bid-form-container":"placeBid"},i.prototype.initialize=function(){return this.parentView=this.options.parentView,this.sale=this.options.sale,this.$el.removeClass("hidden").addClass("loading"),this.sale.isRegisterable()?this.fetchSaleArtwork():"closed"===this.sale.get("auction_state")?this.renderClosed():void 0},i.prototype.fetchSaleArtwork=function(){var t=this;return App.Repositories.SaleArtworks.getFromUrl("/api/v1/sale/"+this.sale.get("id")+"/sale_artwork/"+this.model.get("id"),{success:function(e){return t.saleArtwork=e.models[0],App.isLoggedIn()?t.checkUserRegistration():t.render()}})},i.prototype.checkUserRegistration=function(){var t=this;return this.sale.get("currentUserRegistered")?this.fetchUserBids():this.sale.checkCurrentUserRegistered({success:function(){return t.sale.get("currentUserRegistered")?t.fetchUserBids():t.render()}})},i.prototype.fetchUserBids=function(){var t=this;return this.bidderPositions=new App.Collections.BidderPositions,this.bidderPositions.url="/api/v1/me/bidder_positions?sale_id="+this.sale.get("id")+"&artwork_id="+this.model.get("id"),this.bidderPositions.fetch({success:function(){return t.render()}})},i.prototype.render=function(){var t;return this.saleArtwork.formatEstimate()&&this.renderEstimate(),this.$el.html(JST["templates/artworks/sale_status/auction_status"]({artwork:this.model,saleArtwork:this.saleArtwork,bidderPosition:_.first(null!=(t=this.bidderPositions)?t.models:void 0),sale:this.sale})),this.$el.removeClass("loading"),this.$(".bidding-container").addClass(this.getBiddingState()),this.renderConfirmationFromParams(this.model.searchPath(),App.currentFrameView.options),this.parentView.sizeContainer(this.parentView.$infoPanel.height())},i.prototype.renderEstimate=function(){return this.$el.parent().find(".estimate").show().text("Estimate: "+this.saleArtwork.formatEstimate())},i.prototype.getWinningBid=function(){var t,e;if(null!=this.bidderPositions&&(t=null!=(e=this.saleArtwork.get("highest_bid"))?e.id:void 0,null!=t))return _.find(this.bidderPositions.models,function(e){var r;return(null!=(r=e.get("highest_bid"))?r.id:void 0)===t})},i.prototype.getHigherBid=function(){var t;if(null!=this.bidderPositions)return t=this.saleArtwork.get("highest_bid_amount_cents")||0,_.find(this.bidderPositions.models,function(e){return e.get("max_bid_amount_cents")>t})},i.prototype.getBiddingState=function(){var t,e;return"preview"===this.sale.get("auction_state")?this.sale.get("currentUserRegistered")?"preview-registered":"preview":null!=this.getWinningBid()?"high-bidder":(null!=(t=this.bidderPositions)?t.length:void 0)>0&&null==this.getHigherBid()?"outbid":(null!=(e=this.bidderPositions)?e.length:void 0)>0?"bidding":this.saleArtwork.get("highest_bid_amount_cents")?"bidders":"no-bidders"},i.prototype.placeBid=function(t){var e,r;return t.preventDefault(),App.currentUser.accountCreated()?(this.$(".errors").hide(),$(t.target).addClass("loading"),e=this.validateBid(this.$(".bid-form-container input").val(),this.saleArtwork.get("minimum_next_bid_cents")),e>0?App.router.navigate("feature/"+this.sale.get("id")+"/bid/"+this.model.get("id")+"/bid="+e,{trigger:!0}):$(t.target).removeClass("loading"),!1):null!=(r=App.loginSignupDialog)?r.show("bid"):void 0},i.prototype.registerUser=function(){var t=this;return this.registerToBid(this.sale,{onSuccess:function(){return t.showAuctionConfirmationDialog("registration"),t.$(".bidding-container").addClass(t.getBiddingState())},onCreditCardRequired:function(e){return t.renderCreditCardForm(e)}})},i.prototype.renderClosed=function(){return this.$el.html(JST["templates/artworks/sale_status/auction_closed"]({sale:sale})),this.$el.removeClass("loading"),this.parentView.sizeContainer(this.parentView.$infoPanel.height())},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtworkColumns=function(r){function i(){return this.onSeeMoreClick=e(this.onSeeMoreClick,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.seeMore=!1,i.prototype.gutterWidth=80,i.prototype.totalWidth=1120,i.prototype.numberOfColumns=3,i.prototype.initialItemCount=10,i.prototype.maxArtworkHeight=400,i.prototype.currentColumn=0,i.prototype.events={"click .see_more button":"onSeeMoreClick"},i.prototype.initialize=function(){var t,e,r,o,i;if(_.extend(this,this.options),this.collection){for(this.collectionLength||(this.collectionLength=this.collection.length),this.seeMore=this.seeMore&&this.collectionLength>this.initialItemCount,this.numberOfColumns||(this.numberOfColumns=3),this.columnWidth=Math.floor((this.totalWidth-(this.numberOfColumns-1)*this.gutterWidth)/this.numberOfColumns)-2,this.indices=function(){i=[];for(var t=0,e=this.numberOfColumns;e>=0?e>t:t>e;e>=0?t++:t--)i.push(t);return i}.apply(this),this.columns=[],o=this.indices,e=0,r=o.length;r>e;e++)t=o[e],this.columns[t]={height:0,artworkCount:0};return this.shortestColumn=0,this.render()}},i.prototype.render=function(){var t,e=this;return t=$(JST["templates/artworks/_columns"]({columns:this.columns,seeMore:this.seeMore,buttonLabel:this.buttonLabel()})),this.setElement(t),this.$el.css("width",""+this.totalWidth+"px").find(".artwork-column").css({"margin-left":""+this.gutterWidth+"px",width:""+this.columnWidth+"px"}),this.$el.find(".artwork-column:first-child").css("margin-left","0"),this.appendArtworks(this.collection.models),this.seeMore?_.each(this.collection.rest(this.initialItemCount),function(t){return e.$el.find("figure[data-artwork='"+t.get("id")+"']").hide()}):void 0},i.prototype.appendArtworks=function(t){var e,r,o,i;for(i=[],r=0,o=t.length;o>r;r++)e=t[r],this.ordered?i.push(this.addToNextColumn(e)):i.push(this.addToShortestColumn(e));return i},i.prototype.buttonLabel=function(){return App.Collections.Artworks.formatSeeMoreText(this.collectionLength-this.initialItemCount)},i.prototype.addToNextColumn=function(t,e,r,o){var i;return i=this.appendFigure(t,this.currentColumn,e,r,o),this.currentColumn=this.currentColumn+1,this.currentColumn>this.columns.length-1&&(this.currentColumn=0),i},i.prototype.addToShortestColumn=function(t,e){var r,o,i;if((null!=(i=this.columns)?i.length:void 0)>0)return o=t.defaultImage(),r=o.maxHeightForWidth(this.columnWidth,this.maxArtworkHeight),this.appendFigure(t,this.shortestColumn,e),this.columns[this.shortestColumn].height+=r,this.columns[this.shortestColumn].artworkCount+=1,this.shortestColumn=_.reduce(this.indices,this.reduceColumns,this.shortestColumn,this)},i.prototype.appendFigure=function(t,e,r,o,i){var n,s;return s=JST["templates/artworks/_show"]({artwork:t,fixedWidth:this.columnWidth,maxDimension:this.maxArtworkHeight,notes:this.displayNotes&&r?r:void 0,displayBid:this.displayBid,isAuction:this.isAuction,displayPurchase:this.displayPurchase,displaySold:this.displaySold,displayMoreInfo:this.displayMoreInfo,displayAuctionPrice:o,estimate:i}),n=$(s),this.$(".artwork-column:eq("+e+")").append(n),n},i.prototype.reduceColumns=function(t,e){return this.columns[t].height<this.columns[e].height?t:this.columns[t].height>this.columns[e].height?e:this.columns[t].artworkCount>this.columns[e].artworkCount?e:t},i.prototype.onSeeMoreClick=function(){return this.$el.find("figure:not(:visible)").fadeIn("fast"),this.$el.find(".see_more").hide()},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ArtworkDoge=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.starters=["such","wow","what","such","very","so","nice","omg","much","so",""],o.prototype.maxItems=7,o.prototype.colors=["#fff","#ff00ff","#7CA4C8","#D7E46E","#e8bbda","#00ff00","#ffff00"],o.prototype.fontMax=33,o.prototype.fontMin=18,o.prototype.topMargin=10,o.prototype.rightMargin=90,o.prototype.itemMargin=50,o.prototype.initialize=function(){var t,e,r,o=this;return Analytics.click("Artwork viewed in doge mode"),r=this.$("> img").width(),t=this.$("> img").height(),this.$el.append(JST["templates/artworks/doge"]({items:this.formatItems(this.options.layers)})),this.$(".doge-container").css({width:r,height:t}),e=[],this.$(".doge-text").each(function(i,n){var s;return s=o.smartGetRandomPosition(r,t,e),$(n).css({"font-size":""+o.getRandomInt(o.fontMin,o.fontMax)+"px",color:"hsl("+o.getRandomInt(0,360)+", 100%, "+o.getRandomInt(40,80)+"%)",top:s.top,left:s.left}),e.push(s)})},o.prototype.formatItems=function(t){var e,r,o,i,n;for(e=_.filter(t,function(t){return(null!=t?t.get("name"):void 0)&&"Color Similarity"!==t.get("name")&&t.get("name").indexOf("For You")<0}),n=e.slice(0,+this.maxItems+1||9e9),o=0,i=n.length;i>o;o++)r=n[o],r.dogeDisplay=""+this.starters[this.getRandomInt(0,this.starters.length)]+" "+r.get("name");return e},o.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},o.prototype.smartGetRandomPosition=function(t,e,r){var o,i,n,s;for(o=this.getRandomPosition(e,t),n=0,s=r.length;s>n;n++)i=r[n],o.top>i.top&&o.top<i.top+this.itemMargin?o=this.smartGetRandomPosition(t,e,r):o.left>i.left&&o.left<i.left+this.itemMargin&&(o=this.smartGetRandomPosition(t,e,r));return o},o.prototype.getRandomPosition=function(t,e){return{top:this.getRandomInt(0+this.topMargin,t-this.rightMargin),left:this.getRandomInt(0+this.topMargin,e-this.rightMargin)}},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ColorFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .color_wall .brick":"onColorClick","click a.clear":"clear"},o.prototype.initialize=function(){var t=this;return this.$selection=this.$(".selection"),this.filterView=new App.Views.ExpandableFilter({el:this.el,model:this.model,afterOpen:function(){return t.afterOpen()},beforeClose:function(){return t.beforeClose()}}),this.colors=this.model.get("colors"),this.model.bind("change:colors",this.updateColors,this),this.model.bind("change:selectedColor",function(){return t.onColorSelection(t.model.get("selectedColor"))}),this.$(".opts").html(JST[this.template()]()),this.$(".wheel_clone path, .black_white circle").on("click",function(e){return t.onColorClick(e)}),this.$clearLink=this.$("a.clear"),this.$clearLink.hide()},o.prototype.updateColors=function(){var t,e=this;return this.colors=this.model.get("colors"),this.selectedColor=this.model.get("selectedColor"),t=_.pluck(_.filter(this.colors,function(t){return 0===t.count&&t.id!==e.selectedColor}),"id"),this.enableAllColors(),t.length>0&&this.blockEmptyColors(t),this.$clearLink.hide(),this.selectColor(this.selectedColor),this.selectedColor?this.onColorSelection(this.selectedColor):void 0},o.prototype.enableAllColors=function(){return this.hasInlineSVG()?(this.$(".wheel path").attr("class",""),this.$(".wheel_clone path").attr("class",""),this.$(".black_white circle").attr("class","")):this.$(".color_wall .brick div").removeClass("empty")},o.prototype.blockEmptyColors=function(t){return this.hasInlineSVG()?_.each(t,function(t){return"black-and-white"===t?(this.$(".black_white circle").attr("class","empty"),void 0):(this.$(".wheel_clone path[data-color="+t+"]").attr("class","empty"),this.$(".wheel path[data-color="+t+"]").attr("class","empty"))}):_.each(t,function(t){return this.$(".color_wall .brick ."+t).addClass("empty")})},o.prototype.onColorClick=function(t){var e,r;return e=$(t.target),e.hasClass("empty")||"empty"===e.attr("class")?void 0:(r=e.attr("data-color"),this.model.set({selectedColor:r}))},o.prototype.onColorSelection=function(t){var e;return e=this.$selection.attr("data-color")||"",this.$selection.removeClass(e),t?this.$selection.attr("data-color",t).addClass(t):(this.$selection.removeAttr("data-color"),void 0)},o.prototype.selectColor=function(t){var e;if(!this.hasSVG)return this.$(".brick .selected").removeClass("selected"),t&&(this.$(".brick ."+t).addClass("selected"),this.$clearLink.show()),void 0;if(t)return Analytics.click("Clicked to filter by color","Color",t),this.$(".opts .selected").removeClass("selected"),this.$(".wheel_clone path").each(function(){return"selected"===$(this).attr("class")?$(this).attr("class",""):void 0}),"selected"===$(this).attr("class")&&this.$(".black_white circle").attr("class",""),"black-and-white"===t?this.$("circle").attr("class","selected"):(e=this.$(".wheel_clone path[data-color="+t+"]").detach(),e.attr("class","selected").appendTo("#artworks .color .wheel_clone")),this.$clearLink.show()},o.prototype.hasInlineSVG=function(){var t;return null!=this.hasSVG?this.hasSVG:(t=document.createElement("div"),t.innerHTML="<svg/>",this.hasSVG="http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI),$.browser.opera&&(this.hasSVG=!1),this.hasSVG||this.$el.addClass("nosvg"),this.hasSVG)},o.prototype.template=function(){return this.hasInlineSVG()?"templates/artworks/filters/color_wheel":"templates/artworks/filters/color_wall"},o.prototype.clear=function(){return this.model.set({selectedColor:!1}),this.$clearLink.fadeOut(this.model.speed),!1},o.prototype.afterOpen=function(){return null!=this.selectedColor&&this.selectedColor?this.$clearLink.show():void 0},o.prototype.beforeClose=function(){return this.$clearLink.hide()},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.DockableFilterOptions=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.eventName="dockedFilterOptions",o.prototype.initialize=function(){return this.$el.hide(),this.$offsetEl=this.options.offsetEl,this.$bottomEl=this.options.bottomEl,this.options.eventName&&(this.eventName=this.options.eventName),this.minTop=this.options.minTop||70},o.prototype.updateOffset=function(){var t,e=this;if(null!=(t=this.$offsetEl)?t.is(":visible"):void 0)return _.delay(function(){var t;return e.offset=null!=(t=e.$offsetEl)?t.offset().top:void 0,e.onScroll()},500)},o.prototype.load=function(){var t=this;if(!App.IS_PHONE)return this.updateOffset(),App.$window.off("."+this.eventName),App.$window.on("scroll."+this.eventName,function(){return t.onScroll()}),App.router.viewState.bind("change:browseIsOn",this.updateOffset,this),_.defer(function(){var e,r;if(null!=(e=t.$offsetEl)?e.is(":visible"):void 0)return t.offset=null!=(r=t.$offsetEl)?r.offset().top:void 0,t.$el.show(),t.height=t.$el.height(),t.onScroll()})},o.prototype.unload=function(){return App.$window.off("."+this.eventName),App.router.viewState.unbind("change:browseIsOn",this.updateOffset)},o.prototype.onScroll=function(){var t,e,r,o;return r=App.$window.scrollTop(),t=0,0>r?!1:(e=this.offset-r,e<=this.minTop&&(e=this.minTop),this.$el.css({top:""+e+"px",bottom:"auto",position:"fixed"}),(null!=(o=this.$bottomEl)?o.is(":visible"):void 0)&&(t=this.$bottomEl.position().top-this.height,this.$el.position().top>t)?(this.mode="absolute",this.$el.css({top:"auto",bottom:"0px",position:"absolute"}),!1):this.mode="fixed")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ExpandableFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click h2":"slideToggle"},o.prototype.initialize=function(){return this.$h2=this.$("h2"),this.$arrow=this.$("h2 span"),this.$opts=this.$(".opts"),null==this.options.afterOpen&&(this.options.afterOpen=$.noop),null==this.options.afterClose&&(this.options.afterClose=$.noop),null==this.options.beforeOpen&&(this.options.beforeOpen=$.noop),null==this.options.beforeClose&&(this.options.beforeClose=$.noop),$("html").hasClass("ie8")?this.updateArrow():void 0},o.prototype.slideOpen=function(){return this.$el.hasClass("on")?void 0:this.slideToggle()},o.prototype.slideClose=function(){return this.$el.hasClass("on")?this.slideToggle():void 0},o.prototype.slideToggle=function(){var t=this;return this.isAnimated()?!1:(this.updateArrow(),this.$el.hasClass("on")?this.options.beforeClose():this.options.beforeOpen(),this.$opts.slideToggle(function(){return t.$el.toggleClass("on"),t.model.trigger("optionToggled"),t.$el.hasClass("on")?t.options.afterOpen():t.options.afterClose()}))},o.prototype.updateArrow=function(){return this.$el.hasClass("on")?this.$arrow.html("&#9658;"):this.$arrow.html("&#9660;")},o.prototype.isAnimated=function(){return this.$opts.is(":animated")},o.prototype.isOpen=function(){return this.$el.hasClass("on")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FilterScroll=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){var t=this;return this.$clip=this.$(".clip"),this.$content=this.options.$content||this.$(".clip > ul"),this.$scrollbar=this.$(".scrollbar"),this.$handle=this.$(".handle"),this.attempts=0,App.$window=App.$window,this.$footer=$("footer.app"),_.defer(function(){return t.$el.tinyscrollbar(),t.cacheConstants()}),this.model.bind("change",this.sizeScroller,this),this.model.bind("optionToggled",this.sizeScroller,this),this.load()},o.prototype.load=function(){var t,e=this;return t=_.throttle(function(){return e.sizeScroller()},250),App.$window.bind("resize.artworkFilter",t),this.sizeScroller()},o.prototype.unload=function(){return App.$window.unbind(".artworkFilter")},o.prototype.sizeScroller=function(){if(this.clipH=Math.max(400,App.$window.height()-(this.footerHeight+this.headerHeight+this.paddingTop)),this.$clip.height(this.clipH),this.$content.height()>this.clipH)return this.$el.removeClass("noscroll"),this.$el.tinyscrollbar_update("relative");this.$content.css("top","0px"),this.$el.addClass("noscroll");try{return this.$el.tinyscrollbar_update()}catch(t){}},o.prototype.cacheConstants=function(){return this.footerHeight=this.$footer.height(),this.headerHeight=$("header.app").height(),this.paddingTop=parseInt(this.$el.css("padding-top")),this.sizeScroller()},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FilterSuggestions=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click a.opt":"geneSelect","click a.clear":"clearSelection"},o.prototype.initialize=function(){return this.$ulGenes=this.$("ul"),this.model.bind("change:genes",this.onGenesUpdate,this)},o.prototype.onGenesUpdate=function(){var t,e,r,o=this;return this.$ulGenes=this.$("ul"),t=this.model.get("genes"),r=this.model.get("selectedGene"),this.model.get("selectedMedium")&&_.size(t)>0?(this.$("ul.genes li").hide(),_.each(t,function(t,e){return o.$("li."+e).show().find(".count").text("("+t+")")}),e=[],_.each(t,function(t){return e.push(JST["templates/artworks/filters/text_option"]({item:t,empty:""}))}),this.$ulGenes.html(e.join("")),r&&this.$ulGenes.find("li[data-item="+r+"]").addClass("selected"),this.$el.slideDown(this.model.speed)):this.$el.slideUp(this.model.speed),this.model.trigger("optionToggle")},o.prototype.geneSelect=function(t){var e;return e=$(t.target).closest("li"),Analytics.click("Clicked on suggested filter","Gene",e.attr("data-item")),this.model.set({selectedGene:e.attr("data-item")}),this.$("li.selected").removeClass("selected"),e.addClass("selected"),!1},o.prototype.clearSelection=function(t){var e;return e=$(t.target),this.model.set({selectedGene:!1}),e.closest("li").removeClass("selected"),!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FilterTooltip=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.getWidth=function(){return"326px"},o.prototype.getPositionLeft=function(){},o.prototype.setPosition=function(){},o}(App.Views.ZigZagTooltip)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.MediumFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click a.opt":"mediumSelect","click a.clear":"clearSelection"},o.prototype.initialize=function(){return this.filterView=new App.Views.ExpandableFilter({el:this.el,model:this.model}),this.model.bind("change:mediums",this.render,this),this.model.bind("change:selectedMedium",this.onSelectedMedium,this),this.$selection=this.$("h2 .selection"),this.$ulOpts=this.$("ul"),this.rendered=!1},o.prototype.render=function(){var t,e;return t=[],this.mediums=this.model.get("mediums"),e=this.model.get("selectedMedium"),_.each(this.mediums,function(e){var r;return r=0===e.count?"empty":"",t.push(JST["templates/artworks/filters/text_option"]({item:e,empty:r}))}),this.$ulOpts.html(t.join("")),this.$ulOpts.find("li[data-item="+e+"]").addClass("selected"),e&&this.onSelectedMedium(),this.$el.hasClass("on")&&!this.rendered&&(this.$el.removeClass("on"),this.filterView.slideToggle()),this.rendered=!0,this},o.prototype.onSelectedMedium=function(){var t;return t=this.model.get("selectedMedium"),this.$selection.removeClass("medium"),t&&this.mediums[t]?this.$selection.addClass("medium").text(this.mediums[t].label):void 0},o.prototype.mediumSelect=function(t){var e;return e=$(t.target).closest("li"),e.hasClass("empty")?!1:(Analytics.click("Clicked to filter by medium","Gene",e.attr("data-item")),this.model.set({selectedMedium:e.attr("data-item")}),this.$("li.selected").removeClass("selected"),e.addClass("selected"),!1)},o.prototype.clearSelection=function(t){var e;return e=$(t.target),this.model.set({selectedMedium:!1}),e.closest("li").removeClass("selected"),!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.RelatedGeneFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click a.opt":"optionClick","click a.clear":"clearSelection"},o.prototype.initialize=function(){return this.filterView=new App.Views.ExpandableFilter({el:this.el,model:this.model}),this.model.bind("change:relatedGenes",this.render,this),this.model.bind("change:selectedRelatedGene",this.onSelectedRelatedGene,this),this.$selection=this.$("h2 .selection"),this.$ulOpts=this.$("ul"),this.rendered=!1},o.prototype.render=function(){var t,e;return t=[],this.genes=this.model.get("relatedGenes"),e=this.model.get("selectedRelatedGene"),_.each(this.genes,function(e){var r;return r=0===e.count?"empty":"",t.push(JST["templates/artworks/filters/text_option"]({item:e,empty:r}))}),this.$ulOpts.html(t.join("")),this.$ulOpts.find("li[data-item="+e+"]").addClass("selected"),e&&this.onSelectedRelatedGene(),this.$el.hasClass("on")&&!this.rendered&&(this.$el.removeClass("on"),this.filterView.slideToggle()),this.rendered=!0,this},o.prototype.onSelectedRelatedGene=function(){var t;return t=this.model.get("selectedRelatedGene"),this.$selection.removeClass("related_gene"),t&&this.genes[t]?this.$selection.addClass("related_gene").text(this.genes[t].label):void 0},o.prototype.optionClick=function(t){var e;return e=$(t.target).closest("li"),e.hasClass("empty")?!1:(Analytics.click("Clicked to select related gene","Gene",e.attr("data-item")),this.model.set({selectedRelatedGene:e.attr("data-item")}),this.$("li.selected").removeClass("selected"),e.addClass("selected"),!1)},o.prototype.clearSelection=function(t){var e;return e=$(t.target),this.model.set({selectedRelatedGene:!1}),e.closest("li").removeClass("selected"),!1},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.Results=function(r){function i(){return this.storeCurrentArtworkSet=e(this.storeCurrentArtworkSet,this),this.renderArtworks=e(this.renderArtworks,this),this.onResize=e(this.onResize,this),this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.ArtworkColumns),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via filtering",i.prototype.analyticsSaveMessage="Added artwork to collection, via filtering",i.prototype.page=1,i.prototype.size=24,i.prototype.top=0,i.prototype.waiting=!1,i.prototype.events={"click a.img_container":"storeCurrentArtworkSet"},i.prototype.initialize=function(){var t=this;return this.top=this.options.top||this.top,this.$footer=$("footer.app").hide(),this.$resultRow=this.$("section.artworks"),this.$preLoader=this.$(".pre_loader"),this.onFlushResults=!1,this.model.bind("change:selection",this.refreshArtworks,this),this.model.bind("change:artworks",this.render,this),_.defer(function(){return t.bindWindowEvents(),t.$preLoader.show()})},i.prototype.bindWindowEvents=function(){var t=this;return this.onScrollThrottled=_.debounce(function(){return t.onScroll()},75),this.onResizeThrottled=_.debounce(function(){return t.onResize()},75),App.$window.bind("scroll.artworkFilter",this.onScrollThrottled),App.$window.bind("resize.artworkFilter",this.onResizeThrottled)},i.prototype.unbindWindowEvents=function(){return App.$window.unbind(".artworkFilter")},i.prototype.onUnload=function(){return this.unbindWindowEvents(),this.$footer.show(),this.$resultRow.hide()},i.prototype.onLoad=function(){var t=this;return this.bindWindowEvents(),_.defer(function(){return t.fixedWidth=t.$resultRow.show().width(),t.rendered?void 0:t.render()})},i.prototype.onResize=function(){return this.fixedWidth=this.$el.width(),this.setupArtworkColumnRowWidth(),this.refreshArtworks(),this.$resultRow.show()},i.prototype.refreshArtworks=function(){return this.refreshing?void 0:(this.$el.addClass("empty"),this.unrender())},i.prototype.unrender=function(){return this.rendered=!1,this.$resultRow.show(),$("html, body").is(":animated")||$("html, body").animate({scrollTop:this.top},260),this.model.getArtworks(),this.refreshing=!1},i.prototype.render=function(){var t;if(!this.refreshing)return this.waiting=!1,t=this.model.get("artworks"),this.$el.removeClass("empty"),0===this.model.get("total")&&0===t.length&&0!==this.model.requestCount?(this.$preLoader.hide(),void 0):(this.artworkColumns||(this.fixedWidth=this.$resultRow.width(),this.setupArtworkColumnRowWidth()),this.renderArtworks(t),this.$resultRow.show())},i.prototype.renderArtworks=function(t){var e=this;if(!this.refreshing)return this.rendered?this.appendArtworksToColumns(t.models):(this.initializeArtworkColumns(t),this.rendered=!0),this.$(".loading").load(function(){return $(this).removeClass("loading")}),this.$preLoader.hide(),_.defer(function(){return e.initializeArtworksFromDom()})},i.prototype.appendArtworksToColumns=function(t){var e,r,o,i;for(i=[],r=0,o=t.length;o>r;r++)e=t[r],i.push(this.columns.addToShortestColumn(e));return i},i.prototype.initializeArtworkColumns=function(t){return this.columns=new App.Views.ArtworkColumns({gutterWidth:this.artworkColumnMargin,numberOfColumns:this.artworkColumns,totalWidth:this.fixedWidth,collection:t}),this.$resultRow.html(this.columns.$el).find(".artwork-column figure:first-child").css({"padding-top":"0px"})},i.prototype.onScroll=function(){var t;if(!this.model.isLastPage()&&!this.waiting)return t=App.$window.height()+App.$window.scrollTop(),t>=this.$resultRow.height()-1e3?(this.waiting=!0,this.$preLoader.show(),this.model.getNextPage()):void 0},i.prototype.storeCurrentArtworkSet=function(t){var e,r,o;return e=$(t.target).parent(".img_container"),App.currentArtworkSet=this.model.get("artworks").models,App.currentArtworkIndex=this.$(".img_container").index(e),App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=null!=(r=App.router.viewState.frames[App.currentFrameName])?null!=(o=r.frame)?o.frameTitle:void 0:void 0},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ResultsHeader=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"change select":"onSortChange"},o.prototype.initialize=function(){return this.$countContainer=this.$("h3 .count"),this.$noResults=this.$(".noresults"),this.$sortSelect=this.$(".sort select"),this.model.bind("change:selection",this.onSelectionChanged,this),this.model.bind("change:total",this.updateCounts,this),this.model.bind("change:selectedSort",this.onSortSelection,this),this.updateDisabled(),this.updateCounts()},o.prototype.updateCounts=function(){var t;return t=this.model.get("total"),0===t?(this.$countContainer.hide(),this.$noResults.show()):(this.$noResults.hide(),this.$countContainer.show().text("Showing "+this.model.formatNumber(t)+" artwork"+(1===t?"":"s"))),this.updateDisabled()},o.prototype.updateDisabled=function(){var t;return t=this.model.get("total"),this.disabled=0===t,this.toggleDisabled()},o.prototype.toggleDisabled=function(){return this.disabled?this.$sortSelect.attr("disabled","disabled"):this.$sortSelect.removeAttr("disabled")},o.prototype.onSortSelection=function(){return this.$sortSelect.find("option[value='"+this.model.get("selectedSort")+"']").select(),this.updateCounts()},o.prototype.onSortChange=function(){return this.disabled?!1:this.model.set({selectedSort:this.$sortSelect.val()})},o.prototype.onSelectionChanged=function(){return this.selectionChangedOnce&&(this.$noResults.hide(),this.$countContainer.show().text("Loading ...")),this.selectionChangedOnce=!0},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.SaleFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)
}return r(o,e),o.prototype.events={"click a.opt":"priceBucketSelect","click a.clear":"clearSelection"},o.prototype.initialize=function(t){return this.options=t,t.expandableFilter&&(this.filterView=new App.Views.ExpandableFilter({el:this.el,model:this.model}),this.$selection=this.$("h2 .selection"),this.model.bind("change:selectedPriceBucket",this.onSelectedPriceBucketChange,this)),this.$ulOpts=this.$("ul"),this.rendered=!1},o.prototype.render=function(){var t,e;return t=[],e=this.model.get("selectedPriceBucket"),this.$ulOpts.find("li[data-item='"+e+"']").addClass("selected"),e&&this.onSelectedPriceBucketChange(),this.options.expandableFilter&&this.$el.hasClass("on")&&!this.rendered&&(this.$el.removeClass("on"),this.filterView.slideToggle()),this.rendered=!0,this},o.prototype.onSelectedPriceBucketChange=function(){var t,e;return this.priceBuckets=this.model.get("priceBuckets"),this.$selection.length?(this.$selection.removeClass("price_bucket"),t=this.model.get("selectedPriceBucket"),e=this.$ulOpts.find("li[data-item='"+t+"']").find("a.opt").text(),t&&e?this.$selection.addClass("price_bucket").text(e):this.$("li.selected").removeClass("selected")):void 0},o.prototype.priceBucketSelect=function(t){var e;return e=$(t.target).closest("li"),e.hasClass("empty")?!1:(Analytics.click("Selected price bucket","Bucket",this.model.get("selectedPriceBucket")),this.model.set({selectedPriceBucket:e.attr("data-item")}),this.$("li.selected").removeClass("selected"),e.addClass("selected"),!1)},o.prototype.clearSelection=function(t){var e;return e=$(t.target),this.model.set({selectedPriceBucket:!1}),e.closest("li").removeClass("selected"),!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.SizeFilter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click a.clear":"clearSelection",mouseenter:"onHover"},o.prototype.ftPxRatio=40/6,o.prototype.initialize=function(t){return this.filterView=new App.Views.ExpandableFilter({el:this.el,model:this.model}),this.$(".opts").html(JST["templates/artworks/filters/size_filter"]()),this.$filterEl=$(t.filterEl),this.$bubble=this.$(".size_bubble"),this.$slider=this.$(".ui-slider"),this.$labels=this.$(".label"),this.$clearLink=this.$("a.clear"),this.$box=this.$(".box"),this.$dims=this.$(".text .dims"),this.$selection=this.$("h2 .selection"),this.model.bind("optionToggled",this.hideBubble,this),this.model.bind("change:dimensions",this.onDimensionsUpdate,this),this.model.bind("change:selectedDimensions",this.onSelectedDimensions,this),this.sliderIsSetup=!1,this.bubble=this.$bubble.detach().appendTo(this.$slider)},o.prototype.onDimensionsUpdate=function(){var t,e=this;return this.dimensions=this.model.get("dimensions"),this.selected=this.model.get("selectedDimensions"),this.selected&&(this.$labels.hide(),this.$clearLink.show()),this.values=[],_.each(this.dimensions,function(t){return t.count>0||t.val===parseInt(e.selected)?e.values.push(t.val):void 0}),t=this.values.length-1,this.selectedIndex=_.indexOf(this.values,parseInt(this.selected)),this.setReferenceValues(),this.$slider.slider({min:0,max:t,change:function(t,r){return e.onSlideStart(t,r)},start:function(t,r){return e.onSlideStart(t,r)},slide:function(t,r){return _.defer(function(){return e.updateBubble()}),e.updateReference(r.value)},stop:function(t,r){var o;return o=r.value,e.$labels.fadeOut(e.model.speed,function(){return e.$clearLink.fadeIn(e.model.speed)}),e.updateReference(o),e.selectedIndex=o,e.model.set({selectedDimensions:e.values[o]}),e.updateBubble()}}),this.$sliderHandle=this.$(".ui-slider-handle"),this.$slider.slider("enable"),0===this.values.length&&this.$slider.slider("disable"),this.selected?(this.$slider.slider("value",this.selectedIndex),this.$labels.fadeOut(this.model.speed,function(){return e.$clearLink.fadeIn(e.model.speed)}),this.onSelectedDimensions()):this.$sliderHandle.css("left","50%")},o.prototype.onSelectedDimensions=function(){var t;return t=this.model.get("selectedDimensions"),this.$selection.removeClass("dimension"),t?this.$selection.addClass("dimension").text(this.$dims.html()):void 0},o.prototype.onSlideStart=function(t,e){return this.updateReference(e.value),this.$slider.addClass("on"),"slidechange"!==t.type?this.updateBubble():void 0},o.prototype.updateBubble=function(){var t=this;return this.$bubble.css({display:"block",left:this.$sliderHandle.css("left"),opacity:"1"}),this.bubbleHideTimeout&&clearTimeout(this.bubbleHideTimeout),this.bubbleHideTimeout=setTimeout(function(){return t.$bubble.fadeOut(t.model.speed)},3e3)},o.prototype.setReferenceValues=function(){var t,e=this;if(!((null!=(t=this.refValues)?t.length:void 0)>0))return this.refValues=[],_.each(this.dimensions,function(t){var r;return e.dim=t,r=Math.floor(e.dim.val/12),e.refValues.push({ft:r,px:Math.round(e.ftPxRatio*r)})})},o.prototype.updateReference=function(t){var e;return e=this.refValues[t],this.$box.width(e.px).height(e.px),this.$dims.html(""+e.ft+"' &times; "+e.ft+"' (&times; "+e.ft+"')")},o.prototype.hideBubble=function(){return this.bubbleHideTimeout&&clearTimeout(this.bubbleHideTimeout),this.$bubble.fadeOut(this.model.speed)},o.prototype.onHover=function(){return!this.$bubble.is(":visible")&&this.filterView.isOpen()&&this.$slider.hasClass("on")?this.updateBubble():void 0},o.prototype.clearSelection=function(){var t=this;return this.$slider.removeClass("on"),this.$clearLink.fadeOut("fast",function(){return t.$labels.fadeIn("fast")}),this.hideBubble(),this.$slider.slider("option","animate",!0),this.$slider.slider("option","animate",!1),this.$sliderHandle.css("left","50%"),this.model.set({selectedDimensions:!1}),!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ArtworksInfo=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#artwork_side_panel .content .details",o.prototype.show=function(){return this.$el.addClass("show").siblings().removeClass("show")},o.prototype.hide=function(){return this.$el.removeClass("show")},o.prototype.visible=function(){return this.$el.hasClass("show")},o}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ArtworksListItem=function(r){function i(){return this.click=e(this.click,this),this.artworkClick=e(this.artworkClick,this),this.artistClick=e(this.artistClick,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.SaleDialog),i.prototype.events={"click a.artist":"artistClick","click a.img_container":"artworkClick","click .inquire":"showInquireDialog","click .contact_gallery":"showContactGalleryDialog"},i.prototype.initialize=function(){if(null==this.el)throw"You must pass an el";if(null==this.model)throw"You must pass a model";return this.$el.removeClass("uninitialized"),this.render(),this},i.prototype.render=function(){return this.renderControls()},i.prototype.artistClick=function(t){return App.router.viewState.saveScrollPosition(),Analytics.click("Selected artist from result rows","Artist",this.objectIdFromEvent(t))},i.prototype.artworkClick=function(t){return App.router.viewState.saveScrollPosition(),Analytics.click("Selected artwork from result rows","Artist",this.objectIdFromEvent(t))},i.prototype.objectIdFromEvent=function(t){var e;return null!=(e=$(t.target).attr("href"))?e.match(/\/(artist|artwork)\/([^\/]+)/)[2]:void 0},i.prototype.click=function(){return App.router.navigate("/artwork/"+this.model.get("id"),{trigger:!0})},i.prototype.renderControls=function(){return this.saveControls=new App.Views.ArtworksSaveControls({model:this.model,el:this.$(".overlay_controls")}),this.options.analyticsRemoveMessage&&(this.saveControls.analyticsRemoveMessage=this.options.analyticsRemoveMessage),this.options.analyticsSaveMessage?this.saveControls.analyticsSaveMessage=this.options.analyticsSaveMessage:void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SaleDialog=function(r){function i(){return this.toggleFollowArtist=e(this.toggleFollowArtist,this),this.unFollowArtist=e(this.unFollowArtist,this),this.followArtist=e(this.followArtist,this),this.askSpecialist=e(this.askSpecialist,this),this.contactGallery=e(this.contactGallery,this),this.showContactGallery=e(this.showContactGallery,this),this.showContactSpecialist=e(this.showContactSpecialist,this),this.useMailcheckSuggestion=e(this.useMailcheckSuggestion,this),this.mailcheck=e(this.mailcheck,this),this.mailCheckBlur=e(this.mailCheckBlur,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.width=function(){return App.IS_PHONE?440:990},i.prototype.handle="artwork",i.prototype.standardErrorMessage="Please double check your information below",i.prototype.events={"click .ui-dialog-titlebar-close":"hide","click .bottom .contact_gallery button":"contactGallery","click .bottom .specialist button":"askSpecialist","click .done input":"toggleFollowArtist","blur .user_email input":"mailCheckBlur","click .mailcheck":"useMailcheckSuggestion"},i.prototype.mailCheckBlur=function(t){var e,r;return e=$(t.target),e.val(null!=(r=e.val())?r.trim():void 0),this.mailcheck(e)},i.prototype.mailcheck=function(t){var e=this;return t.mailcheck({domains:Mailcheck.domains,suggested:function(t,r){var o;return(null!=(o=e.emailSuggestion)?o.full:void 0)!==r.full?(e.emailSuggestion=r,e.$(".mailcheck").hide().html("Did you mean <em><u>"+html_escape(r.full)+"</u></em>?").fadeIn(250)):void 0},empty:function(){return e.emailSuggestion=null,e.$(".mailcheck").fadeOut(250)}})},i.prototype.useMailcheckSuggestion=function(t){return t.preventDefault(),null!=this.emailSuggestion&&(this.$(".user_email input").val(this.emailSuggestion.full),this.$(".mailcheck").fadeOut(250)),!1},i.prototype.render=function(t){var e=this;return this.type=t,App.availableRepresentatives?this.show():(App.availableRepresentatives=new App.Collections.Users,App.availableRepresentatives.fetchAvailableRepresentative({success:function(){return e.show()},error:function(t,r){return r.suppressAppMessages=!0,e.show()}}))},i.prototype.onShow=function(){var t=this;return this.$el.html(JST["templates/artworks/dialog/show"]({artwork:this.model,currentUser:App.currentUser,representative:App.availableRepresentatives.models[0]})),this.$el.imagesLoaded(function(){return t.$("img").removeClass("loading")}),this.$textarea=this.$("section textarea"),this.$emailTip=this.$("section .email_tip"),this.handleLargePopovers(),this.sizeTextarea(),_.defer(function(){return"contact"===t.type?t.showContactGallery():t.showContactSpecialist(),App.currentUser.accountCreated()?void 0:t.addPlaceholders()})},i.prototype.addPlaceholders=function(){return this.$("form .user_name input").artsyplaceholder("Name"),this.$("form .user_email input").artsyplaceholder("Email")},i.prototype.showDone=function(){var t=this;return this.$(".top, .bottom").fadeOut(150,function(){return t.$("section.done").fadeIn(150)}),setTimeout(function(){return t.hide()},4e3)},i.prototype.showContactSpecialist=function(){var t=this;return this.type=!1,this.$(".bottom section").removeClass("contact_gallery").addClass("specialist").show(),this.$(".contact_gallery").fadeOut(150,function(){return t.$(".specialist").fadeIn(150)})},i.prototype.showContactGallery=function(){var t=this;return this.type="contact",this.$(".bottom section").removeClass("specialist").addClass("contact_gallery"),this.$(".specialist").fadeOut(150,function(){return t.$(".contact_gallery").fadeIn(150)})},i.prototype.showErrors=function(t){return this.$(".errors").show().html(t.join("<br />"))},i.prototype.contactGallery=function(t){var e;if(!$(t.target).hasClass("loading"))return $(t.target).addClass("loading"),this.$(".errors").hide(),e=this.$textarea.val(),this.submit("contactGallery",e),!1},i.prototype.askSpecialist=function(t){var e;if(!$(t.target).hasClass("loading"))return $(t.target).addClass("loading"),this.$(".errors").hide(),e=this.$textarea.val(),this.submit(!1,e),!1},i.prototype.sizeTextarea=function(){var t,e,r;return e=this.$(".bottom section").height(),r=this.$(".bottom .artwork").height(),r>e?(t=this.$textarea.height()+(r-e-5),this.$textarea.height(t)):void 0},i.prototype.submit=function(t,e){var r,o,i,n=this;return App.currentUser.accountCreated()?this.followArtist({silent:!0,success:function(){return n.createInquiryRequest({contactGallery:"contactGallery"===t?!0:!1,message:e})}}):(i=this.emailSuggestion,this.mailcheck(this.$("form .user_email input")),!i&&this.emailSuggestion?this.$(".loading").removeClass("loading"):(o=this.$("form .user_name input").val(),r=this.$("form .user_email input").val(),this.validate(o)&&this.validate(r)?this.createInquiryRequest({contactGallery:"contactGallery"===t?!0:!1,message:e,name:o,email:r}):this.$(".loading").removeClass("loading")))},i.prototype.createInquiryRequest=function(t){var e=this;return $.ajax({type:"POST",url:"/api/v1/me/artwork_inquiry_request",data:{artwork:this.model.get("id"),message:t.message,contact_gallery:t.contactGallery,name:t.name,email:t.email},success:function(){return e.showDone(),e.$(".loading").removeClass("loading"),Analytics.funnel("Sent artwork inquiry",e.model)},error:function(t){var r;return e.$(".loading").removeClass("loading"),t.suppressAppMessages=!0,r=JSON.parse(t.responseText),e.showErrors([r.message||r.error||t.statusText])}})},i.prototype.handleLargePopovers=function(){var t;return App.IS_PHONE?void 0:(t=App.$window.height()-168,this.$el.css({"max-height":""+t+"px"}))},i.prototype.followArtist=function(t){return this.model.get("artist")?this.model.get("artist").follow(t):void 0},i.prototype.unFollowArtist=function(t){return this.model.get("artist")?this.model.get("artist").unfollow(t):void 0},i.prototype.toggleFollowArtist=function(){var t;return t=this.$("input.artist_follow"),t.is(":checked")?(Analytics.click("Clicked 'follow artist from artwork sale popopver'"),this.followArtist({silent:!0})):(Analytics.click("Clicked 'unfollow artist from artwork sale popopver'"),this.unFollowArtist({silent:!0})),!0},i.prototype.validate=function(t){return t&&t.length>0&&t.trim().length>1?!0:(this.showErrors([this.standardErrorMessage]),!1)},i}(App.Views.ModalDialog)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ArtworksSaveControls=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .save":"saveClick"},o.prototype.analyticsRemoveMessage="Removed artwork from collection, via result rows",o.prototype.analyticsSaveMessage="Added artwork to collection, via result rows",o.prototype.initialize=function(){var t;if(null==this.el)throw"You must pass an el";if(null==this.model)throw"You must pass a model";return this.$saveContainer=this.$(".save_container"),t=App.currentUser.defaultArtworkCollection(),t?(this.listenTo(t,"add:"+this.model.get("id"),this.onArtworkSaveChange),this.listenTo(t,"remove:"+this.model.get("id"),this.onArtworkSaveChange),this.options.autoFavorite&&this.performAutoSave(),this.onArtworkSaveChange()):void 0},o.prototype.performAutoSave=function(){return this.model.isSaved()?void 0:this.saveClick(this.$(".save"))},o.prototype.onArtworkSaveChange=function(){return this.model.isSaved()?(this.$saveContainer.removeClass("unsaved").addClass("saved"),this.$(".save_container .label").text("Saved")):(this.$saveContainer.removeClass("saved").addClass("unsaved"),this.$(".save_container .label").text("Favorite"))},o.prototype.sticky=function(){return this.$saveContainer.hasClass("saved")&&"userFavorites"!==App.currentFrameName},o.prototype.saveClick=function(){var t=this;return App.currentUser.accountCreated()?(this.$saveContainer.removeClass("committed"),this.model.isSaved()?(Analytics.click(this.analyticsRemoveMessage,this.model),this.model.unsave({success:function(){return t.$saveContainer.addClass("committed")},error:function(){return t.$saveContainer.removeClass("unsaved").addClass("saved")}})):(Analytics.click(this.analyticsSaveMessage,this.model),this.model.save({success:function(){return t.$saveContainer.addClass("committed")},error:function(){return t.$saveContainer.removeClass("saved").addClass("unsaved")}}),this.$saveContainer.addClass("clicked"),setTimeout(function(){return t.$saveContainer.removeClass("clicked")},1500)),!1):(App.loginSignupDialog.show("saveArtwork"),!1)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SeeMoreButton=function(r){function i(){return this.toggleSeeMoreBtn=e(this.toggleSeeMoreBtn,this),this.seeMore=e(this.seeMore,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={click:"seeMore"},i.prototype.initialize=function(){return this.$parent=$(this.options.parent.el),this.toggleSeeMoreBtn(),App.$window.resize(_.debounce(this.toggleSeeMoreBtn,App.WINDOW_DEBOUNCE_TIME))},i.prototype.seeMore=function(t){return this.options.parent.showNextPage(t),Analytics.click("Clicked 'See More' from result row")},i.prototype.toggleSeeMoreBtn=function(){return this.$parent.find("figure:hidden").length?this.$el.show():this.$el.hide()},i.prototype.onUnload=function(){return App.$window.unbind(".see_more")},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FeatureFrame=function(r){function i(){return this.videoSkipClick=e(this.videoSkipClick,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.CoverArt),_.extend(i.prototype,App.Mixins.ShareButtons),_.extend(i.prototype,App.Mixins.AuctionPopover),i.prototype.el="#feature",i.prototype.frameName="feature",i.prototype.minCoverHeight=220,i.prototype.maxCoverHeight=300,i.prototype.percentBrowserHeight=.3,i.prototype.initialize=function(t){return this.params=t},i.prototype.render=function(){var t=this;return this.$el.addClass("loading"),App.Repositories.Features.getOrFetch(this.params.featureId,["name"],{success:function(e){return t.model=e,App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=t.model.get("name"),t.$el.removeClass("loading").html(JST["templates/features/show"]({feature:t.model})).show(),t.$coverArt=t.$(".cover_art"),t.renderConfirmationFromParams(t.model.searchPath(),t.options),t.model.hasImage()&&t.renderCoverArt(),t.renderShareButtons(),t.model.fetchSets().then(function(){var e;return t.renderSets(),t.scrollTo(null!=(e=t.options.params)?e.section:void 0)})}})},i.prototype.renderShareButtons=function(){var t,e,r;return t=this.model.searchPath(),null!=t?(r=""+App.canonicalUrl+t,e=this.model.get("description"),this.initializeShareButtons({url:r,text:e})):void 0},i.prototype.renderSets=function(){var t,e,r=this;return e=this.model.get("sets"),t=JST["templates/features/sets"]({sets:e}),this.$el.find(".feature_container").append(t),_.each(e.filter(function(t){return"Sale"===t.get("item_type")}),function(t){return _.each(t.get("items").models,function(t){return r.renderSale(t)})}),_.each(e.filter(function(t){return"Video"===t.get("item_type")}),function(t){return _.each(t.get("items").models,function(t){var e,o;return e=r.renderVideo(t),App.IS_TABLET&&t.aspectRatio()>0?(o=e.$el.width(),e.$el.height(Math.floor(o/t.aspectRatio()))):void 0})})},i.prototype.renderSale=function(t){var e=this;return t.fetchSaleArtworks({success:function(t){var r;return"preview"===(r=t.get("auction_state"))||"open"===r?(e.$(".feature_top").append("<div class='auction_banner'></div>"),App.isLoggedIn()?t.checkCurrentUserRegistered({success:function(){return e.renderAuctionBanner(t),t.on("change:currentUserRegistered",function(){return e.showAuctionConfirmationDialog("registration")},e),e.renderSaleArtworks(t)}}):(e.renderAuctionBanner(t),e.renderSaleArtworks(t))):e.renderSaleArtworks(t)}})},i.prototype.renderAuctionBanner=function(t,e){return null==e&&(e={}),t.get("is_auction")?this.auctionBanner=new App.Views.AuctionBanner({feature:this.model,model:t,el:this.$(".auction_banner")}):void 0},i.prototype.renderSaleArtworks=function(t){return this.saleArtworks=new App.Views.SaleArtworks({model:t,el:this.$(".sale[data-id="+t.get("id")+"] .sale_artworks_container")})},i.prototype.renderVideo=function(t){return new App.Views.Video({model:t,el:this.$(".feature-video[data-id="+t.get("id")+"]"),skipClick:this.videoSkipClick})},i.prototype.videoSkipClick=function(){return $("html, body").animate({scrollTop:this.$(".sale:first").position().top},260)},i.prototype.setDocumentTitle=function(){return App.Repositories.Features.getOrFetch(this.options.featureId,["name"],{success:function(t){return App.$document.attr("title",_.htmlDecode(""+t.get("name")+" | Artsy"))}})},i.prototype.scrollTo=function(t){var e=this;if(t)return this.$el.imagesLoaded(function(){var r;return r=e.$(".set h1:contains('"+t+"')"),e.scrollToSection(r)})},i.prototype.onUnload=function(){var t;return null!=(t=this.auctionBanner)?t.onUnload():void 0},i.prototype.onLoad=function(){return this.render()},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.Feed=function(r){function i(){return this.recomputeItem=e(this.recomputeItem,this),this.recomputeItemColumn=e(this.recomputeItemColumn,this),this.recomputeEachShowHeight=e(this.recomputeEachShowHeight,this),this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),this.hideLoadingSpinner=e(this.hideLoadingSpinner,this),this.showLoadingSpinner=e(this.showLoadingSpinner,this),this.hideLoading=e(this.hideLoading,this),this.showLoading=e(this.showLoading,this),this.backToPageOne=e(this.backToPageOne,this),this.showBackToPageOne=e(this.showBackToPageOne,this),this.fetchMoreItems=e(this.fetchMoreItems,this),this.reRender=e(this.reRender,this),this.additionalFeedItemInit=e(this.additionalFeedItemInit,this),this.render=e(this.render,this),this.onResize=e(this.onResize,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.ArtworkColumns),_.extend(i.prototype,App.Mixins.BackToTopArrow),i.prototype.previousScrollTop=-1,i.prototype.rendered=!1,i.prototype.maxItemsInDom=20,i.prototype.marginLeftRight=110,i.prototype.minWidth=425,i.prototype.breakPoints={oneColumn:500},i.prototype.navHeight=500,i.prototype.events={"click .back_to_page_one":"backToPageOne"},i.prototype.initialize=function(){return this.items=[],this.$footer=$("footer.app").hide(),this.windowHeight=App.$window.innerHeight(),this.feedItems=this.options.feedItems,this.profile=this.options.profile,this.sortOrder=this.options.sortOrder,this.widthOffset=this.options.widthOffset||0,this.afterFetchCont=this.options.afterFetch,this.afterLoadCont=this.options.afterLoad,this.availableWidth=this.options.availableWidth,this.options.marginLeftRight&&(this.marginLeftRight=this.options.marginLeftRight),this.additionalParams=this.options.additionalParams,this.displayBacktoPageOne=this.options.displayBacktoPageOne||!1,this.headingText=this.options.headingText||!1,this.headingSortOrder=this.options.headingSortOrder||!1,this.$htmlBody=$("html, body"),this.skipRecompute=this.options.skipRecompute||!1,this.initialFeedItems=this.feedItems.removeFlagged().models,this.render(this.initialFeedItems)},i.prototype.onResize=function(){return this.width!==App.$window.innerWidth()?(this.windowHeight=App.$window.innerHeight(),this.reRender(this.feedItems)):void 0},i.prototype.render=function(t){var e,r=this;return this.rendered?this.handleFetchedItems(t):(App.currentUser.accountCreated()||this.showLoading(),this.latestItems=t,this.setupResponsiveFeed(),this.setupArtworkColumnRowWidth(),this.$el.html(JST["templates/feed/feed_items"]({headingText:this.headingText,headingSortOrder:this.headingSortOrder,fixedWidth:this.fixedWidth})),this.$feedItems=this.$("section.feed_items"),this.handleFetchedItems(t),this.initializeFromFrame({contentDiv:".feed_item:last"}),e=this.$(".feed_item"),e.length&&t.length&&this.latestItems.length?(this.lastItem=this.$(".feed_item:last"),this.$("article.feed_item").first().addClass("first"),this.$preLoader=this.$(".pre_loader"),this.popLockItLoaded=!0,this.$el.popLockIt({columnSelector:"section.column",feedItems:e,onScroll:function(t){return r.infiniteScroll(t)},preventFixed:App.IS_PHONE||App.IS_TABLET,additionalFeedItemInit:this.additionalFeedItemInit}),this.popLockItInitialized=!0,this.rendered=!0,this.afterLoadCont&&this.afterLoadCont()):this.fetchMoreItems(),_.delay(function(){return r.doneInitializingFeedItems=!0,r.initialized=!0},500),this.onLoad(!0,!0))},i.prototype.additionalFeedItemInit=function(t,e){var r;return r=this.latestItems[e],r&&"Post"===r.get("_type")&&this.items.push(new App.Views.FeedItemPost({model:r,el:t,parent:this})),this.doneInitializingFeedItems=!0},i.prototype.reRender=function(t){var e;return null==t&&(t=this.feedItems),this.rendered=!1,this.feedItems=t,this.popLockItInitialized=!1,this.$el.popLockIt("destroy"),$.data(this.$el,"plugin_popLockIt",0),this.$(".back_to_page_one").hide(),e=App.$window.scrollTop(),this.$el.html(""),this.render(t.models)},i.prototype.setupImageLoad=function(){return this.$(".unrendered").removeClass("unrendered"),this.$("img").load(function(){return $(this).removeClass("loading")})},i.prototype.setupResponsiveFeed=function(){var t,e,r;return this.width=this.availableWidth||App.$window.innerWidth(),t=600,App.IS_PHONE?(this.feedItemTemplate="templates/feed/feed_item_one_column",this.imageColumnWidth=this.minWidth,this.fixedWidth=this.minWidth):this.width+this.widthOffset<this.breakPoints.oneColumn?(this.feedItemTemplate="templates/feed/feed_item_one_column",this.imageColumnWidth=this.width+90+this.widthOffset):(this.feedItemTemplate="templates/feed/feed_item_two_column",r=404,e=80,this.imageColumnWidth=this.width-r-e-this.marginLeftRight-15+this.widthOffset,this.imageColumnWidth>t&&(this.imageColumnWidth=t),this.fixedWidth=r+e+this.imageColumnWidth)},i.prototype.fetchMoreItems=function(){var t=this;return this.doneInitializingFeedItems=!1,this.waiting=!0,Analytics.click("Paginating FeedItems"),this.showLoadingSpinner(),this.feedItems.fetchFeedItems({additionalParams:this.additionalParams,artworks:this.options.onlyShowsWithArtworks,sort:this.sortOrder,cursor:this.feedItems.cursor,success:function(e){var r;return r=e.length,e.removeFlagged(),r>0&&0===(null!=e?e.length:void 0)?t.fetchMoreItems():("function"==typeof t.afterFetchCont&&t.afterFetchCont(e),t.handleFetchedItems(e.models),t.hideLoadingSpinner(),t.waiting=!1,App.currentUser.get("followProfiles").syncFollows())},error:function(){return t.waiting=!1}})},i.prototype.getFeedItemHtml=function(t,e){var r,o,i,n,s;for(null==e&&(e={}),r=$(JST["templates/feed/feed_items_list"](_.extend(e,{feedItems:t,maxDimension:this.imageColumnWidth,feedItemTemplate:this.feedItemTemplate,fixedWidth:this.fixedWidth,artworkColumns:this.artworkColumns,user:App.currentUser}))),i=n=0,s=r.length;s>n;i=++n)o=r[i],this.items.push(new App.Views.FeedItem({model:t[i],el:o,parent:this}));return r},i.prototype.handleFetchedItems=function(t){var e,r,o,i,n,s,a,l,p;if(!(t.length>0))return this.handleDoneFetching();if(this.latestItems=t,r=this.getFeedItemHtml(t,{profile:this.profile}),e=this.$(".feed_item"),e.length>this.maxItemsInDom){for(a=this.maxItemsInDom/2,o=e.slice(0,a),n=0,l=0,p=o.length;p>l;l++)s=o[l],n+=$(s).outerHeight();i=o.offset().top+n,o.remove(),this.$feedItems.append(r),this.scrollTop>i&&this.$htmlBody.scrollTop(this.scrollTop-n),this.displayBacktoPageOne&&this.showBackToPageOne()}else this.$feedItems.append(r);return this.lastItem=e.last(),this.handleDoneFetching(),this.popLockItInitialized&&this.createNewItems(this.$("section.feed_items > article.unrendered"),t),this.setupImageLoad()},i.prototype.showBackToPageOne=function(){return this.backToTopShown?void 0:(this.$(".back_to_page_one").show(),this.backToTopShown=!0)},i.prototype.backToPageOne=function(){return this.items=[],this.doneFetching=!1,this.reRender(new App.Collections.FeedItems(this.initialFeedItems))},i.prototype.handleDoneFetching=function(){var t,e=this;return _.defer(function(){return e.recomputeEachShowHeight()}),this.feedItems.doneFetching?(null!=(t=this.$preLoader)&&t.hide(),this.$footer.show(),this.$el.addClass("done")):void 0},i.prototype.createNewItems=function(t){return t&&t.length?this.$el.popLockIt("addFeedItems",t):void 0},i.prototype.infiniteScroll=function(t){var e,r;return this.scrollTop=t,!this.feedItems.doneFetching&&!this.waiting&&this.lastItem.length&&this.active&&this.initialized&&this.doneInitializingFeedItems?(e=this.lastItem.offset()?this.lastItem.offset().top:0,t+1500>e&&(null!=(r=this.$preLoader)&&r.show(),this.fetchMoreItems()),this.showHideArrow()):void 0},i.prototype.showLoading=function(){return this.$el.addClass("loading")},i.prototype.hideLoading=function(){return this.$el.removeClass("loading")},i.prototype.showLoadingSpinner=function(){var t;return null!=(t=this.$preLoader)?t.addClass("loading"):void 0},i.prototype.hideLoadingSpinner=function(){var t;return null!=(t=this.$preLoader)?t.removeClass("loading"):void 0},i.prototype.onUnload=function(t){return null==t&&(t=!0),this.active=!1,App.router.off("recomputeFeed"),this.priorScrollPosition=App.$window.scrollTop(),this.$footer.show(),App.$window.off(".feed"),t&&(this.$el.html(""),this.popLockItLoaded)?this.$el.popLockIt("destroy"):void 0},i.prototype.onLoad=function(t,e){var r=this;return null==t&&(t=!1),null==e&&(e=!1),this.active=!0,e||this.reRender(this.feedItems),App.router.on("recomputeFeed",this.recomputeEachShowHeight),this.waiting=!1,t||this.showLoading(),this.feedItems.doneFetching?this.handleDoneFetching():this.$footer.hide(),App.IS_PHONE||App.$window.on("resize.feed",_.debounce(function(){return r.onResize()},500)),this.priorScrollPosition&&this.$htmlBody.scrollTop(this.priorScrollPosition),this.hideLoading(),_.delay(function(){return r.priorScrollPosition&&r.$htmlBody.scrollTop(r.priorScrollPosition),r.priorScrollPosition=void 0,r.lastItem=r.$(".feed_item:last"),r.recomputeEachShowHeight()},100)},i.prototype.recomputeEachShowHeight=function(){return this.popLockItLoaded&&!this.skipRecompute?this.$el.popLockIt("recompute"):void 0},i.prototype.recomputeItemColumn=function(t,e){return this.$el.popLockIt("recomputeItemColumn",t,e)},i.prototype.recomputeItem=function(t){var e;return e=this.$("article").index(t),this.$el.popLockIt("recomputeItem",e)},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FeedItem=function(r){function i(){return this.followingLeave=e(this.followingLeave,this),this.followingEnter=e(this.followingEnter,this),this.initializeProfilePopover=e(this.initializeProfilePopover,this),this.purchase=e(this.purchase,this),this.storeCurrentArtworkSet=e(this.storeCurrentArtworkSet,this),this.initializeArtworkColumns=e(this.initializeArtworkColumns,this),this.moreArtworksClick=e(this.moreArtworksClick,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.InitializeArtworks),_.extend(i.prototype,App.Mixins.ShareButtons),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via feed",i.prototype.analyticsSaveMessage="Added artwork to collection, via feed",i.prototype.events={"click .img_container":"storeCurrentArtworkSet","click .artist.follow a":"followArtist","click .artist.following a":"unfollowArtist","mouseenter .artist.following a":"followingEnter","mouseleave .artist.following a":"followingLeave","click .purchase":"purchase"},i.prototype.getProfile=function(){var t;
return null!=(t=this.model)?t.toChildModel().get("profile"):void 0},i.prototype.initialize=function(){var t=this;if(this.model)return this.parent=this.options.parent,this.model.isArtworkColumns()&&this.initializeArtworkColumns(),_.defer(function(){return t.initializeArtworksFromDom(),t.shouldDisplayProfilePopover()&&t.initializeProfilePopover(),"FollowArtist"===t.model.get("_type")&&t.initializeFollowButton(),t.renderShareButtons()})},i.prototype.moreArtworksClick=function(t){return Analytics.click("Clicked show all artworks on feed item"),this.fetchMoreArtworks($(t.target))},i.prototype.fetchMoreArtworks=function(t){var e=this;return t.addClass("loading"),this.$el.find("figure:not(:visible)").fadeIn("fast"),this.model.toChildModel().fetchMoreArtworks({success:function(){return e.parent.setupImageLoad(),e.fetchMoreArtworks(t),e.model.get("artworks").length>=e.model.get("eligible_artworks_count")?(t.removeClass("loading"),e.initializeArtworksFromDom(),e.$(".see_more").remove(),e.parent.recomputeEachShowHeight()):void 0}}),!1},i.prototype.shareablePath=function(){return"Post"===this.model.get("_type")||"PartnerShow"===this.model.get("_type")?this.model.toChildModel().searchPath():void 0},i.prototype.renderShareButtons=function(){var t,e,r,o;return e=this.shareablePath(),null!=e?(o=""+App.canonicalUrl+e,r=this.model.toChildModel().getShareableTitle(),t=this.model.toChildModel().get("shareable_image_url"),this.initializeShareButtons({url:o,imageUrl:t,text:r})):void 0},i.prototype.initializeArtworkColumns=function(){var t=this;return this.artworkColumns=new App.Views.ArtworkColumns({seeMore:!0,initialItemCount:8,gutterWidth:this.parent.artworkColumnMargin,numberOfColumns:this.parent.artworkColumns,totalWidth:this.parent.fixedWidth,collection:this.model.get("artworks"),collectionLength:this.model.get("eligible_artworks_count"),onSeeMoreClick:function(e){return t.moreArtworksClick(e)},ordered:!0}),this.$el.find(".content").after(this.artworkColumns.$el),this.model.get("artworks").bind("add",function(e){return t.artworkColumns.appendArtworks([e])})},i.prototype.storeCurrentArtworkSet=function(t){var e,r,o,i,n,s,a;return r=this.model,App.currentArtworkSet=(null!=r?null!=(o=r.get("artworks"))?null!=(i=o.models)?i.length:void 0:void 0:void 0)>1?r.get("artworks").models:void 0,App.currentArtworkIndex=this.$(".img_container").index($(t.target).parent(".img_container")),e=(null!=(n=App.currentArtworkSet)?n[App.currentArtworkIndex]:void 0)||r.get("artworks").models[0],e&&Analytics.click("Clicked artwork from FeedItem",e),App.previousFrameUrl=""===Backbone.history.fragment?"/":"/"===Backbone.history.fragment[0]?Backbone.history.fragment:"/"+Backbone.history.fragment,App.previousFrameTitle=null!=(s=App.router.viewState.frames[App.currentFrameName])?null!=(a=s.frame)?a.frameTitle:void 0:void 0},i.prototype.purchase=function(t){var e,r,o;return e=$(t.target),o=e.attr("data-id"),r=App.Repositories.Artworks.get(o),r.get("edition_sets_count")>1?App.router.navigate("/artwork/"+r.get("id"),{trigger:!0}):!1},i.prototype.shouldDisplayProfilePopover=function(){var t;return"Post"===this.model.get("_type")||"FollowArtist"===this.model.get("_type")||(null!=(t=this.getProfile())?t.isCurrentProfile():void 0)},i.prototype.isMe=function(){var t,e;return(null!=(t=App.currentProfile)?t.get("id"):void 0)===(null!=(e=this.model.get("profile"))?e.get("id"):void 0)},i.prototype.initializeProfilePopover=function(){return this.profilePopover||(this.profilePopover=new App.Views.ProfilePopover({model:this.getProfile(),target:this.$(".posted_by"),isMe:this.isMe()}))},i.prototype.initializeFollowButton=function(){var t=this;return App.currentUser.ensureFollowArtists(function(){var e;return e=t.$(".content > .follow_actions").show().attr("data-id"),t.onFollowChange(App.Repositories.Artists.get(e).following(),t.$(".content > .follow_actions a"))})},i.prototype.getModelForEvent=function(t){var e;return e=$(t.target).parent().parent().attr("data-id"),App.Repositories.Artists.get(e)},i.prototype.followingEnter=function(t){return $(t.target).addClass("over").text("Unfollow Artist")},i.prototype.followingLeave=function(t){return $(t.target).removeClass("over").text("Following Artist")},i.prototype.onFollowChange=function(t,e){return t?e.text("Following Artist").parent().addClass("following").removeClass("follow"):e.text("Follow Artist").parent().addClass("follow").removeClass("following")},i.prototype.followArtist=function(t){var e,r,o=this;return App.isMessageVisible()?!1:App.currentUser.accountCreated()?(r=this.getModelForEvent(t))?(e=$(t.target),Analytics.click("Followed artist, via feed",r),this.onFollowChange(!0,e),e.removeClass("committed"),r.follow({success:function(){return e.addClass("committed")},error:function(){return o.onFollowChange(!1,e)}}),!1):!1:App.loginSignupDialog.show("followArtist")},i.prototype.unfollowArtist=function(t){var e,r,o=this;return App.isMessageVisible()?!1:(r=this.getModelForEvent(t))?(e=$(t.target),Analytics.click("Unfollowed artist, via feed",r),this.onFollowChange(!1,e),e.removeClass("committed"),r.unfollow({success:function(){return e.addClass("committed")},error:function(){return o.onFollowChange(!0,e)}}),!1):!1},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FeedItemPost=function(r){function i(){return this.displayFeatureArtists=e(this.displayFeatureArtists,this),this.displayFeatureArtworks=e(this.displayFeatureArtworks,this),this.showOrHideRepostControls=e(this.showOrHideRepostControls,this),this.renderFeaturedBy=e(this.renderFeaturedBy,this),this.unrepostPost=e(this.unrepostPost,this),this.repostPost=e(this.repostPost,this),this.unfeaturePost=e(this.unfeaturePost,this),this.featurePost=e(this.featurePost,this),this.removePost=e(this.removePost,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click a.remove":"removePostClick","click a.edit":"editPostClick","click a.feature":"featurePostClick","click a.unfeature":"unfeaturePostClick","click a.repost":"repostPostClick","click a.unrepost":"unrepostPostClick","click a.permalink":"permalinkClick","click a.flag":"flagPostClick","click a.flagged":"unflagPostClick","mousemove .permalink_dialog":"permalinkDelayedHide","click .see_post":"seeMore","click .posts a.toggle":"togglePosts","click .posts_dialog a.close":"closePostsDialog","click a.feature_attachment":"featureAttachment","click a.unfeature_attachment":"unfeatureAttachment","click .feature_by_slug":"featureBySlug"},i.prototype.lineHeight=25,i.prototype.bodyPadding=220,i.prototype.minHeight=240,i.prototype.initialize=function(){var t=this;if(this.model)return this.parent=this.options.parent,this.initializePost(),App.IS_PHONE?_.delay(function(){return t.sizeBody()},800):_.defer(function(){return t.sizeBody()})},i.prototype.getProfile=function(){var t;return null!=(t=this.model)?t.toChildModel().get("profile"):void 0},i.prototype.sizeBody=function(){var t,e,r,o,i;return t=this.$(".content .body"),this.bodyHeight=t.height(),"post"!==App.currentFrameName?(App.IS_PHONE?e=200:(i=this.$(".top_section").height(),r=this.$("section.artworks").height()||0,o=r-i-this.bodyPadding/2,e=this.parent.windowHeight-this.bodyPadding-i,e=o>0&&e>o?o:e,e<this.minHeight&&(e=this.minHeight),"FollowArtist"===this.model.get("_type")&&(e-=100)),this.bodyHeight>e?(e=Math.floor(e/this.lineHeight)*this.lineHeight-Math.floor(this.lineHeight/2),t.css({"max-height":""+e+"px"}),this.$(".see_post").show(),this.parent.recomputeItem(this.$el)):void 0):void 0},i.prototype.seeMore=function(){var t=this;return Analytics.click("Clicked show more on post"),this.$(".content .body").animate({"max-height":this.bodyHeight},200,function(){return t.parent.recomputeEachShowHeight()}),this.$(".see_post").hide(),!1},i.prototype.initializePost=function(){var t=this;return this.initializePostLinks(),this.setDeviceClass(),this.$postsDialog=this.$(".posts_dialog"),this.postModel=this.model.toChildModel(),this.postModel.ensureRepostsFetched(this.showOrHideRepostControls),this.postModel.get("reposts").on("all",this.renderFeaturedBy,this),this.postModel.get("reposts").on("all",this.showOrHideRepostControls,this),this.isMe()?(this.postModel.on("change:updated_at",this.postRender,this),this.postModel.get("attachments").on("add remove",this.postRender,this),App.router.viewState.bind("frameUnload:"+this.frameName,function(){return t.postModel.off(null,null,t),App.router.viewState.off("frameUnload:"+t.frameName,null,t)})):void 0},i.prototype.postRender=function(){return this.model.set(this.postModel.attributes,{silent:!0}),this.$el.replaceWith(JST[this.parent.feedItemTemplate]({feedItem:this.model,artworks:this.model.initialArtworks(),imageColumnWidth:this.parent.imageColumnWidth,fixedWidth:this.parent.fixedWidth})),this.parent.reRender(),this.parent.recomputeEachShowHeight()},i.prototype.isMe=function(){var t,e;return(null!=(t=App.currentProfile)?t.get("id"):void 0)===(null!=(e=this.model.get("profile"))?e.get("id"):void 0)},i.prototype.removePost=function(){var t,e=this;return this.isMe()||App.currentUser.isAdmin()?(this.parent.feedItems.remove(this.model),t=this.model.toChildModel(),App.Repositories.Posts.remove(t.get("id")),t.destroy(),this.$el.slideUp(function(){return e.$el.remove(),e.parent.recomputeEachShowHeight(),App.currentProfile.trigger("removePost",t)})):!1},i.prototype.featurePost=function(){var t,e;return null!=(e="function"==typeof(t=this.model).feature?t.feature():void 0)||this.model.toChildModel().feature(),App.showMessage("Post has been featured."),this.$("a.feature").addClass("unfeature").removeClass("feature").text("unfeature")},i.prototype.unfeaturePost=function(){var t,e;return null!=(e="function"==typeof(t=this.model).feature?t.feature():void 0)||this.model.toChildModel().unfeature(),App.showMessage("Post has been unfeatured."),this.$("a.unfeature").addClass("feature").removeClass("unfeature").text("feature")},i.prototype.repostPost=function(){var t,e;return null!=(e="function"==typeof(t=this.model).repost?t.repost():void 0)?e:this.model.toChildModel().repost()},i.prototype.unrepostPost=function(){var t,e;if(this.myRepost)return null!=(e="function"==typeof(t=this.model).repost?t.repost():void 0)?e:this.model.toChildModel().unrepost(this.myRepost)},i.prototype.renderFeaturedBy=function(){return this.$(".featured_by").html(JST["templates/posts/shared/featured_by"]({post:this.model.toChildModel()}))},i.prototype.setMyRepost=function(){return this.myRepost=this.postModel.get("reposts").detect(function(t){return t.isMine()})},i.prototype.showOrHideRepostControls=function(){return this.setMyRepost(),this.myRepost?(this.myRepost.get("id")&&this.$("a.unrepost").show(),this.$("a.repost").hide()):(this.$("a.unrepost").hide(),this.$("a.repost").show())},i.prototype.removePostClick=function(){return confirm("Are you sure you want to delete this post?")?(this.removePost(),!1):!1},i.prototype.editPostClick=function(){return this.isMe()&&this.postModel?(App.postDialog.updatePost(this.postModel),App.postDialog.openDialog(),!1):!1},i.prototype.featurePostClick=function(){return confirm("Are you sure you want to feature this post?")?(this.featurePost(),!1):!1},i.prototype.unfeaturePostClick=function(){return confirm("Are you sure you want to unfeature this post?")?(this.unfeaturePost(),!1):!1},i.prototype.flagPostClick=function(){return App.currentUser.isAdmin()&&confirm("Are you sure you want to flag this post?")?(this.flagPost(),!1):!1},i.prototype.unflagPostClick=function(){return App.currentUser.isAdmin()&&confirm("Are you sure you want to unflag this post?")?(this.unflagPost(),!1):!1},i.prototype.flagPost=function(){var t,e;return null!=(e="function"==typeof(t=this.model).flag?t.flag():void 0)||this.model.toChildModel().flag(),App.showMessage("Post has been flagged."),this.$("a.flag").addClass("flagged").removeClass("flag").text("Flagged")},i.prototype.unflagPost=function(){var t,e;return null!=(e="function"==typeof(t=this.model).unflag?t.unflag():void 0)||this.model.toChildModel().unflag(),App.showMessage("Post has been unflagged."),this.$("a.flagged").addClass("flag").removeClass("flagged").text("Flag")},i.prototype.repostPostClick=function(){return this.repostPost(),!1},i.prototype.unrepostPostClick=function(){return this.unrepostPost(),!1},i.prototype.initializePostLinks=function(){var t=this;return this.$el.find(".post_link.video_link").each(function(e,r){var o,i;return o=new App.Views.PostsVideoLink({el:r,model:null!=(i=t.model.toChildModel().get("attachments"))?i.get($(r).data("attachment")):void 0,onPlay:function(){return t.parent.recomputeEachShowHeight()}})})},i.prototype.permalinkClick=function(){return this.$permalinkDialog.toggleClass("on"),this.$permalinkDialog.is(".on")?(this.closePostsDialog(),this.$permalinkDialogInput.focus().select(),App.IS_IOS||this.permalinkDelayedHide()):window.clearTimeout(this.permalinkTimeout),!1},i.prototype.permalinkDelayedHide=function(){var t=this;return window.clearTimeout(this.permalinkTimeout),App.IS_IOS?void 0:this.permalinkTimeout=window.setTimeout(function(){return t.$permalinkDialog.removeClass("on"),window.clearTimeout(t.permalinkTimeout)},5e3)},i.prototype.setDeviceClass=function(){var t;return this.$permalinkDialog=this.$(".permalink_dialog"),this.$permalinkDialogInput=this.$permalinkDialog.find("input"),App.IS_MAC&&(t="mac"),App.IS_PC&&(t="pc"),this.$permalinkDialog.find("h4").addClass(t)},i.prototype.updateFeatured=function(t){var e,r,o,i=this;return e=t.get("id"),r=t.modelName,null!=(null!=(o=this.postModel.get("feature_"+t.modelName+"s"))?o.get(t.id):void 0)?this.$(".posts_dialog ul."+r+"s a[data-"+r+"_id="+e+"]").addClass("unfeature_attachment"):$.ajax("/api/v1/post/"+this.postModel.get("id")+"/"+r+"/"+e+"/feature",{success:function(){return i.$(".posts_dialog ul."+r+"s a[data-"+r+"_id="+e+"]").addClass("unfeature_attachment")},error:function(t){return t.suppressAppMessages=!0,i.$(".posts_dialog ul."+r+"s a[data-"+r+"_id="+e+"]").addClass("feature_attachment")}})},i.prototype.togglePosts=function(){return this.$postsDialog.is(":visible")||(this.$permalinkDialog.is(":visible")&&this.$permalinkDialog.removeClass("on"),this.loadPosts(),this.positionPostsDialog()),this.$postsDialog.toggleClass("on"),!1},i.prototype.loadPosts=function(){return this.postModel.ensureFeatureArtistsFetched(this.displayFeatureArtists),this.postModel.ensureFeatureArtworksFetched(this.displayFeatureArtworks)},i.prototype.closePostsDialog=function(){return this.$postsDialog.removeClass("on")},i.prototype.positionPostsDialog=function(){var t;return t=$(".posts .toggle"),this.$postsDialog.css("margin-top",-this.$postsDialog.height()-40)},i.prototype.displayFeatureArtworks=function(t){var e,r,o,i,n,s,a,l,p,u,h,c,d,f;for(i=this.$(".posts_dialog ul.artworks"),e=new App.Collections.Artworks,e.add(t.models),c=this.postModel.get("attachments").models,s=0,p=c.length;p>s;s++)o=c[s],"PostArtwork"===o.get("type")&&e.add(o.get("artwork"));for(n="",d=e.models,a=0,u=d.length;u>a;a++)r=d[a],n+=JST["templates/posts/actions_feature_post_artwork"]({post:this.postModel,artwork:r});for(i.html(n),f=e.models,l=0,h=f.length;h>l;l++)r=f[l],this.updateFeatured(r);return this.positionPostsDialog()},i.prototype.displayFeatureArtists=function(t){var e,r,o,i,n,s,a,l,p,u,h,c,d,f,m;for(i=this.$(".posts_dialog ul.artists"),e=new App.Collections.Artists,e.add(t.models),c=this.postModel.get("attachments").models,s=0,p=c.length;p>s;s++)o=c[s],"PostArtwork"===o.get("type")&&(r=null!=(d=o.get("artwork"))?d.get("artist"):void 0,r&&e.add(r));for(n="",f=e.models,a=0,u=f.length;u>a;a++)r=f[a],n+=JST["templates/posts/actions_feature_post_artist"]({post:this.postModel,artist:r});for(i.html(n),m=e.models,l=0,h=m.length;h>l;l++)r=m[l],this.updateFeatured(r);return this.positionPostsDialog()},i.prototype.featureAttachment=function(t){var e,r,o,i=this;return o=$(t.target).attr("data-model_name"),e=$(t.target).attr("data-"+o+"_id"),r=this.$(".posts_dialog ul."+o+"s a[data-"+o+"_id="+e+"]"),r.hasClass("working")?!1:(r.addClass("working"),$.ajax("/api/v1/post/"+this.postModel.get("id")+"/"+o+"/"+e+"/feature",{type:"POST",success:function(){return i.postModel.set("feature_"+o+"s",null),i.loadPosts()}}))},i.prototype.unfeatureAttachment=function(t){var e,r,o,i=this;return o=$(t.target).attr("data-model_name"),e=$(t.target).attr("data-"+o+"_id"),r=this.$(".posts_dialog ul."+o+"s a[data-"+o+"_id="+e+"]"),r.hasClass("working")?!1:(r.addClass("working"),$.ajax("/api/v1/post/"+this.postModel.get("id")+"/"+o+"/"+e+"/feature",{type:"DELETE",success:function(){return i.postModel.set("feature_"+o+"s",null),i.loadPosts()}}))},i.prototype.displayFeatureBySlugError=function(t){var e;return t.suppressAppMessages=!0,this.$("li.slug .error").text(_.compact([null!=(e=JSON.parse(t.responseText).error)?e:t.statusText,this.$("li.slug .error").text()]).join(", "))},i.prototype.fetchModel=function(t,e,r){var o=this;return _.first(e).getOrFetch(t,[null],{success:function(t){return null!=r?r.success(t):void 0},error:function(i,n){return n.suppressAppMessages=!0,e.length>1&&o.fetchModel(t,_.rest(e),r),e.length<=1?null!=r?r.error(n):void 0:void 0}})},i.prototype.featureBySlug=function(){var t,e,r=this;return t=this.$("li.slug a"),t.hasClass("working")?!1:(t.addClass("working"),this.$("li.slug .error").text(""),e=this.$("input[name=feature_slug]").val(),e&&e.length>0?this.fetchModel(e,[App.Repositories.Artists,App.Repositories.Artworks],{error:function(e){return t.removeClass("working"),r.displayFeatureBySlugError(e)},success:function(e){return $.ajax("/api/v1/post/"+r.postModel.get("id")+"/"+e.modelName+"/"+e.get("id")+"/feature",{type:"POST",success:function(){return r.$("li.slug .error").text(""),r.postModel.set("feature_"+e.modelName+"s",null),r.loadPosts(),t.removeClass("working")},error:function(e){return t.removeClass("working"),r.displayFeatureBySlugError(e)}})}}):void 0)},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.SmallFeedItems=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .feed_item":"feedItem","click a.all":"allFeedItems"},o.prototype.render=function(t){var e,r,o,i,n,s,a,l,p;return null==t&&(t=null!=(e=this.options)?e.posts.first(2):void 0),this.$el.html(JST["templates/feed/small_feed_items"]({posts:t,total_count:null!=(r=this.options)?r.posts.length:void 0,modelName:null!=(o=this.options)?o.modelName:void 0,title:null!=(i=this.options)?i.title:void 0,displayContribute:null!=(n=this.options)?n.displayContribute:void 0,displayProfile:null!=(s=this.options)?s.displayProfile:void 0,displayAttachments:null!=(a=this.options)?a.displayAttachments:void 0,all:null!=(l=this.options)?l.all:void 0})),t.length!==(null!=(p=this.options)?p.posts.length:void 0)&&this.$("a.add_to_post_button").css("float","left"),this.$el.find(".loading").removeClass("loading")},o.prototype.feedItem=function(t){var e;for(e=t.target;!$(e).data("id");)e=$(e).parent();return App.router.navigate("/post/"+$(e).data("id"),{trigger:!0})},o.prototype.allFeedItems=function(){var t;return this.render(null!=(t=this.options)?t.posts.models:void 0),!1},o}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Models.FollowingArtistsPage=function(r){function i(){return this.infiniteScroll=e(this.infiniteScroll,this),this.checkForEmptyList=e(this.checkForEmptyList,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.artistsPerLoad=7,i.prototype.artworksPerPage=15,i.prototype.initialize=function(t){return null!=(null!=t?t.params:void 0)?this.params=$.deparam(t.params):void 0},i.prototype.render=function(){var t;return this.page=0,t=_.map(App.currentUser.get("followArtists").models,function(t){return t.get("artist")}),this.followedArtists=_.sortBy(t,function(t){return t.get("name")}),this.showingArtists=this.followedArtists.slice(0,this.artistsPerLoad),this.$el.html(JST["templates/following/artists"]({artists:this.showingArtists})),this.checkForEmptyList(),this.fillInArtistRows(this.showingArtists),this.renderedAll=this.followedArtists.length<=this.showingArtists.length,this.listenTo(App.currentUser.get("followArtists"),"remove",this.checkForEmptyList),this.renderedAll?void 0:App.$window.bind("scroll.following",_.throttle(this.infiniteScroll,150))},i.prototype.checkForEmptyList=function(){return App.currentUser.get("followArtists").length<1?this.$(".empty_artist_follows").fadeIn().slideDown():this.$(".empty_artist_follows").fadeOut().slideUp()},i.prototype.afterUnload=function(){return App.$window.unbind(".following")},i.prototype.fillInArtistRows=function(t){var e,r=this;if(!_.isEmpty(t))return e=this.$("ul.artists"),_.defer(function(){var o,i,n,s,a;for(a=[],n=0,s=t.length;s>n;n++)i=t[n],o=r.$("li[data-artist="+i.get("id")+"]"),new App.Views.ArtistsListItem({el:o,model:i,parent:e,removeOnUnfollow:!0}),a.push(i.fetchArtworks({pageSize:r.artworksPerPage,page:1}));return a})},i.prototype.infiniteScroll=function(){var t,e,r,o,i,n,s;return o=App.$window.height()+App.$window.scrollTop(),t=this.$("ul.artists > li:last"),o>=(null!=(s=t.offset())?s.top:void 0)+t.height()&&(this.page++,n=this.page*this.artistsPerLoad,r=n+this.artistsPerLoad,i=this.followedArtists.slice(n,r),this.$("ul.artists").append(function(){var t,r,o;for(o=[],t=0,r=i.length;r>t;t++)e=i[t],o.push(JST["templates/artists/artist_row"]({artist:e}));return o}().join("")),this.fillInArtistRows(i),this.renderedAll=this.page+2*this.artistsPerLoad>=this.followedArtists.length,this.renderedAll)?App.$window.unbind(".following"):void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Models.FollowingGenesPage=function(r){function i(){return this.infiniteScroll=e(this.infiniteScroll,this),this.checkForEmptyList=e(this.checkForEmptyList,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.genesPerLoad=7,i.prototype.artworksPerPage=15,i.prototype.initialize=function(t){return null!=(null!=t?t.params:void 0)?this.params=$.deparam(t.params):void 0},i.prototype.render=function(){var t;return this.page=0,t=_.map(App.currentUser.get("followGenes").models,function(t){return t.get("gene")}),this.followedGenes=_.sortBy(t,function(t){return t.get("name")}),this.showingGenes=this.followedGenes.slice(0,this.genesPerLoad),this.$el.html(JST["templates/following/genes"]({genes:this.showingGenes})).hide().fadeIn("fast"),this.checkForEmptyList(),this.fillInGeneRows(this.showingGenes),this.renderedAll=this.followedGenes.length<=this.showingGenes.length,this.listenTo(App.currentUser.get("followGenes"),"remove",this.checkForEmptyList),this.renderedAll?void 0:App.$window.bind("scroll.following",_.throttle(this.infiniteScroll,150))},i.prototype.checkForEmptyList=function(){return App.currentUser.get("followGenes").length<1?this.$(".empty_gene_follows").fadeIn().slideDown():this.$(".empty_gene_follows").fadeOut().slideUp()},i.prototype.afterUnload=function(){return App.$window.unbind(".following")},i.prototype.fillInGeneRows=function(t){var e,r,o,i,n,s;if(!_.isEmpty(t)){for(s=[],i=0,n=t.length;n>i;i++)r=t[i],e=this.$("li[data-gene="+r.get("id")+"]"),o=this.$("ul.genes").get(0),new App.Views.GenesListItem({el:e.length>0?e.get(0):void 0,model:r,parent:o,removeOnUnfollow:!0}),s.push(r.fetchArtworks({pageSize:this.artworksPerPage,page:1}));return s}},i.prototype.infiniteScroll=function(){var t,e,r,o,i,n;return r=App.$window.height()+App.$window.scrollTop(),t=this.$("ul.genes > li:last"),r>=(null!=(n=t.offset())?n.top:void 0)+t.height()&&(this.page++,i=this.page*this.genesPerLoad,e=i+this.genesPerLoad,o=this.followedGenes.slice(i,e),this.fillInGeneRows(o),this.renderedAll=this.page+2*this.genesPerLoad>=this.followedGenes.length,this.renderedAll)?App.$window.unbind(".following"):void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FollowingIndex=function(r){function i(){return this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="following",i.prototype.el="#following",i.prototype.frameName="following",i.prototype.frameTitle="Following",i.prototype.initialize=function(){var t=this;return window.scrollTo(0,0),App.currentUser.ensureFollowGenes(function(){return App.currentUser.ensureFollowArtists(function(){return t.listenTo(App.currentUser.get("followArtists"),"add",t.render),t.listenTo(App.currentUser.get("followGenes"),"add",t.render),t.render()})})},i.prototype.onLoad=function(){return this.render()},i.prototype.render=function(){var t;if(App.currentFrameName===this.frameName)return this.$el.html(JST["templates/following/index"]()).hide().fadeIn("fast"),this.$follows=this.$(".follows"),this.followingArtistsPage&&this.followingArtistsPage.setElement(this.$follows),this.followingGenesPage&&this.followingGenesPage.setElement(this.$follows),this.tabs=new App.Views.Tabs({el:this.$(".tabs")}),this.listenTo(this.tabs,"tabChange",this.swapView),this.tabs.selectTab(null!=(null!=(t=this.options)?t.type:void 0)?this.options.type:"artists")},i.prototype.swapView=function(t){return App.router.navigate("/following/"+t,{trigger:!1}),"artists"===this.tabs.activeTab?(this.followingArtistsPage||(this.followingArtistsPage=new App.Models.FollowingArtistsPage({el:this.$follows})),this.followingArtistsPage.render()):"genes"===this.tabs.activeTab&&(this.followingGenesPage||(this.followingGenesPage=new App.Models.FollowingGenesPage({el:this.$follows})),this.followingGenesPage.render()),!1},i}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedArtists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.InitializeArtists),o.prototype.key="homepage:featured-artists",o.prototype.maxItemsPerFeature=4,o.prototype.template="templates/home/featured_artists",o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedArtworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.InitializeArtworks),o.prototype.key="homepage:featured-artworks",o.prototype.maxItemsPerFeature=4,o.prototype.template="templates/features/featured_artworks",o.prototype.events={"click .artwork":"onClickArtwork"},o.prototype.render=function(t){return o.__super__.render.apply(this,arguments),this.initializeArtworks(t.get("items").models)},o.prototype.onClickArtwork=function(){return Analytics.click("Clicked featured artwork")},o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedLinks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.key="homepage:featured-links",o.prototype.maxItemsPerFeature=7,o.prototype.template="templates/home/featured_links",o.prototype.setWidth=function(){},o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedSections=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.InitializeSections),o.prototype.key="homepage:featured-sections",o.prototype.maxItemsPerFeature=4,o.prototype.template="templates/home/featured_sections",o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.FeaturedShows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.FixedDimensionsThumbnails),o.prototype.key="homepage:featured-shows",o.prototype.maxItemsPerFeature=10,o.prototype.template="templates/features/featured_shows",o.prototype.render=function(){var t=this;return o.__super__.render.apply(this,arguments),this.$el.imagesLoaded(function(){return t.setupFixedDimensionsThumbnails()})},o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.HeroUnit=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),this.updateLink=e(this.updateLink,this),this.visitHeroLink=e(this.visitHeroLink,this),this.checkHeader=e(this.checkHeader,this),this.displayHeroUnit=e(this.displayHeroUnit,this),this.render=e(this.render,this),this.showHeroUnitClick=e(this.showHeroUnitClick,this),this.prevHeroUnit=e(this.prevHeroUnit,this),this.nextHeroUnit=e(this.nextHeroUnit,this),this.afterCoverImageLoadcont=e(this.afterCoverImageLoadcont,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.CoverArt),i.prototype.defaultHeaderClass="transparent",i.prototype.carouselInterval=1e4,i.prototype.getCoverHeight=function(){return 470},i.prototype.afterCoverImageLoadcont=function(){return this.$(".cover_art img").addClass("visible")},i.prototype.events={"click .cover_art, .responsive_container, .link a":"visitHeroLink","click .left":"prevHeroUnitClick","click .right":"nextHeroUnitClick","click .dot":"showHeroUnitClick"},i.prototype.nextHeroUnitClick=function(){return this.carouselInterval=null,this.nextHeroUnit()},i.prototype.prevHeroUnitClick=function(){return this.carouselInterval=null,this.prevHeroUnit()},i.prototype.nextHeroUnit=function(){return this.displayHeroUnit(this.getInactiveHeroUnitForIndex(_.indexOf(this.heroUnits.models,this.currentHeroUnit)+1))},i.prototype.prevHeroUnit=function(){return this.displayHeroUnit(this.getInactiveHeroUnitForIndex(_.indexOf(this.heroUnits.models,this.currentHeroUnit)-1))},i.prototype.showHeroUnitClick=function(t){return this.displayHeroUnit(this.getInactiveHeroUnitForIndex(this.$(".dot").index($(t.target))))},i.prototype.initialize=function(){var t=this;return this.$coverArt=this.$el,App.Repositories.HeroUnits.getFromUrl("/api/v1/site_hero_units?enabled=true&desktop=true",{success:function(e){return t.heroUnits=e,t.render()}})},i.prototype.render=function(){var t;return(null!=(t=this.heroUnits.models)?t.length:void 0)?(this.$header=App.$body.addClass("hero_visible").find("header.app"),this.displayHeroUnit(this.getInactiveHeroUnitForIndex())):this.remove()},i.prototype.getInactiveHeroUnitForIndex=function(t){var e,r;return null==t&&(t=0),0>t&&(t=this.heroUnits.length-1),e=this.heroUnits.models[t]||this.heroUnits.models[0],e.get("id")!==(null!=(r=this.currentHeroUnit)?r.get("id"):void 0)?e:void 0},i.prototype.destroyCurrentHeroUnit=function(){return App.$window.off(".hero"),clearTimeout(this.carouselTimeout),this.destroyCoverArt()},i.prototype.displayHeroUnit=function(t){var e,r;if(t&&!this.animating)return $(".hero").hide(),this.animating=!0,this.rendered&&this.destroyCurrentHeroUnit(),this.currentHeroUnit&&(null!=(e=this.$header)&&e.removeClass(this.getHeaderClass(this.currentHeroUnit)),this.$el.removeClass(this.currentHeroUnit.get("type")),this.$el.removeClass(this.currentHeroUnit.get("menu_color_class"))),this.currentHeroUnit=t,null!=(r=App.publicHeader)&&r.close(!0),this.$header.addClass(this.getHeaderClass(this.currentHeroUnit)),this.$el.html(JST["templates/hero_unit/show"]({hero:this.currentHeroUnit})),App.$window.on("scroll.hero",_.throttle(this.checkHeader,20)),this.renderCoverArt(),this.$el.addClass(this.currentHeroUnit.get("type")),this.$el.addClass(this.currentHeroUnit.get("menu_color_class")),this.checkHeader(),this.setLinkHoverColor(this.currentHeroUnit),this.heroUnits.models.length>1&&this.displayHeroUnitsToggle(),this.startHeroCarousel(),this.animating=!1,this.rendered=!0
},i.prototype.displayHeroUnitsToggle=function(){return App.$body.addClass("multiple_hero_visible"),this.$el.append(JST["templates/hero_unit/toggle"]({heroUnits:this.heroUnits.models})),this.$(".dot:eq("+this.heroUnits.models.indexOf(this.currentHeroUnit)+")").addClass("selected")},i.prototype.checkHeader=function(t){var e,r;return null==t&&(t=!1),e=App.$window.scrollTop(),r=e>=this.getCoverHeight()+40,r&&(this.lastScrolledPast||t)?(this.$header.removeClass(this.getHeaderClass(this.currentHeroUnit)),clearTimeout(this.carouselTimeout)):r||!this.lastScrolledPast&&!t||(this.startHeroCarousel(),this.$header.addClass(this.getHeaderClass(this.currentHeroUnit))),this.lastScrolledPast=r},i.prototype.visitHeroLink=function(){var t;return this.$(".link a").text("Loading"),(null!=(t=this.currentHeroUnit.get("link"))?t.indexOf("http"):void 0)<1?window.location=this.currentHeroUnit.get("link"):App.router.navigate(this.currentHeroUnit.get("link"),{trigger:!0})},i.prototype.updateLink=function(){var t;return t=this.$(".link a"),t.removeClass("loading"),null!=this.currentHeroUnit?t.text(this.currentHeroUnit.get("link_text")):void 0},i.prototype.getHeaderClass=function(t){var e;return e=null!=t?t.get("menu_color_class"):void 0,this.defaultHeaderClass+(e?" "+e:"")},i.prototype.setLinkHoverColor=function(t){var e,r;return r=null!=t?t.get("link_color_hover_hex"):void 0,e=null!=t?t.get("link_color_off_hex"):void 0,r&&e?this.$(".link a").hover(function(){return $(this).css("color","#"+r)},function(){return $(this).css("color","#"+e)}):void 0},i.prototype.startHeroCarousel=function(){var t;if((null!=(t=this.heroUnits)?t.models.length:void 0)>1&&this.carouselInterval)return clearTimeout(this.carouselTimeout),this.carouselTimeout=setTimeout(this.nextHeroUnit,this.carouselInterval)},i.prototype.onLoad=function(){var t,e=this;if(null!=(t=this.heroUnits.models)?t.length:void 0)return App.$window.on("scroll.hero",this.checkHeader),_.defer(function(){return e.updateLink(),e.checkHeader(!0),e.$coverArt.heroUnit("render")})},i.prototype.onUnload=function(){var t,e,r=this;if(null!=(t=this.heroUnits)?null!=(e=t.models)?e.length:void 0:void 0)return App.$window.off(".hero"),clearTimeout(this.carouselTimeout),_.defer(function(){var t;return null!=(t=r.$header)?t.removeClass(r.getHeaderClass(r.currentHeroUnit)):void 0})},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.HomeIndex=function(r){function i(){return this.renderHeroUnits=e(this.renderHeroUnits,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="home",i.prototype.el="#home",i.prototype.frameName="home",i.prototype.frameTitle="Home",i.prototype.rendered=!1,i.prototype.render=function(){return this.$el.html(JST["templates/home/index"]()).show(),this.renderHeroUnits(),this.renderFeaturedSections(),this.renderFeaturedLinks(),this.renderArtworks(),this.renderFeaturedArtists(),this.renderFeaturedShows(),this.rendered=!0,$("header").removeClass("hidden"),$("body").removeClass("hide_nav"),this},i.prototype.onLoad=function(){var t,e;return null!=(t=this.partnerShows)&&t.onLoad(),null!=(e=this.hero)?e.onLoad():void 0},i.prototype.onUnload=function(){var t;return $("header .artsy").removeClass("on"),null!=(t=this.hero)?t.onUnload():void 0},i.prototype.renderFeaturedShows=function(){return this.featuredShows||(this.featuredShows=new App.Views.Home.FeaturedShows({el:this.$(".homepage_featured_shows")}))},i.prototype.renderHeroUnits=function(){return this.hero||(this.hero=new App.Views.HeroUnit({el:this.$(".hero")}))},i.prototype.renderFeaturedSections=function(){var t,e;return this.featuredSections||(this.featuredSections=new App.Views.Home.FeaturedSections({el:this.$(".homepage_featured_sections"),width:null!=(t=this.partnerShows)?null!=(e=t.feed)?e.fixedWidth:void 0:void 0}))},i.prototype.renderArtworks=function(){var t;return t=App.currentUser,t&&t.hasLabFeature("Suggested Artworks")?this.renderSuggestedArtworks():this.renderFeaturedArtworks()},i.prototype.renderFeaturedArtworks=function(){var t,e;return this.featuredArtworks||(this.featuredArtworks=new App.Views.Home.FeaturedArtworks({el:this.$(".homepage_featured_artworks"),width:null!=(t=this.partnerShows)?null!=(e=t.feed)?e.fixedWidth:void 0:void 0}))},i.prototype.renderSuggestedArtworks=function(){var t,e;return this.featuredArtworks||(this.featuredArtworks=new App.Views.Home.SuggestedArtworks({el:this.$(".homepage_featured_artworks"),width:null!=(t=this.partnerShows)?null!=(e=t.feed)?e.fixedWidth:void 0:void 0}))},i.prototype.renderFeaturedLinks=function(){return this.featuredLinks||(this.featuredLinks=new App.Views.Home.FeaturedLinks({el:this.$(".homepage_featured_links")}))},i.prototype.renderFeaturedArtists=function(){return this.featuredArtists||(this.featuredArtists=new App.Views.Home.FeaturedArtists({el:this.$(".homepage_featured_artists")}))},i.prototype.showLoading=function(){return this.$el.addClass("loading")},i.prototype.hideLoading=function(){var t=this;return $(".loading_message").fadeOut("slow",function(){return t.$el.removeClass("loading")})},i.prototype.isRendered=function(){return this.rendered},i.prototype.remove=function(){return $("header .artsy").removeClass("on"),this.$el.hide()},i}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.RedirectDialog=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.id="redirect_modal",o.prototype.el="#redirect_modal",o.prototype.handle="redirect",o.prototype.width=function(){return 700},o.prototype.events={"click .ui-dialog-titlebar-close, button":"hide"},o.prototype.render=function(){var t,e=this;return t=App.readCookie("redirect_dialog_shown"),t||App.IS_MOBILE?void 0:(this.$el.html(JST["templates/shared/redirect_modal"]()),this.show(),this.handleLargePopovers(),_.defer(function(){return e.$el.show().find(".ui-dialog").show(),e.$background.show(),App.createCookie("redirect_dialog_shown",!0)}))},o.prototype.handleLargePopovers=function(){var t;return t=App.$window.height()-200,this.$el.css({"max-height":""+t+"px"})},o}(App.Views.ModalDialog)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Home.SuggestedArtworks=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.InitializeArtworks),o.prototype.maxItemsPerFeature=4,o.prototype.template="templates/home/suggested_artworks",o.prototype.initialize=function(){var t,e=this;return t=App.Repositories.SuggestedArtworks.fetchItems(),t.then(function(t){return e.render(t)}),t.fail(function(){return e.remove()})},o.prototype.render=function(t){var e=this;return t.models.length>0?(this.$el.html(JST[this.template]({artworks:t})),this.options.width&&this.setWidth(this.options.width),this.$el.imagesLoaded(function(){return e.$("img").removeClass("loading")}),this.initializeArtworks(t.models)):this.remove()},o}(App.Views.Home.FeaturedSet)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.InvitationView=function(r){function i(){return this.revealError=e(this.revealError,this),this.clearErrors=e(this.clearErrors,this),this.revealErrors=e(this.revealErrors,this),this.hasErrors=e(this.hasErrors,this),this.focus=e(this.focus,this),this.updateModel=e(this.updateModel,this),this.render=e(this.render,this),this.useMailcheckSuggestion=e(this.useMailcheckSuggestion,this),this.mailCheck=e(this.mailCheck,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tagName="li",i.prototype.events={"change .invitation_email":"updateModel","blur .invitation_email":"mailCheck","click .mailcheck":"useMailcheckSuggestion"},i.prototype.mailCheck=function(t){var e,r=this;return $(t.target).val(null!=(e=$(t.target).val())?e.trim():void 0),$(t.target).mailcheck({domains:Mailcheck.domains,suggested:function(t,e){var o;return(null!=(o=r.emailSuggestion)?o.full:void 0)!==e.full?(r.clearErrors(),r.emailSuggestion=e,r.$(".mailcheck").hide().html("Did you mean <em><u>"+html_escape(e.full)+"</u></em>?").fadeIn(250)):void 0},empty:function(){return r.emailSuggestion=null,r.$(".mailcheck").fadeOut(250)}})},i.prototype.useMailcheckSuggestion=function(){return null!=this.emailSuggestion?(this.$(".invitation_email").val(this.emailSuggestion.full),this.$(".mailcheck").fadeOut(250)):void 0},i.prototype.render=function(){return this.$el.html(JST["templates/invitations/inputs"]()),this.$(".invitation_email").artsyplaceholder("Email"),this.$(".invitation_email").val(this.model.get("email"))},i.prototype.updateModel=function(){return this.model.set({email:this.$(".invitation_email").val()},{silent:!0})},i.prototype.focus=function(){return this.$(".invitation_email").focus()},i.prototype.hasErrors=function(t,e){var r;return r=e||(t||this.model).errors,r&&this.model.get("name")||this.model.get("email")?!0:void 0},i.prototype.revealErrors=function(t,e){this.clearErrors(),(this.model.get("name")||this.model.get("email"))&&_.each(e||(t||this.model).errors,this.revealError,this)},i.prototype.clearErrors=function(){return this.$(".mailcheck").hide(),this.$(".invitation_email_msg").hide()},i.prototype.revealError=function(t,e){return this.$(".invitation_"+e+"_msg").html(t).show()},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.InvitationNew=function(r){function i(){return this.disableLoading=e(this.disableLoading,this),this.enableLoading=e(this.enableLoading,this),this.submit=e(this.submit,this),this.showMessage=e(this.showMessage,this),this.hasErrors=e(this.hasErrors,this),this.revealError=e(this.revealError,this),this.revealErrors=e(this.revealErrors,this),this.clearErrors=e(this.clearErrors,this),this.afterLoad=e(this.afterLoad,this),this.removeInvitation=e(this.removeInvitation,this),this.addInvitation=e(this.addInvitation,this),this.newInvitation=e(this.newInvitation,this),this.render=e(this.render,this),this.initialize=e(this.initialize,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="invitation_new",i.prototype.el="#invitation_new",i.prototype.frameName="invite",i.prototype.views=[],i.prototype.events={"click #invitation_submit":"submit","click #add_invitation":"newInvitation","keydown .invitation_email":"emailKeyDown"},i.prototype.initialize=function(){var t=this;return this.$el.html(JST["templates/invitations/new"]({invitations:this.model})),this.$("#invitation_email_form").bind("submit",function(){return t.submit()}),this.submitButton=this.$("#invitation_submit"),this.addInvitationButton=this.$("#add_invitation"),this.invitationCount=this.$(".invitation_count"),this.model=new App.Collections.Invitations,this.model.bind("add",this.addInvitation,this),this.model.bind("reset",this.render)},i.prototype.render=function(){var t,e,r,o;if(this.$el.show(),this.$("#invitation_inputs li").length!==this.model.unsent().length)for(this.$("#invitation_inputs").html(""),o=this.model.unsent(),e=0,r=o.length;r>e;e++)t=o[e],this.addInvitation(t);return this.afterLoad()},i.prototype.newInvitation=function(){return this.model.add(new App.Models.Invitation),!1},i.prototype.addInvitation=function(t){var e;return e=new App.Views.InvitationView({model:t}),this.views.push(e),e.render(),e.$el.appendTo(this.$("#invitation_inputs")),this.addInvitationButton.css({visibility:""}).fadeIn("slow")},i.prototype.removeInvitation=function(t){var e;return e=_.find(this.views,function(e){return e.model===t}),this.views=_.without(this.views,e),e.remove()},i.prototype.emailKeyDown=function(t){return t.which===$.ui.keyCode.ENTER&&this.submit(),!0},i.prototype.afterLoad=function(){return this.views[0].focus()},i.prototype.clearErrors=function(){return this.$el.removeClass("errors"),this.$(".invitation_collection_msg").html("").hide(),this.submitButton.removeClass("error")},i.prototype.revealErrors=function(){var t,e,r,o,i=this;for(this.clearErrors(),this.$el.addClass("errors"),this.submitButton.addClass("error"),_.each(this.model.errors,this.revealError,this),o=this.views,e=0,r=o.length;r>e;e++)t=o[e],t.revealErrors();return window.setTimeout(function(){return i.submitButton.removeClass("error")},1500)},i.prototype.revealError=function(t,e){return this.$(".invitation_"+e+"_msg").html(html_escape(t)).show()},i.prototype.hasErrors=function(){return _.filter(this.views,function(t){return t.hasErrors()}).length>0},i.prototype.showMessage=function(t){return t.justSent().length>0?App.showMessage(""+t.justSent().length+" "+(1===t.justSent().length?"Invite":"Invites")+" sent. "):void 0},i.prototype.submit=function(){var t,e,r,o,i=this;if(!this.$("#invitation_submit").hasClass("loading")){for(this.enableLoading(),this.clearErrors(),o=this.views,e=0,r=o.length;r>e;e++)t=o[e],t.updateModel();return this.model.save({success:function(t){var e,r,o,n;for(i.showMessage(t),n=t.justSent(),r=0,o=n.length;o>r;r++)e=n[r],i.removeInvitation(e);return i.submitButton.addClass("success"),window.setTimeout(function(){return i.submitButton.removeClass("success")},1500),i.hasErrors()?i.revealErrors():i.clearErrors(),i.scrollToTop(),Analytics.funnel("Sent invitations"),i.disableLoading()},error:function(){return i.revealErrors(),i.scrollToTop(),i.disableLoading()}}),!1}},i.prototype.enableLoading=function(){return this.$("#invitation_submit").addClass("loading")},i.prototype.disableLoading=function(){return this.$("#invitation_submit").removeClass("loading")},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.LabFeaturesIndex=function(r){function i(){return this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="labs_list",i.prototype.events={"change .lab_feature .toggle select":"toggled"},i.prototype.initialize=function(){return this.dirty=!1,this.model.fetch({success:this.render})},i.prototype.render=function(){return this.$el.html(JST["templates/lab_features/index"]({features:this.model.get("features")})),this.$("div.toggle").toggler(),this.options.parent.render(this.$el),this.$el.fadeIn()},i.prototype.toggled=function(t){return this.dirty=!0,this.model.toggle({id:$(t.target).data("feature"),enable:"on"===t.target.value,failure:function(e){return $(t.target).parent()[0].rollback(e)}})},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.LabsDialog=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.id="labs_modal",o.prototype.el="#labs_modal",o.prototype.handle="labs",o.prototype.width=function(){return 700},o.prototype.events={"click .ui-dialog-titlebar-close":"hide"},o.prototype.initialize=function(){return this.index=new App.Views.LabFeaturesIndex({model:this.model,parent:this})},o.prototype.render=function(t){var e=this;return this.$el.html(t),this.show(),this.handleLargePopovers(),_.defer(function(){return e.$el.show().find(".ui-dialog").show()})},o.prototype.handleLargePopovers=function(){var t;return t=App.$window.height()-200,this.$el.css({"max-height":""+t+"px"})},o}(App.Views.ModalDialog)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.AppMessage=function(r){function i(){return this.dismiss=e(this.dismiss,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="app_message",i.prototype.defaultTop=50,i.prototype.messageActivator="app_message",i.prototype.events={"click a.slum_stop":"slum","click a.close":"dismissEvent","click a.stop_impersonating":"stopImpersonating"},i.prototype.initialize=function(){var t;return this.$parent=App.isAdmin?$("header"):$("header.app"),null!=(t=App.router)?t.on("all",this.dismiss):void 0},i.prototype.render=function(t,e,r,o,i){var n=this;if(null==o&&(o=""),this.bodyCssClass=this.messageActivator+(o?" "+o:""),this.$el.html(JST["templates/shared/app_message"]({message:t})),this.$parent.after(this.$el),this.$el.removeClass().addClass(r),_.defer(function(){return App.$body.addClass(n.bodyCssClass)}),this.delegateEvents(),e&&_.delay(this.dismiss,3e3),i){if(App.IS_MOBILE)return;this.$header=$("header.app"),this.postTop=60,App.$window.on("scroll.message",_.throttle(function(){return n.scrollHide()},50)),this.scrollHide()}return _.defer(function(){return n.visible=!0}),this},i.prototype.isVisible=function(){return this.visible},i.prototype.slum=function(t){return App.header.slum(t)},i.prototype.stopImpersonating=function(t){return App.header.stopImpersonating(t)},i.prototype.dismissEvent=function(t){return t.preventDefault(),t.stopPropagation(),this.dismiss()},i.prototype.dismiss=function(){var t=this;if(this.visible)return App.$body.hasClass(this.messageActivator)&&App.$body.removeClass(this.bodyCssClass),App.$window.off(".message"),_.delay(function(){var e,r;return t.$el.unbind(".delegateEvents"+t.cid),null!=t.$el&&t.defaultTop&&((null!=(r=t.$header)?r.length:void 0)>0&&t.$header.css({top:0}),"function"==typeof(e=t.$el).top&&e.top(t.defaultTop)),t.remove()},1e3),this.visible=!1,!1},i.prototype.scrollHide=function(){var t,e;return t=this.defaultTop-App.$window.scrollTop(),t>this.defaultTop||-500>t?void 0:(t=0>t?0:t,(null!=(e=this.$header)?e.length:void 0)>0&&this.$header.css({top:t}),$("#post_dialog").length>0?$("#post_dialog").css({top:t+this.postTop}):void 0)},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FeedbackDialog=function(r){function i(){return this.submitFeedbackForm=e(this.submitFeedbackForm,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.width=function(){return 500},i.prototype.handle="feedback",i.prototype.onShow=function(){var t;return this.$el.html(JST["templates/feedback/dialog"]()),App.$body.removeClass("feedback_submitted"),this.$("textarea").val(""),this.$("input[type=hidden]").val((null!=(t=this.options)?t.url:void 0)||window.location.href),App.isLoggedIn()?this.$("textarea").focus():this.$('input[name="feedback[user_name]"]').focus(),this.$(".button").bind("click",this.submitFeedbackForm)},i.prototype.submitFeedbackForm=function(){var t,e=this;return t={user_name:this.$('input[name="feedback[user_name]"]').val(),user_email:this.$('input[name="feedback[user_email]"]').val(),message:this.$("textarea").val(),url:this.$("input[type=hidden]").val()},t.message?(new App.Models.Feedback).save(t,{success:function(){return App.$body.addClass("feedback_submitted"),e.hide(),Analytics.funnel("Submitted feedback form")}}):!1},i}(App.Views.ModalDialog)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Footer=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="footer.app",o.prototype.events={"click a.feedback":"showFeedbackForm"},o.prototype.showFeedbackForm=function(){return this.dialog||(this.dialog=new App.Views.FeedbackDialog({el:$("#feedback_modal")})),this.dialog.show(),!1},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Header=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="header.app",o.prototype.events={"click li.artsy a":"artsyClick","click li.log_in a":"loginClick","click li.sign_up a":"signupClick","click li.user > a":"userClick","click #user_nav ul":"hideUserNav","mouseenter li.user":"showUserNav","mouseenter #user_nav":"userNavEnter","mouseleave #user_nav":"hideUserNav",mouseleave:"hideUserNav","click a.labs":"labs","click a.slum_start":"slum","click a.slum_end":"slum","mouseenter li.search":"fitSearchToViewport","focus li.search input":"fitSearchToViewport","click a.logout":"logout"},o.prototype.widthOffset=42,o.prototype.minSearchTipWidth=380,o.prototype.minSearchWidth=80,o.prototype.minWidth=480,o.prototype.initialize=function(){return App.currentUser.accountCreated()&&(this.postButtonView=new App.Views.PostDialogButton({el:this.$("li.post")}),this.widthOffset=45),this.render()},o.prototype.render=function(){var t=this;return App.$window.unbind(".header"),this.searchInput=this.$el.find("li.search input"),this.searchFocus=this.$el.find("#search_focus"),this.$userNav=this.$("#user_nav"),null!=App.currentProfile&&App.currentUser.accountCreated()&&new App.Views.ProfileShowNavItem({el:this.$userNav.find("div.user"),userNavItem:this.$("ul.right li.user")}),App.currentUser.accountCreated()&&(this.updateUser(),App.currentUser.bind("change:name",function(){return t.updateUser()})),_.defer(function(){return t.setupLayoutUpdateHandler()})},o.prototype.setupLayoutUpdateHandler=function(){var t,e,r=this;return e=function(){return r.fitSearchToViewport(),r.makeHeaderItemActive()},App.router.on("all",e),App.$body.on("overflowUpdate",e),t=_.debounce(function(){return r.fitSearchToViewport()},App.WINDOW_DEBOUNCE_TIME),App.$window.on("resize.header",t),this.fitSearchToViewport(),this.makeHeaderItemActive()},o.prototype.setWidths=function(){var t,e,r;return r=this.widthOffset,t={},this.$("ul.nav li:visible").each(function(){return $(this).hasClass("search")?void 0:(r+=$(this).width(),t[$(this).attr("class")]=$(this).width())}),e=_.reduce(t,function(t,e){return t+e},this.widthOffset),this.$el.css({"min-width":e>this.minWidth?e:this.minWidth}),r},o.prototype.makeHeaderItemActive=function(){var t,e;switch(App.$body.hasClass("hero_visible")||this.$("li.artsy.on").removeClass("on"),this.$("li.active").removeClass("active"),App.router.currentRoute){case"home":this.$("li.artsy").addClass("on");break;case"login":App.$body.hasClass("hero_visible")&&this.$("li.artsy").addClass("on");break;case"signup":App.$body.hasClass("hero_visible")&&this.$("li.artsy").addClass("on");break;case"browse":this.$("li.browse").addClass("active");break;case"partners":this.$("li.partners").addClass("active");break;case"filterArtworks":this.$("li.filter").addClass("active");break;case"posts":this.$("li.posts").addClass("active");break;case"about":this.$("li.about").addClass("active");break;case"userEdit":case"userDelete":this.$("li.user, li.user_edit").addClass("active");break;case"invite":this.$("li.user, li.invite").addClass("active");break;case"profileEdit":this.$("li.user, li.profile_edit").addClass("active")}return"thearmoryshow"===(null!=(t=App.router.viewState.frames[App.currentFrameName])?null!=(e=t.params)?e.profileId:void 0:void 0)?this.$("li.armory_show").addClass("active"):void 0},o.prototype.fitSearchToViewport=function(){var t,e,r,o;return r=this.setWidths(),o=App.IS_PHONE?this.$el.width():App.$window.width(),e=o-r,t=e<this.minSearchTipWidth?this.minSearchTipWidth:e,e<this.minSearchWidth&&(e=this.minSearchWidth),this.searchFocus.width(t+7),this.searchInput.width(e),$("header .nav li.artsy").hasClass("on")&&(this.searchInput.css({width:"-=1px"}),this.searchFocus.css({width:"+=0px"})),$("header .nav li.browse").hasClass("on")&&(this.searchInput.css({width:"-=5px"}),this.searchFocus.css({width:"-=5px"})),$("header .nav li.collections").hasClass("on")?(this.searchInput.css({width:"-=5px"}),this.searchFocus.css({width:"-=5px"})):void 0},o.prototype.updateUser=function(){return this.$("li.user a, #user_nav .user").html(App.currentUser.get("name")||"Account"),App.currentUser.get("is_slumming")&&this.$(".slum").show(),App.currentUser.isAdmin()&&this.$(".cms, .non_admin, .torque, .labs").show(),App.currentUser.get("has_partner_access")&&this.$(".cms").show(),this.fitSearchToViewport()},o.prototype.loginClick=function(){return"/"!==window.location.pathname&&(App.router.setRedirectUrl(window.location.pathname),App.router.navigate("log_in")),App.loginSignupDialog.showLoginForm(),_.defer(App.loginSignupDialog.show),!1},o.prototype.signupClick=function(){return App.loginSignupDialog.showSignupForm(),_.defer(App.loginSignupDialog.show),!1},o.prototype.artsyClick=function(){return Analytics.click("Clicked home icon"),"home"===App.currentFrameName?$("html, body").animate({scrollTop:0}):App.router.navigate("",{trigger:!0}),!1},o.prototype.userClick=function(){return this.$userNav.css("left",this.$("li.user").offset().left),this.$userNav.is(":visible")?this.$userNav.fadeIn():this.$userNav.fadeOut(),!1},o.prototype.labs=function(){return this.labsDialog||(this.labsDialog=new App.Views.LabsDialog({model:new App.Models.LabFeatures})),this.labsDialog.show(),!1},o.prototype.showUserNav=function(){return Analytics.hover("Hovered over user dropdown"),this.$userNav.show()},o.prototype.userNavEnter=function(){return"profileShow"!==App.currentFrameName?$("li.user.active").removeClass("active"):void 0},o.prototype.hideUserNav=function(){return this.$userNav.hide(),App.router.currentRoute.match(/following|userEdit|invite|user/)?this.$("li.user").addClass("active"):void 0},o.prototype.slum=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=$(t.target).hasClass("slum_start")?"post":"delete",$.ajax({type:e,url:"/api/v1/me/slum",success:function(){return window.location.reload(!0)},error:function(t){return alert(t.statusText)}}),!1},o.prototype.stopImpersonating=function(t){return t.preventDefault(),t.stopPropagation(),window.location.href="/stop_impersonating"},o.prototype.logout=function(t){return t.preventDefault(),this.redirectToSignOutUrl()},o.prototype.redirectToSignOutUrl=function(){return window.location="/users/sign_out"},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PublicHeader=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="header.app",o.prototype.events={"click .log_in":"loginRedirect","click .center a":"splashRedirect"},o.prototype.splashRedirect=function(){return window.location="/",!1},o.prototype.loginRedirect=function(){return window.location="/log_in?redirect_uri="+window.location.pathname,!1},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PageFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.id="static_pages",o.prototype.el="#static_pages",o.prototype.frameName="page",o.prototype.load=function(){return this.render()},o.prototype.render=function(){var t,e=this;return $("#static_pages > .page").hide(),t=$("#static_pages ."+this.options.pageId),0===t.length?App.Repositories.Pages.getOrFetch(this.options.pageId,["id","content","name"],{success:function(t){var r;return r=$(JST["templates/pages/show"]({page:t})),e.$el.hide().append(JST["templates/pages/show"]({page:t})).fadeIn("slow")}}):(t.show(),this.$el.fadeIn("slow"))},o.prototype.setDocumentTitle=function(){return App.Repositories.Pages.getOrFetch(this.options.pageId,["name"],{success:function(t){return App.$document.attr("title",_.htmlDecode(""+_.capitalize(t.get("name"))+" | Artsy"))}})},o}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerArtistsGrid=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.headings={singleSection:"Artists",represented:"Represented Artists",worksAvailable:"Works Available By"},o.prototype.initialize=function(){return this.partner=this.model.get("owner"),this.render()},o.prototype.render=function(){var t;return this.renderWorks({$el:this.$(".represented_artists"),partnerArtists:this.partner.get("representedArtists"),heading:this.headings.represented,baseUrl:this.options.baseUrl}),this.renderWorks({$el:this.$(".works_available_by_artists"),partnerArtists:this.partner.get("nonRepresentedArtists"),heading:0===(null!=(t=this.partner.get("representedArtists"))?t.length:void 0)?this.headings.singleSection:this.headings.worksAvailable,baseUrl:this.options.baseUrl})},o.prototype.renderWorks=function(t){return 0===t.partnerArtists.length?t.$el.remove():t.$el.html(JST["templates/profiles/partner/_artists_grid"]({partnerArtists:t.partnerArtists.models,heading:t.heading,baseUrl:t.baseUrl}))},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerArtistsList=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.headings={singleSection:"Artists",represented:"Represented Artists",worksAvailable:"Works Available By"},o.prototype.baseUrl="/artist",o.prototype.initialize=function(){return this.options.baseUrl&&(this.baseUrl=this.options.baseUrl),this.partner=this.model.get("owner"),this.render()},o.prototype.render=function(){var t,e,r,o,i,n,s,a,l,p,u,h,c,d,f;return u=null!=(d=this.partner.get("representedArtists"))?d.length:void 0,s=null!=(f=this.partner.get("nonRepresentedArtists"))?f.length:void 0,a=Math.ceil((u+s)/6),l=u>s,p=this.partner.get("representedArtists").models,n=this.partner.get("nonRepresentedArtists").models,h=p,r=n,i=[],i.push(Math.round(u/a)),i.push(6-i[0]),i.sort(),0===i[0]&&0!==h.length&&(i=[1,5]),t=this.$(".works_available"),e=this.$(".represented"),o=this.headings.worksAvailable,c=this.headings.represented,0===p.length&&(o=this.headings.singleSection),l&&(t=this.$(".represented"),e=this.$(".works_available"),o=this.headings.represented,c=this.headings.worksAvailable,r=h,h=n),0===Math.min(u,s)?(t.addClass("full"),e.hide(),t.html(JST["templates/partner_artists/_list"]({heading:o,artistGroups:this.getModelGroups(r,6),artistBaseUrl:this.baseUrl}))):(i===[2,4]&&(t.addClass("large"),e.addClass("small")),i===[3,3]&&(t.addClass("half"),e.addClass("half")),i===[1,5]&&(t.addClass("xlarge"),e.addClass("xsmall")),e.html(JST["templates/partner_artists/_list"]({heading:c,artistGroups:this.getModelGroups(h,i[0]),artistBaseUrl:this.baseUrl})),t.html(JST["templates/partner_artists/_list"]({heading:o,artistGroups:this.getModelGroups(r,i[1]),artistBaseUrl:this.baseUrl})))},o.prototype.getModelGroups=function(t,e){var r;return r=Math.ceil(t.length/e),_.toArray(_.groupBy(t,function(t,e){return Math.floor(e/r)}))},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PartnerArtist=function(r){function i(){return this.onFollowChange=e(this.onFollowChange,this),t=i.__super__.constructor.apply(this,arguments)
}return o(i,r),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via partner profile page",i.prototype.analyticsSaveMessage="Added artwork to collection, via partner profile page",i.prototype.events={"click .follow a":"followArtist","click .following a":"unfollowArtist","mouseenter .following a":"followingEnter","mouseleave .following a":"followingLeave","click .see_more button":"seeMore"},i.prototype.followingEnter=function(t){return $(t.target).addClass("over").text("Unfollow")},i.prototype.followingLeave=function(t){return $(t.target).removeClass("over").text("Following")},i.prototype.initialize=function(){return this.onLoad()},i.prototype.onLoad=function(){var t=this;if(this.options.modelId||this.model)if(null==this.model&&(this.model=new App.Models.Artist({id:this.options.modelId})),this.model.has("blurb")){if(!this.rendered)return this.render()}else this.model.fetch({success:function(){return t.render()}})},i.prototype.onUnload=function(){return this.rendered=!1},i.prototype.render=function(){var t,e,r=this;if(!($("#partner_profile_show .partner_artist[data-artist='"+this.model.get("id")+"']").length>0))return e=$(JST["templates/artists/_partner_artist"]({artist:this.model})),this.setElement(e),this.options.$parentEl.removeClass("loading").append(this.$el),t=this.$(".profile"),t.length>0&&new App.Views.ArtistBlurb({el:t,displayLineCount:4}),App.currentUser.ensureFollowArtists(function(){return r.onFollowArtistsFetched()}),this.model.has("artworks")&&this.model.get("artworks").length>0?this.renderArtworks():(this.model.set("artworks",new App.Collections.Artworks([],{defaultPageSize:20,url:this.options.artworksUrl})),this.model.get("artworks").fetchAllPages({success:function(){return r.renderArtworks()}})),this.scrollToArtist()},i.prototype.scrollToArtist=function(){return this.options.scrollToArtist?$("html, body").animate({scrollTop:this.$el.position().top-199}):void 0},i.prototype.renderArtworks=function(){var t,e,r,o=this;return t=this.model.get("artworks").models,r=700,e=new App.Views.ArtworkColumns({collection:this.model.get("artworks"),seeMore:null!=this.options.seeMore,maxArtworkHeight:r}),this.$el.removeClass("loading").append(e.$el),this.$("img").load(function(){return $(this).removeClass("loading")}),_.defer(function(){return o.initializeArtworksFromDom()}),this.scrollToArtist()},i.prototype.onFollowArtistsFetched=function(){var t=this;return App.currentUser.unbind("change:followArtists",function(){return t.onFollowArtistsFetched}),App.currentUser.get("followArtists").bind("add:"+this.model.get("id"),function(){return t.followChangeViewUpdate(!0)}),App.currentUser.get("followArtists").bind("remove:"+this.model.get("id"),function(){return t.followChangeViewUpdate(!1)}),this.followChangeViewUpdate(this.model.following(),"following")},i.prototype.followArtist=function(t){var e=this;return this.$el.removeClass("committed"),App.follow(t,this.model,{success:function(){return e.$el.addClass("committed")},error:function(){return e.onFollowChange(!1)}}),this.onFollowChange(!0),!1},i.prototype.unfollowArtist=function(t){var e=this;return this.$el.removeClass("committed"),App.unfollow(t,this.model,{success:function(){return e.$el.addClass("committed")},error:function(){return e.onFollowChange(!0)}}),this.onFollowChange(!1),!1},i.prototype.onFollowChange=function(t){return this.followChangeViewUpdate(t),App.currentUser.accountCreated()?t?(App.showMessage(this.model.followMessage()),Analytics.click("Followed artist from artist page",this.model)):(App.showMessage(this.model.unfollowMessage()),Analytics.click("Unfollowed artist from artist page",this.model)):void 0},i.prototype.followChangeViewUpdate=function(t,e){return null==e&&(e="Unfollow"),t?this.$(".actions li.artist.follow a").show().addClass("over").text(e).parent().addClass("following").removeClass("follow"):this.$(".actions li.artist.following a").show().removeClass("over").text("Follow").parent().addClass("follow").removeClass("following")},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerProfileArtists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.BackToTopArrow),o.prototype.rendered=!1,o.prototype.pageSize=3,o.prototype.events=function(){return{"click .artists_list .artist a":"onArtistClick"}},o.prototype.initialize=function(){return this.rendered=!1,this.partner=this.model.get("owner"),this.listenTo(this.partner,"change:artists",this.render),this.$doc=App.$document,this.render()},o.prototype.render=function(){return this.rendered?void 0:-1===window.location.pathname.indexOf("artist")?this.$el.hide():(this.rendered=!0,this.$el.show().removeClass("loading"),this.artistsList||this.renderArtistLists(),this.navHeight=this.$el.height(),"artist"===this.options.tab&&null!=this.options.tabObjId?this.onArtistRoute(this.options.tabObjId):this.onAllArtists())},o.prototype.renderArtistLists=function(){return this.artistsList=new App.Views.PartnerArtistsList({el:this.$(".browser"),model:this.model,baseUrl:"/"+this.model.get("id")+"/artist"})},o.prototype.unbindScroll=function(){return App.$window.off(".partnerArtists")},o.prototype.bindScroll=function(){var t=this;return this.onScrollThrottled=_.debounce(function(){return t.onScroll()},75),App.$window.on("scroll.partnerArtists",this.onScrollThrottled)},o.prototype.arrayPerColumn=function(t,e){var r;return r=Math.ceil(t/e),_.groupBy(t,function(t,e){return Math.floor(e/r)})},o.prototype.renderArtists=function(){var t,e=this;if(0!==this.remainingArtists.length)return t=this.remainingArtists.slice(0,this.pageSize),this.remainingArtists=this.remainingArtists.slice(this.pageSize),_.each(t,function(t){return e.partnerArtistView=new App.Views.PartnerArtist({model:t,seeMore:!0,scrollToArtist:!1,$parentEl:e.$(".partner_artists"),artworksUrl:""+e.partner.url()+"/artist/"+t.get("id")+"/artworks"})})},o.prototype.renderArtist=function(t,e){var r;return null==e&&(e=!1),this.rendered||this.render(),null!=(r=this.partnerArtistView)&&r.remove(),this.artistId=t,this.partnerArtistView=new App.Views.PartnerArtist({modelId:t,scrollToArtist:e,$parentEl:this.$(".partner_artists"),artworksUrl:""+this.partner.url()+"/artist/"+this.artistId+"/artworks"})},o.prototype.onAllArtists=function(){var t;return this.partner.allArtistsFetched()?(this.rendered||this.render(),this.bindScroll(),this.initializeFromFrame({contentDiv:".partner_artists"}),null!=(t=this.partnerArtistView)&&t.remove(),this.remainingArtists=new Backbone.Collection(this.partner.get("partnerArtists").filter(function(t){return t.get("published_artworks_count")>0})),this.remainingArtists=this.remainingArtists.pluck("artist"),this.renderArtists()):this.partner.fetchAllArtists()},o.prototype.onArtistRoute=function(t){return null!=t?this.partner.allArtistsFetched()?(this.$el.find("partner_artist").remove(),this.artistId=t,this.renderArtist(this.artistId,!0)):this.partner.fetchAllArtists():void 0},o.prototype.showTab=function(t){var e;return null==t&&(t=!1),this.options.tab="artist",t&&(this.options.tabObjId=t),null!=(e=this.partnerArtistView)&&e.remove(),this.$(".partner_artists").empty(),this.partner.allArtistsFetched()?(t?this.onArtistRoute(t):this.onAllArtists(),this.artistsList||this.renderArtistLists(),this.$el.show()):this.partner.fetchAllArtists()},o.prototype.onScroll=function(){var t;return 0===this.remainingArtists.length?(this.unbindScroll(),void 0):(t=App.$window.height()+App.$window.scrollTop(),t>=this.$doc.height()-App.$window.height()?this.renderArtists():void 0)},o.prototype.onArtistClick=function(t){var e;return e=$(t.target),0===e.attr("href").indexOf("/artist")?!0:(this.options.parent.options.tabObjId=e.data("artist"),App.router.navigate(e.attr("href"),{trigger:!1}),this.options.parent.onTabChange("artist"),!1)},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerProfileContact=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.render()},o.prototype.fetchLocations=function(){var t=this;return this.locations=new App.Collections.PartnerLocations,this.locations.url=""+this.model.url()+"/locations",this.locations.fetch({success:function(){return t.render()}})},o.prototype.render=function(){return this.locations?this.$el.html(JST["templates/profiles/partner/contact"]({partner:this.model,locations:this.locations.models})):this.fetchLocations()},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerProfileOverview=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events=function(){return{"click figure.artist_summary a":"onArtistClick"}},o.prototype.initialize=function(){var t=this;return this.partner=this.options.partner,this.renderFull=this.partner.get("has_full_profile"),this.partner.hasTab("posts")?(this.posts=new App.Collections.Posts,this.posts.url="/api/v1/profile/"+this.model.get("id")+"/posts",this.posts.type="posts",this.posts.fetch({success:function(){return t.renderPosts()}})):void 0},o.prototype.renderShows=function(){var t,e,r,o=this;if(this.partner.initialShowsFetched()){if(0===this.partner.get("shows").length)return this.$(".shows_overview").hide();if(this.$(".shows_overview").removeClass("loading"),this.featured=null,this.renderFull&&(this.featured=this.partner.get("shows").featured()),r=this.partner.get("shows").overviewShows(this.featured),(0!==r.length||feature)&&(this.featured&&(this.listenTo(this.featured.get("artworks"),"change add remove",function(){return o.renderShowImage(o.featured)}),this.featured.fetchPosterImage()),r.each(function(t){return o.listenTo(t.get("artworks"),"change add remove",function(){return o.renderShowImage(t)}),t.fetchPosterImage()}),e="",this.renderFull&&(e="/"+this.model.get("id")+"/shows"),this.$(".shows_overview").html(JST["templates/profiles/partner/overview_shows"]({featured:this.featured,linkToAll:e,renderFull:this.renderFull,shows:r.models.slice(0,6)})),t=this.$(".shows_overview .featured h4.name"),t.addClass("sizing"),this.$el.show(),t.length>0))return t.height()>250&&t.dotdotdot({height:250}),_.defer(function(){for(var e;t[0].scrollWidth>t.width();)e=parseInt(t.css("font-size"))-2,t.css("font-size",""+e+"px");return t.removeClass("sizing")})}},o.prototype.renderShowImage=function(t){var e,r;return e=this.renderFull&&this.featured.get("id"),r=t.posterImageUrl(e),this.$("figure[data-show='"+t.get("id")+"'] .cover_image").css({"background-image":"url("+r+")"})},o.prototype.renderArtists=function(){var t,e;if(this.partner.get("artistsFetched"))return t=this.$(".artists_overview"),0===this.model.get("posts_count")&&t.empty().addClass("full_width"),e="/"+this.model.get("id")+"/artist",this.renderFull?(t.removeClass("loading").html(JST["templates/profiles/partner/overview_artists"]({linkToAll:"/"+this.model.get("id")+"/artists"})),new App.Views.PartnerArtistsGrid({el:t.find(".grid"),model:this.model,baseUrl:e})):(e="/artist",t.removeClass("loading").html(JST["templates/profiles/partner/_artists_list"]()),new App.Views.PartnerArtistsList({el:t.find(".browser"),model:this.model,baseUrl:e})),this.$el.show()},o.prototype.renderPosts=function(){return 0!==this.posts.length?this.$(".posts_overview").html(JST["templates/profiles/partner/overview_posts"]({profile:this.model,posts:this.posts.models,linkToAll:"/"+this.model.get("id")+"/posts"})).removeClass("loading"):void 0},o.prototype.onArtistClick=function(t){var e,r;return e=$(t.target).closest("a"),r=$(t.target).closest("figure"),e&&r?(this.options.parent.options.tabObjId=r.data("artist"),App.router.navigate(e.attr("href"),{trigger:!1}),this.options.parent.onTabChange("artist"),!1):!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerProfileShows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.rendered=!1,this.partner=this.model.get("owner"),this.listenTo(this.partner,"change:shows",this.render)},o.prototype.showTab=function(){return this.partner.allShowsFetched()||this.partner.fetchAllShows(),this.listenTo(this.partner,"change:showsFetched",this.render),this.rendered||this.render(),this.$el.show()},o.prototype.render=function(){var t,e,r,o=this;if(this.partner.allShowsFetched()&&0!==this.partner.get("shows").length&&!this.rendered)return t=this.partner.get("shows").current(),r=this.partner.get("shows").upcoming(),e=this.partner.get("shows").past(),this.$el.html(JST["templates/profiles/partner/shows"]({featured:null,current:t.models,upcoming:r.models,past:e.models,partner:this.partner})).removeClass("loading"),this.rendered=!0,this.partner.get("shows").each(function(t){return o.listenTo(t.get("artworks"),"change add remove",function(){return o.renderShowImage(t)}),_.once(function(){return t.fetchPosterImage()})})},o.prototype.renderShowImage=function(t){return this.$("figure[data-show='"+t.get("id")+"'] .cover_image").css({"background-image":"url("+t.posterImageUrl()+")"})},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PartnerProfileTour=function(r){function i(){return this.unityProgress=e(this.unityProgress,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.initialize=function(){return App.currentUser.hasLabFeature("Partner Tour")?this.render():void 0},i.prototype.render=function(){var t=this;return this.$el.html(JST["templates/profiles/partner/tour"]({partner:this.model})),$.ajax({url:"//webplayer.unity3d.com/download_webplayer-3.x/3.0/uo/UnityObject2.js",dataType:"script",cache:!0,success:function(){return t.initializeUnity()}})},i.prototype.initializeUnity=function(){return this.unity=UnityObject2({disableContextMenu:!0,disableExternalCall:!1,disableFullscreen:!0}),this.unity.observeProgress(this.unityProgress),this.unity.initPlugin(this.$(".player"),this.model.get("floored_tour"))},i.prototype.unityProgress=function(t){switch(t.pluginStatus){case"unsupported":return this.unity.showUnsupported();case"broken":return App.showMessage("You will need to restart your browser after installation.");case"missing":return this.$(".unity_missing").show(),this.unity.installPlugin();case"installed":return this.$(".unity_missing").hide()}},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PostDialogAttachments=function(r){function i(){return this.onDragEnd=e(this.onDragEnd,this),this.onDrag=e(this.onDrag,this),this.onDragStart=e(this.onDragStart,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.scrollbarLoaded=!1,i.prototype.mouseDelayMet=!1,i.prototype.events={"click a.remove":"onRemoveAttachmentClick"},i.prototype.initialize=function(){return this.$scrollable=this.$(".scrollable"),this.$content=this.$scrollable.find(".clip .figs"),this.$clip=this.$scrollable.find(".clip"),this.$trigger=this.$(".trigger"),this.$add=this.$(".add")},i.prototype.updatePost=function(t){var e=this;return this.model.get("attachments").off(null,null,this),null!=t&&(this.model=t),this.model.get("attachments").on("remove",this.render,this),this.model.get("attachments").on("add reset",function(){return e.render("bottom")},this),this.render()},i.prototype.render=function(t){var e,r=this;return null==t&&(t="relative"),0===this.model.artworks().length&&this.$trigger.hide(),this.options.$dialog.addClass("with_attachments"),this.model.hasAttachments()?(this.$content.empty().html($(function(){var t,r,o,i;for(o=this.model.get("attachments").models,i=[],t=0,r=o.length;r>t;t++)e=o[t],i.push(JST["templates/posts/dialog_attachment"]({model:e}));return i}.call(this).join(""))),this.initializeScrollbar(t),this.initializeReorder(),_.delay(function(){return r.$trigger.removeAttr("style")},1500),this):(this.options.$dialog.removeClass("with_attachments"),this)},i.prototype.initializeScrollbar=function(t){var e=this;return null==t&&(t="relative"),this.$scrollable.imagesLoaded(function(){return e.$content.height()>e.$clip.height()?e.$el.removeClass("noscroll"):(t="relative",e.$el.addClass("noscroll")),e.scrollbarLoaded?e.$scrollable.tinyscrollbar_update(t):(e.$scrollable.tinyscrollbar({content:".figs"}),e.scrollbarLoaded=!0)})},i.prototype.updateScrollInPlace=function(t){var e;return null!=t?this.$scrollable.data("tsb").drag(t):(e=-1*parseInt(this.$content.css("top")),this.$scrollable.tinyscrollbar_update(e))},i.prototype.initializeReorder=function(){var t;return t=this.$content.find("figure"),t.length<2?void 0:t.off(".postAttachment").on("mousedown.postAttachment",this.onDragStart).on("mouseup.postAttachment",this.onDragEnd)},i.prototype.reset=function(){return this.initializeScrollbar(),this.initializeReorder()},i.prototype.onRemoveAttachmentClick=function(t){var e;return e=$(t.target).parent(),this.model.removeAttachment(this.model.get("attachments").get(e.data("attachment"))),e.remove(),this.updateScrollInPlace(),this.initializeReorder(),!1},i.prototype.onDragStart=function(t){var e,r=this;return $(t.target).is("a.remove")?!0:this.mouseDelayMet?(this.$dragTarget=this.$(t.target).parent(),this.dragTargetHeight=this.$dragTarget.height(),this.$dragTarget.css("height",""+this.dragTargetHeight+"px"),_.delay(function(){return r.$dragTarget.addClass("highlight")},200),e=this.$dragTarget.offset(),this.lastPos=e.top,this.$dragHelper=$('<img class="drag_helper" src="'+$(t.target).attr("src")+'" >'),this.$dragHelper.css({top:""+e.top+"px",left:""+e.left+"px","z-index":App.postDialog.$el.css("z-index")}),App.$body.css("cursor","ns-resize").append(this.$dragHelper),this.$dragTarget.addClass("drag_target").css("height","5px"),this.$el.addClass("reorder"),this.$dragHelper.css({"margin-left":"175px"}),App.$document.on("mousemove.postAttachment",_.throttle(this.onDrag,50)).on("mouseup.postAttachment",this.onDragEnd),t.preventDefault(),!1):(this.mouseDelayTimer=setTimeout(function(){return r.mouseDelayMet=!0,r.onDragStart(t)},300),!1)},i.prototype.onDrag=function(t){var e,r,o,i,n,s;return n="up",this.lastY<t.pageY&&(n="down"),this.$dragHelper.css("margin-top","-"+this.dragTargetHeight/2+"px"),this.$el.hasClass("noscroll")||this.updateScrollInPlace(t),o=null,r=this.$dragTarget.prev(),e=this.$dragTarget.next(),"down"===n&&1===e.length&&t.pageY>e.offset().top+e.height()/2&&this.$dragTarget.detach().insertAfter(e),"up"===n&&1===r.length&&t.pageY<r.offset().top+r.height()/2&&this.$dragTarget.detach().insertBefore(r),i=this.$clip.offset().top+this.$clip.height(),0===e.length&&(i=this.$dragTarget.offset().top),s=Math.max(t.pageY,this.$clip.offset().top),s=Math.min(s,i),this.$dragHelper.css("top",""+s+"px"),this.lastY=t.pageY},i.prototype.onDragEnd=function(){var t,e,r,o,i,n=this;return this.mouseDelayMet=!1,window.clearTimeout(this.mouseDelayTimer),App.$document.off(".postAttachment"),App.$body.css("cursor","default"),null!=this.$dragTarget?(this.$dragTarget.removeClass("highlight").css("height",this.dragTargetHeight),this.$dragHelper.css("margin","0"),this.$el.removeClass("reorder"),e=this.$dragTarget.data("attachment"),o=this.$dragTarget.data("position"),i=r=1,this.$content.find("figure").each(function(t,o){var n;return n=$(o),n.data("attachment")===e&&(r=i),n.data("position",i),i+=1}),r!==o&&(t=this.model.get("attachments").get(e),this.$el.addClass("pending"),$.ajax(""+this.model.url()+"/attachment/"+t.get("id")+"/?position="+r,{type:"PUT",success:function(){return n.$el.removeClass("pending")}})),_.delay(function(){return n.$dragTarget.removeClass("drag_target"),n.$dragHelper.remove(),n.updateScrollInPlace()},260)):void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PostCopyEditor=function(r){function i(){return this.createEditor=e(this.createEditor,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"keyup .post_title input":"onTitleChange"},i.prototype.initialize=function(){return this.$title=this.$("#post_title_input"),this.$body=this.$("#post_body_input"),this.$linkDialog=$("#post_dialog .link_dialog"),window.wysihtml5?this.createEditor():null!=App.wysihtml5Url?$.ajax({url:App.wysihtml5Url,dataType:"script",cache:!0,success:this.createEditor}):App.showError("Error loading wysihtml5.js.")},i.prototype.createEditor=function(){var t=this;return this.editor=new wysihtml5.Editor("post_body_input",{toolbar:"post_dialog",useLineBreaks:!1,parserRules:{tags:{i:{},em:{rename_tag:"i"},b:{},strong:{rename_tag:"b"},p:{},a:{check_attributes:{href:"url"},set_attributes:{rel:"nofollow"}}}}}),App.editor=this.editor,this.editor.on("blur:composer",function(){return t.onEditorChange()}),this.editor.on("focus:composer",function(){return t.onEditorChange()}),this.editor.on("newword:composer",function(){return t.onEditorChange()}),this.editor.on("load",function(){var e,r;return e=t.editor.composer.doc,r=e.createElement("script"),r.innerHtml="(function() {var config = {kitId: 'jyb7dwm'}; var d = false; var tk = document.createElement('script'); tk.src = '//use.typekit.net/' + config.kitId + '.js'; tk.type = 'text/javascript'; tk.async = 'true'; tk.onload = tk.onreadystatechange = function() {var rs = this.readyState; if (d || rs && rs != 'complete' && rs != 'loaded') return; d = true; try { Typekit.load(config); } catch (e) {} }; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(tk, s); })();",e.getElementsByTagName("head")[0].appendChild(r)}),this.updatePost(this.model)},i.prototype.updatePost=function(t){var e,r;return this.model=t,this.$title.val(this.model.get("title")),this.$el.removeClass("with_title"),""!==this.model.get("title")&&this.$el.addClass("with_title"),e=this.model.getRaw("body"),this.editor&&(null!=e&&this.editor.setValue(e),this.editor.focus(),this.$title.focus()),null!=(r=App.postDialog)?r.enablePostButton():void 0},i.prototype.title=function(){return this.$title.val()},i.prototype.reset=function(){return this.$title.val(""),this.$el.removeClass("with_title"),this.$body.val(""),this.editor.setValue("")},i.prototype.onEditorChange=function(){return this.model.set("body",this.editor.getValue()),this.options.dialog.enablePostButton()},i.prototype.onTitleChange=function(){return this.model.set("title",this.title()),this.options.dialog.enablePostButton()},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PostDialog=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#post_dialog",o.prototype.dialogHeight=600,o.prototype.events={"click header a.cancel":"onCancelEditClick","click .content a.save":"onSaveClick","click .content a.cancel":"onCancelEditClick","click .options a.artwork":"onAddArtworkClick","click .options a.image":"onAddImageClick","click .options a.video":"onAddVideoClick","click .attachments a.trigger":"onAddTriggerOn","mouseover .attachments a.trigger":"onAddTriggerOn","mouseleave .attachments":"onAddTriggerOff"},o.prototype.initialize=function(){var t;return this.$navButton=this.options.navButton.$el,this.messageDialog=new App.Views.PostMessageDialog({el:$("#post_message_dialog"),model:this.model,navButton:this.options.navButton}),this.$point=this.$("> .point"),this.$postButton=this.$(".content a.save"),this.$addAttachments=this.$(".attachments .add"),this.postAttachments=new App.Views.PostDialogAttachments({el:this.$(".attachments"),$dialog:this.$el,model:this.model}),this.postEditAttachment=new App.Views.PostDialogEditAttachment({el:this.$(".edit_attachment"),parent:this.$("section.create_post"),preview:this.$(".attachments .selected"),post:this.model}),this.onUserNameChange(),this.postCopyEditor=new App.Views.PostCopyEditor({el:this.$(".post_body"),dialog:this,model:this.model}),this.createSection=this.$(".create_post"),t=new App.Views.ProfileIcon({el:this.$(".create_post > header .creator"),model:App.currentProfile}),t.render(),App.currentUser.on("change:name",this.onUserNameChange,this),App.postDialog=this,this.updatePost(this.model)},o.prototype.updatePost=function(t){return null==t&&(t=App.currentPost),this.model=t,t===App.currentPost?this.$el.removeClass("update"):(App.createCookie("current_post",t.get("id"),1),this.$el.addClass("update")),this.options.navButton.updatePostBindings(),this.model.off(null,null,this),this.model.on("change:body",this.enablePostButton,this),this.model.has("artworks")||this.model.set("artworks",new App.Collections.Artworks),this.postEditAttachment.updatePost(this.model),this.postAttachments.updatePost(this.model),this.postCopyEditor.updatePost(this.model),this.options.navButton.updateCounter()},o.prototype.toggle=function(){return this.$el.is(".open")?this.closeDialog():this.openDialog()},o.prototype.openDialog=function(){var t=this;return this.messageDialog.closeDialog(),this.setOverlay(),this.$el.before(this.$overlay),App.$window.on("resize.post_dialog",function(){return t.positionDialog()}),this.$el.removeClass("fadeOut"),this.open=!0,this.$el.addClass("create_post").css("visibility","hidden").show(),this.positionDialog(),this.$el.css("visibility","visible"),this.$el.addClass("open animated fadeIn"),this.options.navButton.hideCounter(),this.postAttachments.initializeScrollbar(),this.enablePostButton()},o.prototype.closeDialog=function(){var t=this;if(this.$el.is(":visible"))return window.clearTimeout(this.timeout),this.$overlay.removeClass("fadeIn").addClass("fadeOut"),this.$el.removeClass("fadeIn").addClass("fadeOut"),_.delay(function(){return t.$overlay.remove(),t.$el.hide(),t.positionDialog(),t.$el.removeClass("open loading")},500),App.$window.off(".post_dialog"),App.$document.off(".post_dialog"),this.options.navButton.showCounter()},o.prototype.setOverlay=function(){var t=this;return $("#post_dialog_overlay").remove(),this.$overlay=$('<div id="post_dialog_overlay" class="ui-widget-overlay animated fadeIn"></div>'),this.$overlay.on("click",function(){return t.closeDialog()}),App.$document.on("keyup.post_dialog",function(e){return e.keyCode===$.ui.keyCode.ESCAPE?t.closeDialog():void 0})},o.prototype.positionDialog=function(){var t;return t=Math.max(Math.floor((App.$window.height()-this.dialogHeight)/2),0),this.$el.css("top",""+t+"px")},o.prototype.postAttachmentBindings=function(){return this.model.get("attachments").on("all",this.enablePostButton,this)},o.prototype.onAddArtworkClick=function(){return this.$(".attachments .add").removeClass("triggered"),this.closeDialog(),this.messageDialog.howToAddArtwork(),!1},o.prototype.onSaveClick=function(){var t,e=this;return this.$postButton.hasClass("disabled")?!1:(this.$el.addClass("loading"),t=this.model.get("id")===App.currentPost.get("id"),this.model.set({published:!0,body:this.postCopyEditor.editor.getValue(),title:this.postCopyEditor.title()},{silent:t}),this.$el.removeClass("create_post with_attachments"),this.model.save({},{success:function(t){return t._type="Post",e.model.set(t),t=new App.Models.Post(t),e.$el.hasClass("update")||(App.Repositories.Posts.add(t),App.currentProfile.trigger("newPost",t)),e.onSuccessfulPost(),Analytics.click("Submitted post")},error:function(){return e.closeDialog()}}),!1)},o.prototype.onCancelEditClick=function(){var t=this;return _.delay(function(){return App.deleteCookie("current_post"),t.updatePost(),t.postAttachments.reset(),t.postCopyEditor.reset()},500),this.closeDialog(),!1},o.prototype.onSuccessfulPost=function(){return App.deleteCookie("current_post"),this.postCopyEditor.reset(),this.postEditAttachment.reset(),this.postAttachments.reset(),this.messageDialog.successMessage(this.model),this.closeDialog(),this.$el.removeClass("create_post"),this.resetCurrentPost(),App.currentProfile.trigger("successfulPost"),!1},o.prototype.resetCurrentPost=function(){var t=this;return this.model=new App.Models.Post,this.options.navButton.updateCounter(),App.Models.CurrentPost.fetchOrCreate({success:function(e){return App.currentPost=e,t.updatePost(e)}})},o.prototype.enablePostButton=function(){return this.model.hasContent()?this.$postButton.removeClass("disabled"):this.$postButton.addClass("disabled")},o.prototype.onUserNameChange=function(){return this.$(".create_post > header hgroup .name").text(App.currentUser.get("name"))},o.prototype.addArtwork=function(t){return this.model.addArtwork(t)},o.prototype.onAddTriggerOn=function(t){if(1===this.$(".reorder").length)return!1;if(!this.$el.is("with_attachments")||$(t.target).is(".trigger"))return this.$addAttachments.addClass("triggered"),!1},o.prototype.onAddTriggerOff=function(){return this.$addAttachments.removeClass("triggered")},o.prototype.onAddImageClick=function(){var t=this;return this.postEditAttachment.setupForImage(),this.createSection.addClass("edit_attachment"),_.delay(function(){return t.$addAttachments.removeClass("triggered")},1e3),!1},o.prototype.onAddVideoClick=function(){var t=this;return this.postEditAttachment.setupForVideo(),this.createSection.addClass("edit_attachment"),_.delay(function(){return t.$addAttachments.removeClass("triggered")},1e3),!1},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PostDialogEditAttachment=function(r){function i(){return this.rollbackOnError=e(this.rollbackOnError,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.cancelled=!1,i.prototype.events={"blur input":"onInputBlur","paste input":"onInputPaste","blur textarea":"onTextareaBlur","paste textarea":"onTextareaPaste","click a.cancel":"onCancelClick","click a.save":"onSaveClick"},i.prototype.initialize=function(){return this.$preview=this.options.preview,this.$input=this.$("fieldset > input.block"),this.$textarea=this.$("fieldset > textarea.embed"),this.$error=this.$(".error"),this.$saveButton=this.$("footer a.save"),this.$cancelButton=this.$("footer a.cancel")},i.prototype.updatePost=function(t){return null!=t&&(this.post=t),this.uploadView=new App.Views.PostDialogUpload({el:this.$(".upload_container"),parent:this})},i.prototype.disableInput=function(t){return null==t&&(t=!0),this.parseInProgress=!0,this.$el.addClass("busy"),this.$input.attr("disabled","disabled"),t?this.uploadView.disable():void 0},i.prototype.enableInput=function(){return this.parseInProgress=!1,this.$preview.removeClass("loading loaded").addClass("empty"),this.$el.removeClass("busy"),this.$input.val("").removeAttr("disabled"),this.uploadView.render()},i.prototype.setupForVideo=function(){var t;return this.cancelled=!1,this.$saveButton.addClass("disabled"),this.resetPreview(),this.$el.addClass("video"),t=this.$input.attr("placeholder"),this.$input.attr("placeholder",t.replace("image","video"))},i.prototype.setupForImage=function(){var t;return this.cancelled=!1,this.$saveButton.addClass("disabled"),this.resetPreview(),this.$el.removeClass("video"),t=this.$input.attr("placeholder"),this.$input.attr("placeholder",t.replace("video","image"))},i.prototype.onInputPaste=function(){var t=this;return _.defer(function(){return t.parseInput()}),!0},i.prototype.onInputBlur=function(){return this.parseInput(),!1
},i.prototype.parseInput=function(){return this.parseInProgress?void 0:(this.$error.html(""),this.$input.val()?(this.disableInput(),this.$preview.addClass("loading"),this.savePostLink()):!1)},i.prototype.savePostLink=function(){var t=this;return this.model=new App.Models.PostLink({url:this.$input.val(),post:this.post}),this.model.save({url:this.$input.val()},{success:function(){return t.pollForOEmbed()},error:this.rollbackOnError})},i.prototype.onTextareaPaste=function(){var t=this;return _.defer(function(){return t.parseTextarea()}),!0},i.prototype.onTextareaBlur=function(){return this.parseTextarea(),!1},i.prototype.parseTextarea=function(){return this.parseInProgress?void 0:(this.$error.html(""),this.$textarea.val()?(this.disableInput(),this.$preview.addClass("loading"),this.savePostEmbed()):!1)},i.prototype.savePostEmbed=function(){var t=this;return this.model=new App.Models.PostEmbed({html:this.$textarea.val(),post:this.post}),this.model.save({html:this.$textarea.val()},{success:function(){return t.onSuccessfulAttachment()},error:this.rollbackOnError})},i.prototype.rollbackOnError=function(t,e){return e.suppressAppMessages=!0,this.removeAttachment(),this.$preview.removeClass("loading"),this.showError(),this.enableInput()},i.prototype.loadPreview=function(){var t,e,r;return t=("function"==typeof(e=this.model).imageSrc?e.imageSrc():void 0)||("function"==typeof(r=this.model).imageUrl?r.imageUrl("original"):void 0),this.$preview.removeClass("loading empty").addClass("loaded").find("img").attr("src",t)},i.prototype.showError=function(t){return null==t&&(t="We're sorry, the link could not be added."),null!=this.model.errorMessage()&&(t=this.model.errorMessage()),this.$error.text(t),this.$el.addClass("error")},i.prototype.onSuccessfulAttachment=function(){return this.cancelled&&this.onCancelClick(),this.post.get("attachments").add(this.model),this.loadPreview(),this.$saveButton.removeClass("disabled")},i.prototype.pollForOEmbed=function(){var t=this;switch(this.model.get("oembed_status")){case"pending":case null:case void 0:return this.model.poll(500,{success:function(){return t.onSuccessfulAttachment()},error:function(e,r){return r.suppressAppMessages=!0,t.removeAttachment(),t.showError(),t.enableInput()}});case"success":return this.onSuccessfulAttachment();default:return this.removeAttachment(),this.showError(),this.enableInput()}},i.prototype.removeAttachment=function(){return this.post.removeAttachment(this.model)},i.prototype.reset=function(){var t=this;return _.delay(function(){return t.$el.removeClass("error"),t.resetPreview()},1e3),this.$saveButton.addClass("disabled"),this.$input.val(""),this.$error.empty(),this.uploadView.render(),this.resetPreview()},i.prototype.resetPreview=function(){return this.$preview.removeClass("loaded loading").addClass("empty").empty().html("<img />")},i.prototype.onSaveClick=function(){return this.$saveButton.hasClass("disabled")||(this.options.parent.removeClass("edit_attachment"),App.postDialog.enablePostButton(),this.reset(),this.enableInput()),!1},i.prototype.onCancelClick=function(){return this.cancelled=!0,this.reset(),this.removeAttachment(),App.postDialog.postAttachments.reset(),this.options.parent.removeClass("edit_attachment"),this.enableInput(),!1},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PostMessageDialog=function(r){function i(){return this.closeDialog=e(this.closeDialog,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#post_message_dialog",i.prototype.events={"click .success a.fb":"onShareClick","click .success a.twitter":"onShareClick"},i.prototype.initialize=function(){return this.$navButton=this.options.navButton.$el,this.fbLink=new App.Views.FacebookShare({el:this.$(".success a.fb")}),this.twitterLink=new App.Views.TwitterShare({el:this.$(".success a.twitter")}),this.$viewPostLink=this.$(".success .view_post"),this.$point=this.$("> .point"),this.listenTo(App.router,"route",this.closeDialog)},i.prototype.updateSuccessLinks=function(){var t;return t=""+App.canonicalUrl+this.model.searchPath(),this.fbLink.render($.param({u:t})),this.twitterLink.render($.param({text:this.model.getShareableTitle(),url:t,hideVia:!0})),this.$viewPostLink.attr({href:this.model.searchPath()})},i.prototype.positionDialog=function(){var t;return t=Math.floor(this.$navButton.offset().left)+27,this.$el.css("left",t)},i.prototype.howToAddArtwork=function(){return this.positionDialog(),this.$el.show().addClass("howto_add fadeInUp"),_.delay(this.closeDialog,5e3),!1},i.prototype.successMessage=function(t){return null==t&&(t=App.currentPost),this.model=t,this.updateSuccessLinks(),this.positionDialog(),this.$el.removeClass("update"),t.get("id")!==App.currentPost.get("id")&&this.$el.addClass("update"),this.$el.show().addClass("success fadeInUp"),_.delay(this.closeDialog,15e3),!1},i.prototype.closeDialog=function(){var t=this;return this.$el.removeClass("fadeInUp").addClass("fadeOutDown"),_.delay(function(){return t.$el.hide().removeClass("success howto_add fadeOutDown")},600)},i.prototype.onShareClick=function(t){return $(t.target).hasClass("twitter")?this.twitterLink.share(t):(this.fbLink.share(t),!1)},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PostDialogUpload=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"mouseover form input":"onMouseoverInput","mouseout form input":"onMouseoutInput"},o.prototype.initialize=function(t){var e=this;return this.parent=t.parent,App.$body.fileupload?this.render():null!=App.fileUploadUrl?$.ajax({url:App.fileUploadUrl,dataType:"script",cache:!0,success:function(){return e.render()}}):App.showError("Error loading file_upload.js.")},o.prototype.render=function(){var t=this;return this.$el.empty().html(JST["templates/posts/upload"]({post:this.parent.post})),this.$button=this.$("a.button"),this.$form=this.$("form.upload"),this.$form.fileupload({add:function(e,r){return t.parent.disableInput(!1),r.submit().error(function(e){return t.parent.showError($.parseJSON(e.responseText).detail.image[0]),e.suppressAppMessages=!0}),t.onMouseoutInput()},done:function(e,r){var o;return o=new App.Models.PostImage(r.result),o.set("post",t.parent.post),t.parent.post.get("attachments").add(o),t.parent.model=o,t.parent.onSuccessfulAttachment(),t.$form.fileupload("disable"),t.$form.fileupload("destroy"),{stop:function(){return!1}}}})},o.prototype.onMouseoverInput=function(){return this.$button.addClass("on")},o.prototype.onMouseoutInput=function(){return this.$button.removeClass("on")},o.prototype.enable=function(){return this.$form.fileupload("enable")},o.prototype.disable=function(){return this.$form.fileupload("disable")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FeaturedPosts=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.FixedDimensionsThumbnails),o.prototype.feedType="posts",o.prototype.feedUrl="/api/v1/posts/featured/feed",o.prototype.initialize=function(){var t=this;return this.maxPosts=this.options.maxPosts,this.feed=this.options.feed,this.currentPost=this.options.currentPost,this.fetchFeaturedPosts({success:function(e){return t.render(e)}})},o.prototype.fetchFeaturedPosts=function(t){var e=this;return this.feedItems=new App.Collections.FeedItems,this.feedItems.type=this.feedType,this.feedItems.urlRoot=this.feedUrl,this.feedItems.fetchFeedItems({pageSize:1.5*this.maxPosts,success:function(){return e.feedItems.length>0?(e.posts=e.getFeatureablePosts(e.feedItems),"function"==typeof t.success?t.success(e.posts):void 0):void 0},error:function(){return e.remove()}})},o.prototype.render=function(t){var e=this;return 0===t.length?this.remove():(this.$el.html(JST["templates/feed/featured_posts/featured_posts_feed"]({posts:t})),this.$el.imagesLoaded(function(){return e.$el.show(),e.setupFixedDimensionsThumbnails(),e.$(".feed_item .img_container img").removeClass("loading")}))},o.prototype.getFeatureablePosts=function(t){var e,r=this;return e=t.filter(function(t){return t.id!==r.currentPost.id&&t.toChildModel().get("attachments").forFeaturedPostThumb()}),e.slice(0,this.maxPosts)},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PostDialogButton=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="header.app .nav.right .post",o.prototype.events={"click a":"toggleDialog"},o.prototype.toggleDialog=function(){var t;return null!=(t=this.dialog)&&t.toggle(),Analytics.click("Clicked on post header dialog button"),!1},o.prototype.initialize=function(){var t,e=this;return this.$badge=this.$(".counter_badge"),t=null!=App.readCookie("current_post"),App.Models.CurrentPost.fetchOrCreate({success:function(t){return App.currentPost=t,e.setDialog(t)}}),App.router.on("all",function(){var t;return null!=(t=e.dialog)?t.closeDialog():void 0})},o.prototype.setDialog=function(t){return null==t&&(t=App.currentPost),null!=this.dialog?this.dialog.updatePost(t):(this.dialog=new App.Views.PostDialog({model:t,navButton:this}),App.postDialog=this.dialog),this.updatePostBindings(),this.updateCounter()},o.prototype.updateCounter=function(){var t,e,r,o,i,n,s=this;if(this.dialog)return e=null!=(r=null!=(o=this.dialog.model.get("attachments"))?o.length:void 0)?r:0,this.$badge.removeClass("bounce_out bounce_in bounce_add"),e>0?(t="bounce_in",this.$badge.is(":visible")&&(t="bounce_add"),this.$badge.text(e),(null!=(i=this.dialog)?null!=(n=i.$el)?n.is(":visible"):void 0:void 0)||this.$badge.show().addClass(t).text(e),_.delay(function(){return s.$badge.removeClass(t)},500),void 0):(this.$badge.addClass("bounce_out"),_.delay(function(){return s.$badge.hide().removeClass("bounce_out")},500),!1)},o.prototype.updatePostBindings=function(){return null!=this.dialog?(this.dialog.model.get("attachments").off(null,null,this),this.dialog.model.get("attachments").on("add remove",this.updateCounter,this)):void 0},o.prototype.hideCounter=function(){var t=this;return this.$badge.addClass("bounce_out"),_.delay(function(){return t.$badge.hide().removeClass("bounce_out")},500)},o.prototype.showCounter=function(){var t,e,r=this;if(0!==(null!=(t=null!=(e=this.dialog.model.get("attachments"))?e.length:void 0)?t:0))return this.$badge.show().addClass("bounce_in"),_.delay(function(){return r.$badge.removeClass("bounce_in")},500)},o.prototype.fancyArtworkAdd=function(t){var e;e=$("img[alt='"+t.get("title")+"']:visible").first(),0===e.length&&this.updateCounter()},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PostDialogFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#post-dialog",o.prototype.frameTitle="PostDialog",o.prototype.frameName="post-dialog",o.prototype.render=function(){return _.delay(function(){return $(".nav.right .post a").click()},1e3)},o}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PostsVideoLink=function(r){function i(){return this.showVideo=e(this.showVideo,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el=".video_link",i.prototype.events={"click .play":"showVideo"},i.prototype.initialize=function(){return this.$img=this.$("img"),this.render()},i.prototype.render=function(){var t=this;return this.$img.imagesLoaded(function(){return t.positionPlayButton()}),this.$el.show()},i.prototype.positionPlayButton=function(){var t,e;return e=this.$img.width(),t=this.$img.height(),e>0&&t>0?this.$(".play").css("top",Math.floor((t-78)/2)+"px").show():void 0},i.prototype.showVideo=function(){var t;return this.$(".video").append(this.model.safeEmbedElement()).show(),this.$(".placeholder").hide(),null!=(t=this.options)&&"function"==typeof t.onPlay&&t.onPlay(),!1},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Profiles.FairOrganizer.Browse.ArtistsList=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.collection=this.model.get("artists")||new App.Collections.Artists,o.__super__.initialize.apply(this,arguments)},o.prototype.getHeaderText=function(){return"Artists A-Z"},o.prototype.getItemDisabled=function(t){return 0===t.get("artworks_count")},o.prototype.getItemHref=function(t){return"/"+this.model.get("id")+"/browse/artist/"+t.get("id")},o}(App.Views.Shared.AToZList)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Profiles.FairOrganizer.Browse.ExhibitorsList=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.getHeaderText=function(){return"Exhibitors A-Z"},o.prototype.getItemDisabled=function(t){return 0===t.get("artworks_count")},o.prototype.getItemHref=function(t){return"/"+this.model.get("id")+"/browse/show/"+t.get("id")},o}(App.Views.Shared.AToZList)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairArtistsList=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.columns=3,i.prototype.tabName="artistsList",i.prototype.tabUrl="artists",i.prototype.filter="all",i.prototype.defaultFilter={filterName:"all"},i.prototype.cache={},i.prototype.events={"click li a":"navigateToArtist"},i.prototype.navigateToArtist=function(t){var e;return e=$(t.target),this.parent.browseModel.set({tab:"artist",artistId:_.last(e.attr("href").split("/"))}),!1},i.prototype.initialize=function(){var t,e,r;return this.parent=this.options.parent,this.parent.loading(!0),this.fair=this.options.fair,(e=this.cache)[r=this.fair.get("id")]||(e[r]={}),this.route=""+this.model.get("id")+"/browse/artists",t=this.parent.getActiveArtistsFilter(),this.parent.updateFilter(t),this.parent.renderedFairArtistsList&&"all"===t.filterName&&this.fair.get("artistsFetched")&&this.reset(),this.render(t,!0),this.parent.renderedFairArtistsList=!0,this.parent.navigate(this.route)},i.prototype.render=function(t,e){var r,o=this;if(e||this.parent.mode===this.tabUrl)return(null!=t?t.filterName:void 0)&&"partner_region"!==(null!=t?t.filterType:void 0)||(t=this.defaultFilter),this.parent.updateFilter(t),this.filter!==t.filterName&&this.reset(),this.filter=(null!=t?t.filterName:void 0)||"all",this.renderArtistsList(),this.fair.get("artistsFetched")?(r=this.fair.get("artists"),this.cache[this.fair.get("id")][t.filterName]=r,this.parent.loading(!1)):null!=this.cache[this.fair.get("id")][t.filterName]?(this.fair.set("artists",this.cache[this.fair.get("id")][t.filterName]),this.fair.set("artistsFetched",!0),this.render(t,!0)):this.fair.fetchArtists({filter:t,success:function(){return o.render(t),o.parent.loading(!1)}}),this.$el.show()},i.prototype.renderArtistsList=function(){var t;return t=new App.Views.Profiles.FairOrganizer.Browse.ArtistsList({model:this.fair}),t.render(),this.$el.html(t.$el).show()},i.prototype.onUnload=function(){return this.$el.hide()},i.prototype.onLoad=function(){var t;return this.$el.show(),t=this.parent.getActiveArtistsFilter(),this.parent.updateFilter(t),this.parent.navigate(this.route),this.filter!==t.filterName?(this.reset(),this.render(t,!1)):void 0},i.prototype.reset=function(){return this.fair.artistsPage=1,this.fair.unset("artistsFetched"),this.fair.unset("artists")},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairBrowse=function(r){function i(){return this.hideFeed=e(this.hideFeed,this),this.showFeed=e(this.showFeed,this),this.getActiveArtistsFilter=e(this.getActiveArtistsFilter,this),this.getActiveLinkFilter=e(this.getActiveLinkFilter,this),this.resetFilter=e(this.resetFilter,this),this.showFilterResults=e(this.showFilterResults,this),this.showArtistList=e(this.showArtistList,this),this.showExhibitorList=e(this.showExhibitorList,this),this.showExhibitorShows=e(this.showExhibitorShows,this),this.showAllExhibitorShows=e(this.showAllExhibitorShows,this),this.showExhibitorFilter=e(this.showExhibitorFilter,this),this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),this.navigate=e(this.navigate,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabs={artist:function(){return new App.Views.FairArtist({el:this.$(".feed .visible_artist"),model:this.model,fair:this.fair,parent:this})},artistsList:function(){return new App.Views.FairArtistsList({el:this.$(".artists_list"),model:this.model,fair:this.fair,parent:this})},partnerShow:function(){return new App.Views.FairPartnerShow({el:this.$(".feed .visible_show"),model:this.model,fair:this.fair,parent:this})},partnerShowsList:function(){return new App.Views.FairPartnerShowsList({el:this.$(".feed .shows"),model:this.model,fair:this.fair,parent:this})},exhibitorsList:function(){return new App.Views.FairExhibitorsList({el:this.$(".exhibitors_list"),model:this.model,fair:this.fair,parent:this})},filter:function(){return new App.Views.FairFilter({el:this.$(".filtered_artworks .filtered"),model:this.model,parent:this})}},i.prototype.filterOptions={forsale:!0,medium:!0,color:!1,size:!0,relatedGenes:!0,filterSuggestions:!1},i.prototype.defaultTabName="partnerShowsList",i.prototype.currentLayout="shows",i.prototype.templateName="templates/fairs/browse",i.prototype.skipNavigate=!1,i.prototype.sections=".exhibitors_list, .artists_list, .feed",i.prototype.tabViews={},i.prototype.initialRender=!0,i.prototype.widthOffset=-280,i.prototype.initialize=function(){var t=this;return this.$el.addClass("loading"),this.parent=this.options.parent,this.fair=this.options.fair,this.baseUrl=""+this.model.get("id")+"/browse",this.tabNames=_.keys(this.tabs).join(" "),App.IS_PHONE&&(this.widthOffset=0),this.browseModel=new App.Models.FairFilter,this.browseModel.bind("change",this.loadCurrentTab,this),App.Repositories.Fairs.getOrFetch(this.options.fair.id,["partners_count","artists_count","partner_shows_count"],{success:function(e){return t.fair=e,t.renderAll()}})},i.prototype.navigate=function(t){return this.skipNavigate?this.skipNavigate=!1:(t=this.browseModel.getCurrentRoute(t),App.router.navigate(t,{trigger:!1}))},i.prototype.renderAll=function(){var t=this;return this.fair.ensureRegionsFetched(function(){return t.render(t.parent.options.subTab||t.defaultTabName)}),this.fair.ensureSectionsFetched(function(){return t.render(t.parent.options.subTab||t.defaultTabName)})},i.prototype.render=function(t){var e=this;if(!this.rendered&&this.fair.get("regionsFetched")&&this.fair.get("sectionsFetched"))return this.rendered=!0,_.defer(function(){return e.$el.html(JST[e.templateName]({fair:e.fair,filterOptions:e.filterOptions,profile:e.model})),e.renderFiltered(t),e.storeOptions(e.parent.options),e.$el.removeClass("loading")})},i.prototype.selectTab=function(t){return null==t&&(t=this.defaultTabName),"filter"===t?this.browseModel.set({tab:t}):this.browseModel.set({tab:t,filterName:void 0,filterType:void 0})},i.prototype.loadCurrentTab=function(){var t=this;return _.defer(function(){var e,r,o;return e=t.browseModel.get("tab"),t.tabs[e]?(null!=(o=t.currentTab)&&"function"==typeof o.onUnload&&o.onUnload(),t.$el.removeClass(t.tabNames),t.$el.addClass(e),t.$(t.sections).hide(),t.tabViews[e]?"function"==typeof(r=t.tabViews[e]).onLoad&&r.onLoad():t.tabViews[e]=t.tabs[e].call(t),t.currentTab=t.tabViews[e],(!t.initialRender||t.parent.lastScrollTop)&&($(window).scrollTop()<10||$(window).scrollTop()>t.$el.position().top)&&t.scrollToPosition(t.$el.position().top),t.initialRender=!1,t.changeMode()):void 0})},i.prototype.onLoad=function(){var t=this;return _.defer(function(){var e,r,o,i;return e=App.router.viewState.frames[App.router.viewState.currentFrame].params,t.storeOptions(e),null!=(r=t.resultsView)&&r.onLoad(),null!=(o=t.scrolller)&&o.load(),null!=(i=t.dockedOptions)&&i.load(),t.browseModel.trigger("change")})},i.prototype.onUnload=function(){var t,e,r,o;return null!=(t=this.currentTab)&&"function"==typeof t.onUnload&&t.onUnload(),null!=(e=this.resultsView)&&e.onUnload(),null!=(r=this.scrolller)&&r.unload(),null!=(o=this.dockedOptions)?o.unload():void 0},i.prototype.changeMode=function(){var t,e,r,o,i,n,s,a,l,p;return(t=this.browseModel.get("tab"))?"partnerShowsList"===t?(null!=(e=this.parent.footer)&&e.hide(),this.resetFilterSilently(),this.$(".filtered").show(),this.$(".filter_results").hide(),null!=(r=this.resultsView)?r.onUnload():void 0):"exhibitorsList"===t?(this.$(".featured_links .featured_link .selected").removeClass("selected"),null!=(o=this.parent.footer)&&o.hide(),this.resetFilterSilently(),this.$(".filtered").show(),this.$(".filter_results").hide(),null!=(i=this.resultsView)?i.onUnload():void 0):"artistsList"===t?(null!=(n=this.parent.footer)&&n.hide(),this.resetFilterSilently(),this.$(".filtered").show(),this.$(".filter_results").hide(),this.$(".pre_loader").hide(),null!=(s=this.resultsView)?s.onUnload():void 0):"partnerShow"===t||"artist"===t?(null!=(a=this.parent.footer)&&a.show(),this.$(".featured_links .featured_link .selected").removeClass("selected"),this.$(".artists .featured_link .selected").removeClass("selected"),this.resetFilterSilently(),this.$(".filtered").show(),this.$(".filter_results").hide(),this.showFeed(),null!=(l=this.resultsView)?l.onUnload():void 0):"filter"===t?(null!=(p=this.parent.footer)&&p.hide(),this.hideFeed(),this.$(".filtered, .filter_results, .filter_results .result_row").show()):void 0:void 0},i.prototype.renderFiltered=function(t){var e,r,o,i,n,s=this;if(!this.filterRendered)return this.filter=new App.Models.ArtworkFilter({params:(null!=(n=App.currentFrameView.params)?n.params:void 0)||App.currentFrameView.options.params,fairId:this.fair.get("id"),acceptedFrameName:"profile",route:""+this.model.get("id")+"/browse/filter",skipInitialTrigger:"filter"!==t?!0:void 0}),this.filter.acceptedFrameName=this.parent.frameName,this.resultsView=new App.Views.Results({el:this.$(".filtered_artworks .filter_results"),model:this.filter,top:this.$el.position().top}),this.saleFilter=new App.Views.SaleFilter({el:this.$(".filtered_artworks .forsale"),model:this.filter,expandableFilter:!0}),o=new App.Views.MediumFilter({el:this.$(".medium"),model:this.filter}),i=new App.Views.SizeFilter({el:this.$(".filtered_artworks .size"),model:this.filter}),e=new App.Views.FilterSuggestions({el:this.$(".filter_suggestions"),model:this.filter}),r=new App.Views.RelatedGeneFilter({el:this.$(".filtered_artworks .related_genes"),model:this.filter}),this.scroller=new App.Views.FilterScroll({el:this.$(".filter_options"),model:this.filter}),this.dockedOptions=new App.Views.DockableFilterOptions({el:this.$(".filter_options"),offsetEl:this.$el,minTop:100,bottomEl:this.$el.parent().find(".fair_footer")}),this.dockedOptions.load(),this.filter.triggerOptionsUpdate(),this.filter.bind("change:selection",this.showFilterResults),this.filterRendered=!0,_.defer(function(){return s.$(".filter_options .clip > ul.content").css({top:"0px"})})},i.prototype.events={"click .featured_links .featured_link a":"showExhibitorFilter","click .artists .featured_link a":"showArtistList","click .artists_all":"showArtistList","click .exhibitors_atoz":"showExhibitorList","click .exhibitors_all":"showAllExhibitorShows","click .artworks_all, .all_container li":"resetFilter"},i.prototype.showExhibitorFilter=function(t){return this.$("a.opt").removeClass("selected"),$(t.target).addClass("selected"),"shows"===this.currentLayout?this.showExhibitorShows():this.showExhibitorList()},i.prototype.showAllExhibitorShows=function(){return this.$("li.featured_link[data-name=all] a").click(),!1},i.prototype.showExhibitorShows=function(){return this.$("li.selected").removeClass("selected"),this.selectTab("partnerShowsList"),!1},i.prototype.showExhibitorList=function(t){return this.$("li.selected").removeClass("selected"),this.$("a.opt").removeClass("selected"),$(t.target).addClass("selected"),this.selectTab("exhibitorsList"),!1},i.prototype.showArtistList=function(t){return this.$("li.selected").removeClass("selected"),this.$("a.opt").removeClass("selected"),$(t.target).addClass("selected"),this.selectTab("artistsList"),!1},i.prototype.showFilterResults=function(){var t;return this.filter.get("selectedGene")||this.filter.get("selectedColor")||this.filter.get("selectedMedium")||this.filter.get("selectedDimensions")||this.filter.get("selectedPriceBucket")||this.filter.get("selectedRelatedGene")?this.$(".all_container li").removeClass("selected"):this.$(".all_container li").addClass("selected"),this.$(".featured_links .featured_link a, .artists .featured_link a").removeClass("selected"),t=this.getActiveLinkFilter(),this.browseModel.set({filterName:t.filterName,filterType:t.filterType,tab:"filter"}),this.selectTab("filter")},i.prototype.resetFilter=function(){return this.filter.reset(),this.filter.trigger("change:selection"),!1},i.prototype.cleanupFeedItems=function(t){var e,r,o,i,n;for(i=t.models,n=[],r=0,o=i.length;o>r;r++)e=i[r],n.push(e.set({_type:"PartnerShow"}));return n},i.prototype.storeOptions=function(t){var e;return e=t.filterName?decodeURIComponent(t.filterName):void 0,this.browseModel.set({tab:(null!=t?t.subTab:void 0)||this.defaultTabName,params:t.params,filterName:e,filterType:t.filterType,partnerId:t.partnerId,artistId:t.artistId})},i.prototype.getActiveLinkFilter=function(){var t;if(t=this.$(".featured_links .featured_link .selected").parent(),!t.length){if(this.browseModel.get("filterName"))return{filterName:this.browseModel.get("filterName"),filterType:this.browseModel.get("filterType")};t=this.$(".featured_links .featured_link .opt:first").addClass("selected").parent()}return{filterName:t.attr("data-name"),filterType:t.attr("data-type")}},i.prototype.getActiveArtistsFilter=function(){var t;if(t=this.$(".artists .featured_link .selected").parent(),!t.length){if(this.browseModel.get("filterName"))return{filterName:this.browseModel.get("filterName"),filterType:this.browseModel.get("filterType")};t=this.$(".artists .featured_link .opt:first").addClass("selected").parent()}return{filterName:t.attr("data-name"),filterType:t.attr("data-type")}},i.prototype.updateFilter=function(t){return this.browseModel.set({filterName:t.filterName,filterType:t.filterType},{silent:!0})},i.prototype.scrollToPosition=function(t){return $("html, body").scrollTop(t)},i.prototype.showFeed=function(){return this.$(".feed").show()},i.prototype.hideFeed=function(){return this.$(".feed").hide()},i.prototype.resetFilterSilently=function(){return this.$(".all_container li").removeClass("selected"),this.filter.reset({silent:!0})},i.prototype.loading=function(t){return t?this.$el.addClass("loading"):this.$el.removeClass("loading")},i.prototype.repositionDockedOptions=function(){var t;return null!=(t=this.dockedOptions)?t.updateOffset():void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairFilter=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabName="filter",i.prototype.tabUrl="filter",i.prototype.initialize=function(){var t;return this.parent=this.options.parent,this.parent.loading(!0),App.currentFrameView.options.params&&this.parent.filter.setNewParams(App.currentFrameView.options.params),this.$el.show(),this.parent.hideFeed(),this.parent.resultsView.onLoad(),this.parent.loading(!1),t=this.parent.getActiveLinkFilter(),this.parent.updateFilter(t)},i.prototype.onUnload=function(){return this.$el.hide(),this.parent.resultsView.onUnload(),this.parent.loading(!1)},i.prototype.onLoad=function(){return App.currentFrameView.options.params&&(this.parent.filter.params=$.deparam(App.currentFrameView.options.params),this.parent.filter.processParams(!1)),this.$el.show(),this.parent.hideFeed(),this.parent.resultsView.onLoad(),this.parent.loading(!1)},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairPartnerShow=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabName="partnerShow",i.prototype.tabUrl="show",i.prototype.initialize=function(){return this.parent=this.options.parent,this.fair=this.options.fair,this.route=""+this.model.get("id")+"/browse/show",this.parent.loading&&this.parent.loading(!0),this.render()},i.prototype.render=function(t){var e=this;return t=this.options.partnerId||this.parent.browseModel.get("partnerId"),this.$el.show(),this.parent.navigate&&this.parent.navigate(this.route),this.fair.fetchShowForPartner(t,{success:function(t){var r;if((null!=t?t.length:void 0)>0)return null!=(r=e.feed)&&r.onUnload(),t.doneFetching=!0,e.parent.cleanupFeedItems(t),e.feed?(e.feed.feedItems=t,e.feed.reRender()):e.feed=new App.Views.Feed({el:e.$el,feedItems:t,afterFetch:e.parent.cleanupFeedItems,widthOffset:e.parent.widthOffset,skipRecompute:!0,profile:e.model,afterLoad:function(){var t,e,r,o,i;for(o=this.items,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(t.fetchMoreArtworks(t.$(".see_more button")));return i}}),e.parent.loading&&e.parent.loading(!1),e.parent.repositionDockedOptions()}})},i.prototype.onUnload=function(){var t;return this.$el.html("").hide(),null!=(t=this.feed)?t.onUnload():void 0},i.prototype.onLoad=function(){var t;return this.render(),null!=(t=this.feed)&&t.onLoad(),this.parent.showFeed()},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairPartnerShowsList=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabName="partnerShowsList",i.prototype.tabUrl="shows",i.prototype.headerText=function(){return"all"===this.filterName?"All Exhibitors":"section"===this.filter.filterType?"Exhibitors at "+this.filter.filterName:"partner_region"===this.filter.filterType?"Exhibitors from "+this.filter.filterName:void 0},i.prototype.headerSortOrder=function(){var t,e;return"all"===this.filterName||"section"===(null!=(t=this.filter)?t.filterType:void 0)||"partner_region"===(null!=(e=this.filter)?e.filterType:void 0)?"Sorted By: Recently Updated":""
},i.prototype.defaultFilter={filterName:"all"},i.prototype.cache={},i.prototype.initialize=function(){var t,e;return this.parent=this.options.parent,this.fair=this.options.fair,(t=this.cache)[e=this.fair.get("id")]||(t[e]={}),this.parent.loading(!0),null!=window.location.search&&(this.cursor=window.location.search.split("=")[1]),this.route=""+this.model.get("id")+"/browse/shows",this.render(this.parent.getActiveLinkFilter())},i.prototype.render=function(t){var e,r,o,i=this;return(null!=t?t.filterName:void 0)||(t=this.defaultFilter),this.filter=t,this.filterName=this.getFilterName(t),r=""+this.filterName+":"+(null!=(o=this.filter)?o.filterType:void 0),this.parent.updateFilter(t),this.$el.html("").show(),this.parent.showFeed(),this.parent.navigate(this.route),this.cache[this.fair.get("id")][r]?(e=this.cache[this.fair.get("id")][r],this.onFeedItems(e,t)):this.fair.fetchShows({filter:t,onlyShowsWithArtworks:!0,success:function(e){return i.cache[i.fair.get("id")][r]=e,i.onFeedItems(e,t)}})},i.prototype.onFeedItems=function(t,e){var r,o=this;return null!=(r=this.feed)&&r.onUnload(),t.urlRoot=""+this.fair.url()+"/shows",this.parent.cleanupFeedItems(t),t.length?this.feed?(this.feed.additionalParams=this.fair.formatBackboneFetchObject({filter:e}),this.feed.headingText=this.headerText(),this.feed.headingSortOrder=this.headerSortOrder(),this.feed.doneFetching=!1,t.doneFetching=!1,this.feed.feedItems=t,this.feed.onLoad()):this.feed=new App.Views.Feed({el:this.$el,widthOffset:0,availableWidth:this.$el.width(),feedItems:t,sortOrder:this.fair.sortOrder(),onlyShowsWithArtworks:!0,additionalParams:this.fair.formatBackboneFetchObject({filter:e}),skipRecompute:!0,marginLeftRight:1,displayBacktoPageOne:!0,profile:this.model,headingText:this.headerText(),headingSortOrder:this.headerSortOrder(),afterFetch:function(t){return o.parent.cleanupFeedItems(t)}}):this.$el.html(""),this.parent.loading(!1)},i.prototype.onUnload=function(){var t;return this.scrollTop=App.$window.scrollTop(),null!=(t=this.feed)&&t.onUnload(!1),this.$el.hide(),this.parent.hideFeed()},i.prototype.onLoad=function(){var t,e=this;return this.parent.showFeed(),this.$el.show(),this.feed&&(t=this.parent.getActiveLinkFilter(),this.render(t)),_.defer(function(){return e.scrollTop?$("html, body").scrollTop(e.scrollTop):void 0})},i.prototype.getFilterName=function(t){return(null!=t?t.filterName:void 0)||"all"},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairExhibitorsList=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.columns=3,i.prototype.tabName="exhibitorsList",i.prototype.tabUrl="exhibitors",i.prototype.filter="all",i.prototype.defaultFilter={filterName:"all"},i.prototype.events={"click li a":"navigateToShow"},i.prototype.navigateToShow=function(t){var e;return e=$(t.target),this.parent.browseModel.set({tab:"partnerShow",partnerId:_.last(e.attr("href").split("/"))}),!1},i.prototype.cache={},i.prototype.initialize=function(){var t,e,r;return this.fair=this.options.fair,(e=this.cache)[r=this.fair.get("id")]||(e[r]={}),this.parent=this.options.parent,this.route=""+this.model.get("id")+"/browse/exhibitors",this.showRoute=""+this.model.get("id")+"/browse/show",t=this.parent.getActiveLinkFilter(),this.parent.loading(!0),this.parent.renderedFairExhibitorsList&&"all"===t.filterName&&this.fair.get("partnersFetched")&&this.reset(),this.render(t,!0),this.parent.renderedFairExhibitorsList=!0},i.prototype.render=function(t,e){var r=this;if(e||this.parent.mode===this.tabUrl)return(null!=t?t.filterName:void 0)||(t=this.defaultFilter),this.parent.updateFilter(t),this.parent.navigate(this.route),this.filter!==t.filterName&&this.reset(),this.filter=(null!=t?t.filterName:void 0)||"all",this.renderExhibitorsList(),this.fair.get("partnersFetched")?(this.cache[this.fair.get("id")][t.filterName]=this.fair.get("partners"),this.parent.loading(!1)):null!=this.cache[this.fair.get("id")][t.filterName]?(this.fair.set("partners",this.cache[this.fair.get("id")][t.filterName]),this.fair.set("partnersFetched",!0),this.render(t,!0)):this.fair.fetchExhibitors({filter:t,success:function(){return r.render(t),r.parent.loading(!1)}})},i.prototype.renderExhibitorsList=function(){var t,e=this;return this.fair.has("partners")&&this.fair.get("partnersFetched")?(t=new App.Views.Profiles.FairOrganizer.Browse.ExhibitorsList({model:this.model,collection:this.fair.get("partners")}),t.render(),this.$el.html(t.$el).show()):(this.parent.loading(!0),this.fair.fetchExhibitors({filter:this.parent.getActiveLinkFilter(),success:function(){return e.renderExhibitorsList(),e.parent.loading(!1)}}),void 0)},i.prototype.onUnload=function(){return this.$el.hide()},i.prototype.onLoad=function(){var t;return this.$el.show(),t=this.parent.getActiveLinkFilter(),this.reset(),this.render(t,!0)},i.prototype.reset=function(){return this.fair.exhibitorsPage=1,this.fair.unset("partnersFetched"),this.fair.unset("partners")},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairArtist=function(r){function i(){return this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),this.headerText=e(this.headerText,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.tabName="artist",i.prototype.tabUrl="artist",i.prototype.headerText=function(){return this.artistId?App.Repositories.Artists.get(this.artistId).get("name"):void 0},i.prototype.initialize=function(){return this.parent=this.options.parent,this.fair=this.options.fair,this.parent.loading&&this.parent.loading(!0),this.route=""+this.model.get("id")+"/browse/artist",this.render()},i.prototype.render=function(){var t=this;return this.artistId=this.options.artistId||this.parent.browseModel.get("artistId"),this.$el.show(),this.parent.navigate&&this.parent.navigate(this.route),this.fair.fetchShowForArtist(this.artistId,{success:function(e){var r;return null!=(r=t.feed)&&r.onUnload(),e.urlRoot=""+t.fair.url()+"/shows",t.parent.cleanupFeedItems(e),t.feed?(t.feed.feedItems=e,t.feed.reRender()):t.feed=new App.Views.Feed({el:t.$el,feedItems:e,widthOffset:t.parent.widthOffset,afterFetch:t.parent.cleanupFeedItems,additionalParams:{artist:t.artistId},skipRecompute:!0,headingText:t.headerText(),afterLoad:function(){return t.$(".see_more").hide()}}),t.parent.loading&&t.parent.loading(!1),t.parent.repositionDockedOptions()}})},i.prototype.onUnload=function(){var t;return this.$el.hide(),null!=(t=this.feed)?t.onUnload():void 0},i.prototype.onLoad=function(){var t;return this.render(),null!=(t=this.feed)&&t.onLoad(),this.parent.showFeed()},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FairFooter=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .small_featured_link a, .large_featured_link a":"trackClick"},o.prototype.initialize=function(){return this.$el.addClass("loading"),this.parent=this.options.parent,this.fair=this.options.fair,this.render()},o.prototype.render=function(){return this.$primaryLinks=this.$(".primary_featured_links_container"),this.$exploreLinks=this.$(".explore_featured_links_container"),this.$posts=this.$(".post_container"),this.fetchFeaturedLinks(),this.fetchPosts(),this.$el.removeClass("loading")},o.prototype.fetchFeaturedLinks=function(){var t=this;return this.fair.ensureFeaturedLinksFetched(function(){return t.renderLinks()})},o.prototype.renderLinks=function(){var t,e,r,o;return e=null!=(r=this.fair.get("primaryLinks"))?r.get("items").models:void 0,t=null!=(o=this.fair.get("exploreLinks"))?o.get("items").models:void 0,(null!=e?e.length:void 0)&&this.$primaryLinks.html(JST["templates/fairs/primary_links"]({links:e,profile:this.model})).show(),(null!=t?t.length:void 0)&&this.$exploreLinks.html(JST["templates/fairs/explore_links"]({links:t,profile:this.model})).show(),this.$(".primary_featured_links .large_featured_link:last").addClass("last"),this.showSections()},o.prototype.fetchPosts=function(){var t=this;return this.parent.ensurePostsFetched(function(){return t.renderSmallFeed(t.parent.posts.models)})},o.prototype.renderSmallFeed=function(t){return this.$posts.html(JST["templates/fairs/small_posts"]({posts:t.slice(0,3),profile:this.model})).find(".loading").removeClass("loading"),this.showSections()},o.prototype.showSections=function(){return this.$primaryLinks.show(),this.$exploreLinks.show(),this.$posts.show()},o.prototype.show=function(){return this.$el.show()},o.prototype.hide=function(){return this.$el.hide()},o.prototype.trackClick=function(t){var e;return e=$(t.target).parent().find(".name").text(),Analytics.click("Clicked "+e+" in "+this.fair.get("name")+" footer")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairInfo=function(r){function i(){return this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.initialize=function(){return this.fair=this.options.fair,this.render()},i.prototype.render=function(){var t=this;return App.Repositories.Fairs.getOrFetch(this.model.get("owner").get("default_fair_id"),["about","location","contact","links"],{success:function(e){return t.fair=e,t.afterFetch()}})},i.prototype.afterFetch=function(){return this.$el.html(JST["templates/fairs/info"]({fair:this.fair})).fadeIn(200),this.$(".content h2:first").addClass("first"),this.fair.get("location")&&this.displayMap(),this.targetBlankLinks()},i.prototype.displayMap=function(){var t,e,r;return t=165,r=App.IS_PHONE?415:300,e=this.fair.get("location").mapImageSrc(r,t),e?this.$("img.map").attr({src:e}):void 0},i.prototype.targetBlankLinks=function(){return this.$("a").attr({target:"_blank"})},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FairOverview=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .small_featured_link a, .large_featured_link a":"trackClick","click .primary_featured_links .large_featured_link":"largeLinkClick","click .regions a":"trackRegionClick","click .az_links a":"trackAzClick","click .feed_item":"feedItem"},o.prototype.initialize=function(){return this.$el.addClass("loading"),this.parent=this.options.parent,this.fair=this.options.fair,this.render()},o.prototype.render=function(){return this.rendered&&this.onLoad(),this.$el.html(JST["templates/fairs/overview"]({fair:this.fair,profile:this.model})),this.$primaryLinks=this.$(".primary_featured_links_container"),this.$exploreLinks=this.$(".explore_featured_links_container"),this.$curatorLinks=this.$(".curator_featured_links_container"),this.$posts=this.$(".post_container"),this.$regions=this.$(".region_container"),this.$el.removeClass("loading"),this.fetchPosts(),this.fetchFeaturedLinks(),"AuctionProfile"!==this.model.get("subtype")&&this.fetchRegions(),this.rendered=!0},o.prototype.fetchFeaturedLinks=function(){var t=this;return this.fair.ensureFeaturedLinksFetched(function(){return t.renderFeaturedLinks()})},o.prototype.renderFeaturedLinks=function(){var t,e,r,o,i,n;return r=null!=(o=this.fair.get("primaryLinks"))?o.get("items").models:void 0,e=null!=(i=this.fair.get("exploreLinks"))?i.get("items").models:void 0,t=null!=(n=this.fair.get("curatorLinks"))?n.get("items").slice(0,6):void 0,(null!=r?r.length:void 0)&&this.$primaryLinks.html(JST["templates/fairs/primary_links"]({links:r,profile:this.model})).css({display:"inline-block"}),(null!=e?e.length:void 0)&&this.$exploreLinks.html(JST["templates/fairs/explore_links"]({links:e,profile:this.model})).css({display:"inline-block"}),(null!=t?t.length:void 0)&&this.$curatorLinks.show().html(JST["templates/fairs/curator_links"]({links:t,profile:this.model})).css({display:"inline-block"}),this.$(".primary_featured_links .large_featured_link:first").addClass("first"),this.$(".primary_featured_links .large_featured_link:last").addClass("last"),this.$(".primary_featured_links .vertical_border:last").addClass("last")},o.prototype.fetchPosts=function(){var t=this;return this.parent.ensurePostsFetched(function(){return t.renderSmallFeed(t.parent.posts.models)})},o.prototype.renderSmallFeed=function(t){return(null!=t?t.length:void 0)?this.$posts.html(JST["templates/fairs/small_posts"]({posts:t.slice(0,3),profile:this.model})).show().find(".loading").removeClass("loading"):void 0},o.prototype.fetchRegions=function(){var t=this;return this.fair.ensureRegionsFetched(function(){var e;return e=t.fair.get("regions"),e.length?t.$regions.html(JST["templates/fairs/regions"]({regions:e,heading:"Exhibitors by region",profile:t.model})).show():void 0})},o.prototype.onLoad=function(){var t,e,r,o,i,n;return this.fair.get("regions")&&this.$regions.show(),r=null!=(o=this.fair.get("primaryLinks"))?o.get("items").models:void 0,e=null!=(i=this.fair.get("exploreLinks"))?i.get("items").models:void 0,t=null!=(n=this.fair.get("curatorLinks"))?n.get("items").slice(0,6):void 0,(null!=r?r.length:void 0)&&this.$primaryLinks.show(),(null!=e?e.length:void 0)&&this.$exploreLinks.show(),(null!=t?t.length:void 0)?this.$curatorLinks.show():void 0},o.prototype.trackClick=function(t){var e;return e=$(t.target).parent().find(".name").text(),Analytics.click("Clicked "+e+" in "+this.fair.get("name")+" overview")},o.prototype.trackRegionClick=function(t){var e;return e=$(t.target).text(),Analytics.click("Clicked "+e+" region in "+this.fair.get("name")+" overview")},o.prototype.trackAzClick=function(t){var e;return e=$(t.target).attr("class"),Analytics.click("Clicked "+e+" list in "+this.fair.get("name")+" overview")},o.prototype.largeLinkClick=function(t){var e,r;return e=$(t.target).parent().attr("data-link"),null!=e?(App.router.navigate(e,{trigger:!0}),r=$(t.target).find(".name").text(),Analytics.click("Clicked "+r+" in "+this.fair.get("name")+" overview"),!1):void 0},o.prototype.feedItem=function(t){var e;for(e=t.target;!$(e).data("id");)e=$(e).parent();return App.router.navigate("/post/"+$(e).data("id"),{trigger:!0})},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FairOrganizerProfileShow=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),this.onScroll=e(this.onScroll,this),this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.CoverArt),i.prototype.el="#fair_profile_show",i.prototype.frameName="fairProfile",i.prototype.defaultTabName="overview",i.prototype.dockTabsAt=563,i.prototype.previousScrollTop=-1,i.prototype.tabs={overview:function(){return new App.Views.FairOverview({el:this.$("section.overview"),model:this.model,fair:this.fair,parent:this})},posts:function(){var t=this;return new App.Views.ProfilePosts({el:this.$("section.posts"),model:this.model,afterLoad:function(){return t.footer.$el.show()}})},browse:function(){return new App.Views.FairBrowse({el:this.$("section.browse"),model:this.model,fair:this.fair,parent:this})},auctions:function(){return new App.Views.FairExhibitors({el:this.$("section.auctions"),model:this.fair})},info:function(){return new App.Views.FairInfo({el:this.$("section.info"),model:this.model,fair:this.fair})}},i.prototype.events={"click .tabs a":"onTabClick","click > .arrow":"onScrollArrowClick"},i.prototype.isRendered=function(t){return this.profileId===(null!=t?t.profileId:void 0)},i.prototype.initialize=function(){var t;return this.isMe=null!=(t=this.model)?t.isCurrentProfile():void 0,this.$el.addClass("loading").show(),this.tabNames=_.keys(this.tabs).join(" "),this.baseUrl="/"+this.model.get("id"),this.fair=this.model.get("owner").get("defaultFair")},i.prototype.render=function(){var t;if(!this.rendered)return this.rendered=!0,i.__super__.render.apply(this,arguments),this.profileId=this.model.get("id"),this.$el.removeClass("loading").addClass(this.defaultTabName).html(JST["templates/profiles/fair_organizer/show"]({profile:this.model,fair:this.fair,isMe:this.isMe,baseUrl:this.baseUrl})).show(),this.setFrameTitle(),this.isMe&&(this.model=App.currentProfile,App.currentProfile.on("change",this.onProfileChange,this)),this.profileFollowView||(this.profileFollowView=new App.Views.ProfileFollow({el:this.$("> header .follow_actions"),model:this.model})),this.profileFollowView.render(),this.listenTo(this.model,"change:follows_count",this.renderFollows),this.$coverArt=this.$(".cover_art"),this.fair.hasImage()&&this.renderCoverArt(),t=this.$("> header"),this.dockTabsAt=t.height()+t.offset().top-$("body > header.app").height(),App.$window.on("scroll.fair",this.onScroll),this.selectTab(this.options.tab,this.options.subTab?!1:!0),this.footer||(this.footer=new App.Views.FairFooter({parent:this,model:this.model,fair:this.fair,el:this.$("section.fair_footer")}))},i.prototype.setFrameTitle=function(){return this.frameTitle=this.model.displayName()},i.prototype.onProfileChange=function(){return this.setFrameTitle(),this.$("header figcaption").html(JST["templates/profiles/show_bio"]({profile:this.model,isMe:this.isMe}))},i.prototype.onTabClick=function(t){var e;return e=$(t.target).attr("class"),e===this.currentTabName?!1:(this.onScroll(),Analytics.click("Clicked Fair tab "+e),this.selectTab(e),App.$body.removeClass("dock_tabs"),!1)},i.prototype.onScrollArrowClick=function(){return $("html, body").animate({scrollTop:0})},i.prototype.onScroll=function(){return App.currentFrameName!==this.frameName?App.$body.removeClass("dock_tabs"):App.$window.scrollTop()<this.dockTabsAt?App.$body.removeClass("dock_tabs"):App.$body.hasClass("dock_tabs")?void 0:App.$body.addClass("dock_tabs")},i.prototype.onLoad=function(){var t;return i.__super__.onLoad.apply(this,arguments),this.selectTab(null!=(t=this.options)?t.tab:void 0,!1),App.$window.on("scroll.fair",this.onScroll)},i.prototype.onUnload=function(){return i.__super__.onUnload.apply(this,arguments),App.$window.off(".fair"),App.$body.removeClass("dock_tabs"),this.stopListening(this.model)},i.prototype.ensurePostsFetched=function(t){var e=this;return this.postsFetched?t():(this.fetchingPosts||(this.fetchingPosts=!0,this.posts=new App.Collections.FeedItems,this.posts.urlRoot="/api/v1/profile/"+this.model.get("id")+"/posts",this.posts.type="posts",this.posts.fetchFeedItems({success:function(){return e.postsFetched=!0,e.trigger("postsFetched")}})),this.on("postsFetched",t))},i.prototype.renderFollows=function(){return this.$(".followers").text(this.model.formatFollowText())},i.prototype.setDocumentTitle=function(){return App.$document.attr("title",_.htmlDecode(""+this.fair.get("name")+" | Artsy"))},i}(App.TabbedFrame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Profiles.Frame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#profiles",o.prototype.frameName="profiles",o.prototype.initialize=function(){if(!this.options.orderedSetKey)throw"You must pass orderedSetKey";return this.orderedSetKey=this.options.orderedSetKey},o.prototype.render=function(){var t=this;return this.$el.addClass("loading").show(),this.setDocumentTitle(),App.Collections.OrderedSets.fetchFromUrl("/api/v1/sets?key="+this.orderedSetKey,{success:function(e){var r,o;return r=null!=(o=e.first())?o.get("id"):void 0,t.collection=new App.Collections.Profiles,t.collection.url="/api/v1/set/"+r+"/items",t.collection.defaultPageSize=20,t.collection.fetchAllPages().then(function(){return t.onAllPagesFetched()})}})},o.prototype.getListViewClass=function(){return"institutions"===this.options.orderedSetKey?App.Views.Partners.InstitutionsList:void 0},o.prototype.setDocumentTitle=function(){return"institutions"===this.options.orderedSetKey?App.$document.attr("title","Browse Museums, Organizations, and Other | Artsy"):void 0},o}(App.Views.Shared.AToZFrame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.GalleryProfileFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#partner_profile_show",o.prototype.frameName="galleryProfile",o.prototype.contentRendered=!1,o.prototype.events={"click p.show_all_link a":"onShowAllClick","click .tabs a":"onTabClick"},o.prototype.tabs={overview:function(){return new App.Views.PartnerProfileOverview({el:this.$(".tabcontent .overview"),tabs:this.tabs,model:this.model,parent:this,partner:this.partner})},shows:function(){return new App.Views.PartnerProfileShows({el:this.$(".tabcontent .shows"),model:this.model})},artists:function(){return new App.Views.PartnerProfileArtists({el:this.$(".tabcontent > .artists"),model:this.model,parent:this,tab:this.options.tab,tabObjId:this.options.tabObjId})},contact:function(){return new App.Views.PartnerProfileContact({el:this.$(".tabcontent .contact"),model:this.partner})},posts:function(){return new App.Views.ProfilePosts({el:this.$(".tabcontent section.posts"),isMe:!0,model:this.model})},tour:function(){return new App.Views.PartnerProfileTour({el:this.$(".tabcontent .tour"),model:this.partner})}},o.prototype.defaultTabName=function(){return this.partner.hasTab("shows")?"shows":this.partner.hasTab("artists")?"artists":this.partner.hasTab("posts")?"posts":this.partner.hasTab("contact")?"contact":this.partner.hasTab("tour")?"tour":"overview"},o.prototype.initialize=function(){return this.resetTabViews(),this.tabNames=_.keys(this.tabs).join(" "),this.baseUrl="/"+this.model.get("id"),this.partner=this.model.get("owner"),this.initialTab="overview",null!=this.options.tab&&(this.initialTab=this.options.tab),this.renderPreloader()},o.prototype.render=function(){var t=this;if(null!=this.partner)return null!=this.options.tab&&(this.initialTab=this.options.tab),App.Repositories.Partners.getOrFetch(this.partner.get("id"),["name"],{success:function(e){return t.updateParamOptions(),t.model.set("owner",e),t.partner=e,App.$document.attr("title",""+e.getRaw("name")+" | Artsy"),t.renderPartner()}})},o.prototype.renderPartner=function(){var t=this;return this.$el.html(JST["templates/profiles/partner/gallery/frame"]({partner:this.partner,profile:this.model,isMe:!1,baseUrl:this.baseUrl})).show(),App.Repositories.Partners.getOrFetch(this.partner.get("id"),["email","has_full_profile","floored_tour"],{success:function(e){return t.partner.initialShowsFetched()?t.renderShows():(t.listenTo(e,"change:initialShowsFetched",t.renderShows),e.fetchShows()),t.partner.allArtistsFetched()?t.renderArtists():(t.listenTo(e,"change:artistsFetched",t.renderArtists),e.fetchAllArtists())}})},o.prototype.renderTabs=function(){var t,e,r;if((null!=(e=this.partner)?e.allArtistsFetched():void 0)&&(null!=(r=this.partner)?r.initialShowsFetched():void 0))return t=this.$(".tabs"),t.removeClass("disabled").html(JST["templates/profiles/partner/gallery/_tabs"]({baseUrl:"/"+this.model.get("id"),partner:this.partner,profile:this.model})),this.listenTo(this,"tabChange",this.onTabChange),"artist"===this.initialTab?this.onTabChange(this.initialTab):this.selectTab(this.initialTab,!0,!0),this.updateTabs()},o.prototype.renderPreloader=function(){return this.$el.addClass("loading").html('<div class="pre_loader"></div>').show()},o.prototype.renderContent=function(){var t,e;if(((null!=(t=this.partner)?t.allArtistsFetched():void 0)||(null!=(e=this.partner)?e.initialShowsFetched():void 0))&&!this.contentRendered)return this.contentRendered=!0,this.$el.removeClass("loading"),this.$tabSections=this.$(".tabcontent > section"),this.initializeOverview(),this.renderFollows(),this.renderTabs()},o.prototype.initializeOverview=function(){return this.selectTab("overview",!0,!1)},o.prototype.renderShows=function(){return this.renderContent(),this.tabViews.overview.renderShows(),this.renderTabs()},o.prototype.renderArtists=function(){return this.renderContent(),this.tabViews.overview.renderArtists(),this.renderTabs()},o.prototype.renderFollows=function(){var t=this;return this.profileFollowView||(this.profileFollowView=new App.Views.ProfileFollow({el:this.$(".follow_actions"),model:this.model})),this.profileFollowView.render(),this.listenTo(this.model,"change:follows_count",function(){return t.$(".followers").text(t.model.formatFollowText())})},o.prototype.setDocumentTitle=function(){var t;return App.$document.attr("title",_.htmlDecode(""+(null!=(t=this.partner)?t.get("name"):void 0)+" | Artsy"))},o.prototype.updateParamOptions=function(){var t,e;return App.router.viewState.get(this.frameName).params&&(t=App.router.viewState.get(this.frameName).params,this.options.tab=t.tab,this.options.tabObjId=t.tabObjId,null!=(null!=(e=this.options)?e.tab:void 0))?this.selectTab(this.options.tab,!1,!0):void 0},o.prototype.onTabClick=function(t){var e;return e=$(t.currentTarget).data("tab"),e===this.currentTabName?!1:(this.selectTab(e,!0,!0),!1)},o.prototype.inactiveSectionSelector=function(){return".tabcontent > section:not(."+this.currentTabName+")"},o.prototype.onTabChange=function(t){var e,r,o;switch(this.$tabSections.hide(),"artists"!==t&&null!=(e=this.tabViews.artists)&&e.unbindScroll(),t){case"artists":return this.tabViews.artists.$el.show();case"artist":return this.selectTab("artists",!1,!1),null!=(r=this.tabViews.artists)?r.showTab(this.options.tabObjId):void 0;case"posts":return this.tabViews.posts.$el.show(),(null!=(o=this.tabViews.posts.feed)?o:this.tabViews.posts.renderFeed()).reRender();case"contact":return this.tabViews.contact.$el.show();case"tour":if(App.currentUser.hasLabFeature("Partner Tour"))return this.tabViews.tour.$el.show();break;case"shows":return this.tabViews.shows.showTab();default:return this.tabViews.overview.$el.show()}},o.prototype.onShowAllClick=function(t){var e,r;return window.scrollTo(0,0),e=$(t.target),window.location.pathname===e.attr("href")?!1:(r=e.data("tab")?e.data("tab"):_.last($(t.target).attr("href").split("/")),this.selectTab(r,!0,!0),!1)},o.prototype.updateTabs=function(){return this.partner.has("shows")&&0!==this.partner.get("shows").length?void 0:(this.$(".tabs .shows").hide(),this.$(".tabs .overview").hide())},o.prototype.isRendered=function(t){var e;return t.profileId!==(null!=(e=this.model)?e.get("id"):void 0)?!1:this.contentRendered},o.prototype.onLoad=function(){var t;return o.__super__.onLoad.apply(this,arguments),this.selectTab(null!=(t=this.options)?t.tab:void 0,!1)},o.prototype.onUnload=function(){return o.__super__.onUnload.apply(this,arguments),this.contentRendered=!1,this.options.tab=this.currentTab,this.scrollTopVal=App.$window.scrollTop()},o}(App.TabbedFrame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.InstitutionCollection=function(r){function i(){return this.storeCurrentArtworkSet=e(this.storeCurrentArtworkSet,this),this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),this.renderArtworks=e(this.renderArtworks,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.ArtworkColumns),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via IPP Collection",i.prototype.analyticsSaveMessage="Added artwork to collection, via IPP Collection",i.prototype.waiting=!1,i.prototype.events={"click a.img_container":"storeCurrentArtworkSet"},i.prototype.initialize=function(){var t=this;return this.render(),this.collection.fetchNextPage().then(function(e){return t.renderArtworks(e)})},i.prototype.bindWindowEvents=function(){var t=this;return this.onScrollThrottled=_.debounce(function(){return t.onScroll()},75),App.$window.on("scroll.ippArtworks",this.onScrollThrottled)},i.prototype.unbindWindowEvents=function(){return App.$window.off(".ippArtworks")},i.prototype.render=function(){return this.columns=new App.Views.ArtworkColumns({el:this.el,collection:this.collection,numberOfColumns:4,guttarWidth:40}),this.$el.removeClass("loading").html(this.columns.$el),this.bindWindowEvents()},i.prototype.renderArtworks=function(t){var e=this;return this.columns.appendArtworks(new App.Collections.Artworks(t).models),this.$("img").load(function(){return $(this).removeClass("loading")}),_.defer(function(){return e.initializeArtworksFromDom()})},i.prototype.onUnload=function(){return this.unbindWindowEvents()},i.prototype.onLoad=function(){return this.$el.show(),this.columns.$el.show(),this.bindWindowEvents()},i.prototype.onScroll=function(){var t,e=this;return this.collection.doneFetching&&this.unbindWindowEvents(),this.collection.doneFetching||this.waiting?void 0:(t=App.$window.height()+App.$window.scrollTop(),t>=this.$el.height()-1e3?(this.waiting=!0,this.collection.fetchNextPage().then(function(t){return e.waiting=!1,e.renderArtworks(t)})):void 0)},i.prototype.storeCurrentArtworkSet=function(t){var e;return e=$(t.target).parent(".img_container"),App.currentArtworkSet=this.collection.models,App.currentArtworkIndex=this.$(".img_container").index(e),App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=this.model.getRaw("name")},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.InstitutionShows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.rendered=!1,this.model.fetchAllShows(),this.listenTo(this.model,"change:showsFetched",this.render),this.render()},o.prototype.render=function(){var t,e,r,o,i=this;if(this.model.allShowsFetched()&&0!==this.model.get("shows").length&&!this.rendered)return e=this.model.get("shows").featured(),t=this.model.get("shows").current(e),o=this.model.get("shows").upcoming(e),r=this.model.get("shows").past(e),this.$el.html(JST["templates/profiles/partner/shows"]({featured:e,current:t.models,upcoming:o.models,past:r.models,partner:this.model})).removeClass("loading").show(),this.rendered=!0,this.model.get("shows").each(function(t){return i.listenTo(t.get("artworks"),"change add remove",function(){return i.renderShowImage(t)}),t.fetchPosterImage()})},o.prototype.onLoad=function(){return this.initialize()},o.prototype.renderShowImage=function(t){return!this.posterImageRendered&&t.posterImageUrl()?(this.$("figure[data-show='"+t.get("id")+"'] .cover_image").css({"background-image":"url("+t.posterImageUrl()+")"}),this.posterImageRendered=!0):void 0},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.InstitutionProfileFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.el="#partner_profile_show",o.prototype.frameName="institutionProfile",o.prototype.contentRendered=!1,o.prototype.events={"click p.show_all_link a":"onShowAllClick","click .tabs a":"onTabClick"},o.prototype.tabs={shows:function(){return new App.Views.InstitutionShows({el:this.$("section.shows"),model:this.partner})
},collection:function(){return new App.Views.InstitutionCollection({el:this.$("section.collection"),model:this.partner,collection:this.partner.initializeNotForSaleArtworks()})},posts:function(){return new App.Views.ProfilePosts({el:this.$("section.posts"),model:this.model})},shop:function(){return new App.Views.InstitutionCollection({el:this.$("section.shop"),model:this.partner,collection:this.partner.initializeForSaleArtworks()})},about:function(){return new App.Views.PartnerProfileContact({el:this.$("section.about"),model:this.partner})}},o.prototype.initialize=function(){var t,e=this;return this.resetTabViews(),this.tabNames=_.keys(this.tabs).join(" "),this.baseUrl=this.model.searchPath(),this.partner=this.model.get("owner"),t=["name","displayable_shows_count","published_for_sale_artworks_count","published_not_for_sale_artworks_count"],App.Repositories.Partners.getOrFetch(this.partner.get("id"),t,{success:function(t){return e.contentRendered=!1,e.model.set("owner",t),e.partner=t,e.frameTitle=e.partner.getRaw("name"),e.render(),e.renderTabs()}})},o.prototype.defaultTabName=function(){var t,e,r,o;return(null!=(t=this.partner)?t.hasTab("shows"):void 0)?"shows":(null!=(e=this.partner)?e.hasTab("collection"):void 0)?"collection":(null!=(r=this.partner)?r.hasTab("posts"):void 0)?"posts":(null!=(o=this.partner)?o.hasTab("shop"):void 0)?"shop":"about"},o.prototype.render=function(){return null!=this.partner?this.contentRendered?this.$el.show():(this.contentRendered=!0,App.$document.attr("title",""+this.frameTitle+" | Artsy"),this.$el.html(JST["templates/profiles/partner/institution/frame"]({partner:this.partner,profile:this.model,isMe:!1,baseUrl:this.baseUrl})).show(),this.renderFollows()):void 0},o.prototype.isRendered=function(t){var e;return t.profileId!==(null!=(e=this.model)?e.get("id"):void 0)?!1:this.contentRendered},o.prototype.renderTabs=function(){var t,e,r;if(null!=this.partner)return t=this.$(".tabs"),t.removeClass("disabled").html(JST["templates/profiles/partner/institution/_tabs"]({baseUrl:this.baseUrl,partner:this.partner})),e=this.defaultTabName(),(null!=(r=this.options)?r.tab:void 0)&&(e=this.options.tab),this.selectTab(e,!0,!1)},o.prototype.renderFollows=function(){var t=this;return this.profileFollowView||(this.profileFollowView=new App.Views.ProfileFollow({el:this.$(".follow_actions"),model:this.model})),this.profileFollowView.render(),this.listenTo(this.model,"change:follows_count",function(){return t.$(".followers").text(t.model.formatFollowText())})},o.prototype.onTabClick=function(t){var e;return e=$(t.currentTarget).data("tab"),e===this.currentTabName?!1:(this.selectTab(e,!0,!0),!1)},o.prototype.onUnload=function(){return o.__super__.onUnload.apply(this,arguments),this.contentRendered=!1,this.options.tab=this.currentTab,this.scrollTopVal=App.$window.scrollTop()},o.prototype.onLoad=function(){var t;return o.__super__.onLoad.apply(this,arguments),this.selectTab(null!=(t=this.options)?t.tab:void 0,!1),this.$el.show()},o.prototype.afterUnload=function(){return App.router.viewState.unrenderFrame(this.frameName)},o}(App.TabbedFrame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfileEditIconBackground=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),this.keyup=e(this.keyup,this),this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="profile_edit_icon_background",i.prototype.events={dblclick:"onUnload"},i.prototype.initialize=function(){return $("profile_edit_icon_background").length?void 0:(App.$body.append(this.el,'<div id="profile_edit_icon"></div>'),this.render())},i.prototype.render=function(){return this.upload||(this.upload=new App.Views.ProfileEditIconUpload),this.upload.render(),this.onLoad(),App.$body.bind("keyup.profile_edit",this.keyup)},i.prototype.keyup=function(t){return t.keyCode===$.ui.keyCode.ESCAPE?this.onUnload():void 0},i.prototype.onLoad=function(){return this.$el.fadeIn()},i.prototype.onUnload=function(){return this.upload.onUnload(),$("#profile_edit_icon").fadeOut(),this.$el.fadeOut(),App.$body.unbind("keyup.profile_edit",this.keyup)},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfileEditIconCrop=function(r){function i(){return this.onStop=e(this.onStop,this),this.resizeDragContainer=e(this.resizeDragContainer,this),this.centerImage=e(this.centerImage,this),this.fitImageResizable=e(this.fitImageResizable,this),t=i.__super__.constructor.apply(this,arguments)}var n;return o(i,r),i.prototype.el="#profile_edit_icon",n="http://",i.prototype.events={"click .set_profile_icon":"setProfileIcon"},i.prototype.render=function(t){var e=this;return this.$el.html(JST["templates/profiles/icon/crop"]({profile:App.currentProfile})),this.imageURL=t,this.$cropGuide=this.$el.find(".crop_guide"),this.$dragContainer=this.$el.find(".drag_container"),this.$imageResizable=this.$el.find(".image_resizable"),this.$imageContainer=this.$imageResizable.find(".image_container"),this.$image=this.$imageContainer.find("img"),this.onLoad(),App.$window.on("resize.profile_edit",function(t,r){return r?void 0:e.resizeDragContainer()}),this},i.prototype.setProfileIcon=function(){var t,e;return e=this.$image.offset(),t=this.$cropGuide.offset(),this.$el.find(".ui-resizable-handle").fadeOut(),$.ajax({type:"PUT",url:"/api/v1/profile/"+App.currentProfile.get("id")+"/icon",data:{icon:this.imageURL,x:t.left-e.left,y:t.top-e.top,width:parseInt(this.$image.width(),10)},success:function(t){return App.profileEditIcon.onUnload(),App.currentProfile.set({icon:t})}}),this.$cropGuide.css({"box-shadow":"0px 0px 0px 2000px rgba(0, 0, 0, 1)","-webkit-box-shadow":"0px 0px 0px 2000px rgba(0, 0, 0, 1)"}),this.$el.find("button").fadeOut()},i.prototype.fitImageToCircle=function(){var t;return this.circleDiameter=this.$cropGuide.outerHeight(!1),this.circleMargin=(this.$cropGuide.outerHeight(!1)-this.$cropGuide.height())/2,this.originalImageHeight=this.$image.height(),this.originalImageWidth=this.$image.width(),Math.min(this.originalImageHeight,this.originalImageWidth)>this.circleDiameter?(t=this.circleDiameter/Math.min(this.originalImageHeight,this.originalImageWidth),this.$image.height(this.originalImageHeight*t),this.$image.width(this.originalImageWidth*t)):void 0},i.prototype.fitImageResizable=function(){return this.$imageResizable.css({height:this.$image.height(),width:this.$image.width()}),this.$image.css({"max-width":"100%","max-height":"100%"})},i.prototype.centerImage=function(){return this.fitImageResizable(),this.$imageResizable.css({top:"-"+(this.$imageResizable.height()/2-this.circleMargin)+"px",left:"-"+(this.$imageResizable.width()/2-this.circleMargin)+"px"})},i.prototype.growImageToContainCircle=function(t){var e,r,o,i,n,s,a,l,p;return r=this.$imageResizable,a=this.circleDiameter/2-this.circleMargin,l=null!=(p=t.tolerance)?p:2,r.position().top>-a+l&&(s=-a),r.position().top+r.height()<a-l&&(o=a),r.position().left>-a+l&&(i=-a),r.position().left+r.width()<a-l&&(n=a),null==i&&(i=n?n-r.width():r.position().left),null==s&&(s=o?o-r.height():r.position().top),e={left:""+i+"px",top:""+s+"px"},this.$image.animate(e,{duration:"fast"}),this.$imageResizable.animate(e,{duration:"fast",complete:function(){return null!=t?"function"==typeof t.success?t.success():void 0:void 0}})},i.prototype.resizeDragContainer=function(){var t,e,r,o;return e=this.circleDiameter/2,r=this.$imageResizable.height()-e,o=this.$imageResizable.width()-e,t=this.$cropGuide.offset(),this.$dragContainer.css({top:t.top+e-r,left:t.left+e-o,height:2*r,width:2*o})},i.prototype.onStop=function(){return this.growImageToContainCircle({tolerance:2,success:this.resizeDragContainer})},i.prototype.onLoad=function(){var t=this;return this.$image.attr("src",this.imageURL),this.$image.imagesLoaded(function(){return t.fitImageToCircle(),t.$imageResizable.resizable({handles:"ne, nw, se, sw",aspectRatio:!0,minHeight:t.circleDiameter,minWidth:t.circleDiameter,maxHeight:t.originalImageHeight,maxWidth:t.originalImageWidth,alsoResize:t.$image,stop:t.onStop}),t.$imageResizable.draggable({cancel:".drag_handle",containment:".drag_container"}),t.centerImage(),t.resizeDragContainer(),t.$image.css({visibility:"visible"})})},i.prototype.onUnload=function(){return this.$el.fadeOut(),App.$window.off("resize.profile_edit",this.resizeDragContainer)},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfileEditIconUpload=function(r){function i(){return this.onUnloadAll=e(this.onUnloadAll,this),this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#profile_edit_icon",i.prototype.events={"click .cancel":"onUnloadAll"},i.prototype.initialize=function(){var t=this;return App.$body.fileupload?this.render():null!=App.fileUploadUrl?$.ajax({url:App.fileUploadUrl,dataType:"script",cache:!0,success:function(){return t.render()}}):App.showError("Error loading file_upload.js.")},i.prototype.render=function(t){var e,r,o,i=this;if(App.$body.fileupload)return this.$el.html(JST["templates/profiles/icon/upload"]()),this.$upload=this.$el.find(".upload_container"),r=this.$el.find(".file_upload"),o=this.$el.find(".upload_status"),e=this.$el.find(".border"),this.debounceDragOver=_.debounce(function(){return e.removeClass("dragover")},100),t&&o.html(t),r.fileupload({acceptFileTypes:/(\.|\/)(gif|jpe?g|png|tiff)$/i,maxFileSize:3e6,dropZone:App.$document,add:function(t,n){return o.addClass("progress_status").html("UPLOADING"),e.removeClass("dragover"),r.hide(),i.$upload.find(".cancel").hide(),i.$upload.find(".progress").show(),n.submit()},done:function(t,e){var o;return o=e.result.image_url.replace(":version","original"),r.fileupload("destroy"),i.crop||(i.crop=new App.Views.ProfileEditIconCrop),i.crop.render(o),i.onUnload()},progress:function(t,e){var r;return r=parseInt(100*(e.loaded/e.total),10),i.$upload.find(".progress_bar").animate({width:""+r+"%"})},dragover:function(){return e.addClass("dragover"),i.debounceDragOver()},fail:function(t,e){var r;if(r=e.files[0].error)switch(r){case"maxFileSize":return i.render("Please upload an image smaller than 3 MB");case"acceptFileTypes":return i.render("Please upload a png, jpeg, gif, or tiff");default:return i.render("There was a problem uploading your file")}},stop:function(){return!1}}),this.onLoad(),App.router.on("all",this.onUnloadAll,this),this},i.prototype.onLoad=function(){return this.$el.fadeIn(),this.$upload.fadeIn()},i.prototype.onUnload=function(){return this.$upload.fadeOut()},i.prototype.onUnloadAll=function(){var t;return this.onUnload(),null!=(t=this.crop)&&t.onUnload(),App.profileEditIcon.onUnload()},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ProfileHeader=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.iconHeight=140,o.prototype.initialize=function(){var t,e;return this.$figcaption=this.$("figcaption"),t=0,this.$figcaption.height()<this.iconHeight&&(t=Math.floor((this.iconHeight-this.$figcaption.height())/2)),e={"margin-top":""+t+"px",visibility:"visible"},this.$figcaption.css(e)},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ProfileIcon=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){var t;return App.currentProfile&&App.currentProfile.get("id")===(null!=(t=this.model)?t.get("id"):void 0)?App.currentProfile.on("change:icon",this.render,this):void 0},o.prototype.render=function(){return this.$el.html(JST["templates/profiles/icon"]({profile:this.model}))},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfilePopover=function(r){function i(){return this.hide=e(this.hide,this),this.show=e(this.show,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .follow a":"follow","click .following a":"unfollow"},i.prototype.followText="Follow",i.prototype.unFollowText="Unfollow",i.prototype.followingText="Following",i.prototype.initialize=function(){return this.options.target.append(JST["templates/profiles/popover"]({profile:this.model,followText:this.followText,followingText:this.followingText,isMe:this.options.isMe})),this.setElement(this.options.target.find(".profile_popover")),this.options.target.hoverIntent({over:this.show,out:this.hide,timeout:600})},i.prototype.show=function(){return this.$el.css({top:this.options.target.position().top-33,left:this.options.target.width()+25}),this.$el.show()},i.prototype.hide=function(){return this.$el.hide()},i.prototype.onFollowChange=function(t,e){return t?e.text("Following").parent().addClass("following").removeClass("follow"):e.text("Follow").parent().addClass("follow").removeClass("following")},i.prototype.follow=function(t){var e,r=this;return App.isMessageVisible()?!1:App.currentUser.accountCreated()?(e=$(t.target),Analytics.click("Followed profile, via profile popover",this.model),this.onFollowChange(!0,e),e.removeClass("committed"),this.model.follow({success:function(){return e.addClass("committed")},error:function(){return r.onFollowChange(!1,e)}}),!1):App.loginSignupDialog.show("followProfile")},i.prototype.unfollow=function(t){var e,r=this;return App.isMessageVisible()?!1:(e=$(t.target),Analytics.click("Unfollowed profile, via profile popover",this.model),this.onFollowChange(!1,e),e.removeClass("committed"),this.model.unfollow({success:function(){return e.addClass("committed")},error:function(){return r.onFollowChange(!0,e)}}),!1)},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfilePosts=function(r){function i(){return this.onLoad=e(this.onLoad,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.fetched=!1,i.prototype.events={"click a.add_to_post_button":"addToPost"},i.prototype.initialize=function(){return this.isMe=this.options.isMe,this.fetchPosts(),App.router.viewState.bind("frameLoad:"+App.currentFrameName,this.onLoad,this),App.router.viewState.bind("frameUnload:"+App.currentFrameName,this.onUnload,this)},i.prototype.render=function(){var t,e;if(this.fetched)return(null!=(e=this.posts)?e.length:void 0)<1?(this.$el.removeClass("loading"),this.showEmpty()):this.hideEmpty(),"function"==typeof(t=this.options).afterLoad&&t.afterLoad(),this},i.prototype.renderFeed=function(){return this.feed=new App.Views.Feed({feedItems:this.posts,el:this.$el,profile:this.model})},i.prototype.fetchPosts=function(){var t=this;return this.posts=new App.Collections.FeedItems,this.posts.urlRoot="/api/v1/profile/"+this.model.get("id")+"/posts",this.posts.type="posts",this.posts.fetchFeedItems({pageSize:5,success:function(e){var r,o,i;return e.length>0&&0===e.removeFlagged().length?t.fetchPosts({cursor:e.cursor}):(t.posts.length>0?t.renderFeed():t.showEmpty(),"function"==typeof(r=t.options).afterFetch&&r.afterFetch(t.posts),t.isMe&&null!=(o=App.currentProfile)&&o.on("newPost",t.onNewPost,t),t.isMe&&null!=(i=App.currentProfile)&&i.on("removePost",t.onRemovePost,t),t.fetched=!0,t.render())}})},i.prototype.onRemovePost=function(){return this.$(".feed_items .feed_item").length<1?this.showEmpty():void 0},i.prototype.onNewPost=function(t){var e,r;if(0===this.$("li[data-post="+t.get("id")+"]").length)return e=new App.Models.FeedItem(t.attributes),this.posts.add(e),null==this.posts.comparator&&(this.posts.comparator=function(t){return-new Date(t.get("published_at")).valueOf()}),this.posts.sort(),(null!=(r=this.feed)?r:this.renderFeed()).reRender()},i.prototype.addToPost=function(){return Analytics.click("Clicked Add Post, via user profile page"),App.currentUser.accountCreated()?App.postDialog.openDialog():App.loginSignupDialog.show("addToPost")},i.prototype.removeVideoIFrames=function(){return this.$(".video_link .video").hide().html(""),this.$(".video_link .placeholder").show()},i.prototype.onLoad=function(){var t,e;return this.render(),null!=(e=this.feed)&&e.onLoad(),"function"==typeof(t=this.options).afterLoad?t.afterLoad():void 0},i.prototype.onUnload=function(){var t;return this.removeVideoIFrames(),null!=(t=this.feed)?t.onUnload():void 0},i.prototype.showEmpty=function(){return this.$el.html(JST["templates/profiles/show_posts"]({profile:this.model,isMe:this.isMe})),this.$(".empty").show()},i.prototype.hideEmpty=function(){return this.$(".empty").hide()},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ProfileFollow=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.followText="Follow",o.prototype.followingText="Following",o.prototype.events={"click .follow a":"followProfile","click .following a":"unfollowProfile"},o.prototype.initialize=function(){var t=this;return App.currentUser.get("followProfiles").bind("add:"+this.model.get("id"),function(){return t.onFollowChange(!0)}),App.currentUser.get("followProfiles").bind("remove:"+this.model.get("id"),function(){return t.onFollowChange(!1)}),App.currentUser.get("followProfiles").syncFollows()},o.prototype.render=function(){return this.$el.html(JST["templates/profiles/follow"]({profile:this.model,followText:this.followText,followingText:this.followingText})),this.$(".profile a").show()},o.prototype.followProfile=function(t){var e=this;return App.currentUser.accountCreated()?(_.isNumber(this.model.get("follows_count"))&&this.model.set("follows_count",this.model.get("follows_count")+1),this.$(".profile a").removeClass("committed"),App.follow(t,this.model,{success:function(){return e.$(".profile a").addClass("committed")},error:function(){return e.onFollowChange(!1)}}),App.showMessage(this.model.followMessage()),Analytics.click("Followed profile",this.model),this.onFollowChange(!0),!1):App.loginSignupDialog.show("followUser")},o.prototype.unfollowProfile=function(t){var e=this;return App.currentUser.accountCreated()?(_.isNumber(this.model.get("follows_count"))&&this.model.set("follows_count",this.model.get("follows_count")-1),this.$(".profile a").removeClass("committed"),App.unfollow(t,this.model,{success:function(){return e.$(".profile a").addClass("committed")},error:function(){return e.onFollowChange(!0)}}),App.showMessage(this.model.unfollowMessage()),Analytics.click("Unfollowed profile",this.model),this.onFollowChange(!1),!1):App.loginSignupDialog.show("followUser")},o.prototype.onFollowChange=function(t){return t?this.$(".profile a").show().text(this.followingText).parent().addClass("following").removeClass("follow"):this.$(".profile a").show().text(this.followText).parent().addClass("follow").removeClass("following")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.ProfileShowNavItem=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={click:"onClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},o.prototype.initialize=function(){return this.$el.wrap('<a href="/'+App.currentProfile.get("id")+'">'),this.$el=this.$el.parent(),this.delegateEvents(this.events),this.$userNavItem=this.options.userNavItem,this.$userNav=$("#user_nav")},o.prototype.onClick=function(t){return this.$userNavItem.addClass("active"),"none"===this.$userNav.css("display")&&t.preventDefault(),App.router.navigate("/"+App.currentProfile.get("id"),{trigger:!0}),!1},o.prototype.onMouseEnter=function(){return this.$userNavItem.addClass("over")},o.prototype.onMouseLeave=function(){return this.$userNavItem.removeClass("over")},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.SmallFairBrowse=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.templateName="templates/fairs/small_browse",o.prototype.skipNavigate=!0,o}(App.Views.FairBrowse)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SmallFairOrganizerFrame=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.CoverArt),_.extend(i.prototype,App.Mixins.ShareButtons),i.prototype.el="#small_fair_profile",i.prototype.frameName="smallFairProfile",i.prototype.minCoverHeight=220,i.prototype.maxCoverHeight=300,i.prototype.percentBrowserHeight=.3,i.prototype.defaultBrowseTabName="partnerShowsList",i.prototype.isRendered=function(t){return this.profileId===(null!=t?t.profileId:void 0)},i.prototype.initialize=function(){return this.fair=this.model.get("owner").get("defaultFair"),this.profileId=this.options.profileId,App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=this.model.get("name"),this.frameTitle=this.model.displayName()},i.prototype.render=function(){var t=this;return this.$el.html(JST["templates/profiles/small_fair_organizer/show"]({profile:this.model,fair:this.fair})).show(),this.$coverArt=this.$(".cover_art"),this.fair.hasImage()&&this.renderCoverArt(),this.renderShareButtons(),this.onLoad(),this.fair.ensureFeaturedLinksFetched(function(){return t.renderProfileFeatures(),t.renderCuratorLinks(),t.repositionDockedOptions()}),_.defer(function(){var e,r,o,i,n,s;return"browse"===(null!=(e=t.options)?e.tab:void 0)&&"partnerShow"===(null!=(r=t.options)?r.subTab:void 0)&&(null!=(o=t.options)?o.partnerId:void 0)&&t.renderIndividualShow(t.options.partnerId),"browse"===(null!=(i=t.options)?i.tab:void 0)&&"artist"===(null!=(n=t.options)?n.subTab:void 0)&&(null!=(s=t.options)?s.artistId:void 0)&&t.renderIndividualArtist(t.options.artistId),_.defer(function(){return t.renderBrowse()})})},i.prototype.renderShareButtons=function(){var t,e,r;return t=this.model.searchPath(),null!=t?(r=""+App.canonicalUrl+t,e=""+this.model.get("owner").get("name")+" on Artsy",this.initializeShareButtons({text:e,url:r})):void 0},i.prototype.renderProfileFeatures=function(){return null!=this.fair.get("primaryLinks")?this.$(".profile_features").html(JST["templates/profiles/small_fair_organizer/features"]({orderedSet:this.fair.get("primaryLinks")})).css("display","inline-block"):void 0},i.prototype.renderCuratorLinks=function(){return null!=this.fair.get("curatorLinks")?this.$(".curator_featured_links").html(JST["templates/features/profiles"]({orderedSet:this.fair.get("curatorLinks")})).css("display","inline-block"):void 0},i.prototype.repositionDockedOptions=function(){var t;return null!=(t=this.browse)?t.repositionDockedOptions():void 0},i.prototype.renderIndividualShow=function(t){return this.partnerShowView=new App.Views.FairPartnerShow({el:this.$(".individual_show .partner_show .feed"),model:this.model,fair:this.fair,parent:this,partnerId:t}),this.$(".individual_artist").hide(),this.$(".individual_show").show(),$("html, body").scrollTop(this.$(".individual_show").offset().top),this.repositionDockedOptions()},i.prototype.renderIndividualArtist=function(t){return this.artistView=new App.Views.FairArtist({el:this.$(".individual_artist .artist .feed"),model:this.model,fair:this.fair,parent:this,artistId:t}),this.$(".individual_show").hide(),this.$(".individual_artist").show(),$("html, body").scrollTop(this.$(".individual_artist").offset().top),this.repositionDockedOptions()},i.prototype.renderBrowse=function(){var t=this;return("partnerShow"===this.options.subTab||"artist"===this.options.subTab)&&(this.options.subTab=this.defaultBrowseTabName),this.browse=new App.Views.SmallFairBrowse({el:this.$("section.browse"),model:this.model,fair:this.fair,parent:this}),this.browse.browseModel.bind("change",function(){var e;return e=t.browse.browseModel.get("tab"),"partnerShow"===e&&t.renderIndividualShow(t.browse.browseModel.get("partnerId")),"artist"===e?t.renderIndividualArtist(t.browse.browseModel.get("artistId")):void 0}),_.delay(function(){return t.repositionDockedOptions()},800)},i.prototype.onResize=function(){return this.$(".curated_content, .summary").width(this.$(".filtered_artworks").width())},i.prototype.onLoad=function(){var t=this;return App.IS_PHONE||App.$window.on("resize.small_fair",_.debounce(function(){return t.onResize()},300)),this.browse?_.defer(function(){return t.browse.onLoad()}):void 0},i.prototype.onUnload=function(){return App.$window.off(".small_fair"),this.stopListening(this.model),this.browse.onUnload()},i.prototype.cleanupFeedItems=function(t){var e,r,o,i,n;for(i=t.models,n=[],r=0,o=i.length;o>r;r++)e=i[r],n.push(e.set({_type:"PartnerShow"}));return n},i}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.EditPublicProfile=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.initialize=function(){return this.$el.html(JST["templates/profiles/user/edit_public_profile"]({profile:this.model})).show()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.UserProfileShow=function(r){function i(){return this.onUnload=e(this.onUnload,this),this.onLoad=e(this.onLoad,this),this.afterPostsFetched=e(this.afterPostsFetched,this),this.handleEmptyPosts=e(this.handleEmptyPosts,this),this.handleEmptyFavorites=e(this.handleEmptyFavorites,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#user_profile_show",i.prototype.frameName="userProfile",i.prototype.defaultTabName="posts",i.prototype.isRendered=function(t){return this.profileId===(null!=t?t.profileId:void 0)},i.prototype.tabs={posts:function(){return new App.Views.ProfilePosts({el:this.$("section.posts"),model:this.model,isMe:this.isMe,afterFetch:this.afterPostsFetched})},favorites:function(){return new App.Views.UserFavorites({el:this.$("section.favorites"),model:this.getOwner(),showEmpty:this.handleEmptyFavorites,hideEmpty:function(){}})}},i.prototype.events={"click .tabs a":"onTabClick","click header a.add_to_post_button":"addToPost"},i.prototype.initialize=function(){var t;return this.isMe=null!=(t=this.model)?t.isCurrentProfile():void 0,this.baseUrl=this.model.searchPath()},i.prototype.render=function(){var t,e,r=this;return i.__super__.render.apply(this,arguments),this.$el.removeClass("loading").addClass(this.defaultTabName).html(JST["templates/profiles/user/show"]({profile:this.model,isMe:this.isMe})).show(),this.setFrameTitle(),this.isMe?(this.model=App.currentProfile,App.currentProfile.on("change",this.onProfileChange,this),App.currentUser.on("change",this.onProfileChange,this)):(this.profileFollowView||(this.profileFollowView=new App.Views.ProfileFollow({el:this.$(".follow_actions"),model:this.model})),this.profileFollowView.render()),this.profileId=this.model.get("id"),this.fetchUserCollection(),"favorites"===(null!=(t=this.options)?t.tab:void 0)&&this.fetchUserPosts(),this.selectTab(null!=(e=this.options)?e.tab:void 0,!1),this.profileHeaderView||(this.profileHeaderView=new App.Views.ProfileHeader({el:this.$("> header")})),this.isMe&&!this.profileEditView&&App.Repositories.Profiles.getOrFetch(this.model.get("id"),["private"],{success:function(t){return t.get("private")?r.profileEditView||(r.profileEditView=new App.Views.EditPublicProfile({el:r.$("section.edit_profile"),model:r.model})):void 0}}),this.listenTo(this.model,"change:follows_count reset sync",this.renderFollows)},i.prototype.getOwner=function(){return this.isMe?App.currentUser:this.model.get("owner")},i.prototype.onTabClick=function(t){var e;return e=$(t.target).attr("class").split(" ")[0],e===this.currentTabName?!1:(Analytics.click("Clicked Profile tab "+e),this.selectTab(e),!1)},i.prototype.fetchUserCollection=function(){var t,e=this;return t=this.getOwner(),t.initializeDefaultArtworkCollection({success:function(){return t.defaultArtworkCollection().displayable()?(e.hasCollection=!0,e.renderTabs()):e.handleEmptyFavorites()},error:function(t){return 403===t.status&&(t.suppressAppMessages=!0),e.handleEmptyFavorites()}})},i.prototype.fetchUserPosts=function(){var t;return t=new App.Collections.FeedItems,t.urlRoot="/api/v1/profile/"+this.model.get("id")+"/posts",t.type="posts",t.fetchFeedItems({pageSize:5,success:this.afterPostsFetched,error:this.handleEmptyPosts})},i.prototype.handleEmptyFavorites=function(){return this.hasCollection=!1,this.renderTabs(),this.selectTab(this.defaultTabName)},i.prototype.handleEmptyPosts=function(){return this.hasPosts=!1,this.renderTabs(),this.selectTab("favorites")},i.prototype.afterPostsFetched=function(t){return(null!=t?t.length:void 0)>0?(this.hasPosts=!0,this.renderTabs()):this.handleEmptyPosts()},i.prototype.renderTabs=function(){return null!=this.hasPosts&&null!=this.hasCollection?(this.$("header .tabs").html(JST["templates/profiles/user/tabs"]({hasPosts:this.hasPosts,hasCollection:this.hasCollection,baseUrl:this.baseUrl})),this.$(".tabs ."+this.currentTabName).addClass("active")):void 0},i.prototype.onProfileChange=function(){return this.setFrameTitle(),this.$("header figcaption").html(JST["templates/profiles/show_bio"]({profile:this.model,isMe:this.isMe}))},i.prototype.renderFollows=function(){return this.$(".followers").text(this.model.formatFollowText())},i.prototype.setDocumentTitle=function(){return App.$document.attr("title",_.htmlDecode(""+this.model.displayName()+" | Artsy"))},i.prototype.setFrameTitle=function(){return this.frameTitle=this.model.displayName()},i.prototype.onLoad=function(){var t;return i.__super__.onLoad.apply(this,arguments),this.onProfileChange(),this.selectTab(null!=(t=this.options)?t.tab:void 0,!1)},i.prototype.onUnload=function(){return i.__super__.onUnload.apply(this,arguments),this.stopListening(this.model)},i.prototype.addToPost=function(){return Analytics.click("Clicked Add Post, via user profile page"),App.currentUser.accountCreated()?App.postDialog.openDialog():App.loginSignupDialog.show("addToPost")},i}(App.TabbedFrame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.CreateAccountDialog=function(r){function i(){return this.onHide=e(this.onHide,this),this.onShow=e(this.onShow,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#create_account_modal",i.prototype.handle="create-account",i.prototype.width=function(){return 900
},i.prototype.events={"click .close, .show_form":"hide","click .terms a":"hideWithoutPreventDefault"},i.prototype.onShow=function(){var t,e,r,o;return null!=(t=App.currentFrameView)?null!=(e=t.exactMatch)?null!=(r=e.infoPanel)?null!=(o=r.viewInRoomView)?o.onUnload():void 0:void 0:void 0:void 0},i.prototype.showFinishCreateAccountForm=function(t,e,r){return null==t&&(t=""),null==e&&(e=""),this.$(".finish_create_account_form").length>0||this.$el.html(JST["templates/users/create_account_finish"]({name:t,email:e,provider:r})),this.finishCreateAccountForm||(this.finishCreateAccountForm=new App.Views.FinishCreateAccountForm({el:this.$(".finish_create_account_form")})),this.finishCreateAccountForm.render(r),this.show()},i.prototype.showCreateAccountForm=function(t){return this.$(".create_account_form").length>0||this.$el.html(JST["templates/users/create_account"]()),this.createAccountForm||(this.createAccountForm=new App.Views.CreateAccountForm({el:this.$(".create_account_form")})),this.createAccountForm.render({emailMode:t}),this.show()},i.prototype.onHide=function(){return Analytics.funnel("Exited create account popover")},i}(App.Views.ModalDialog)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.CreateAccountForm=function(r){function i(){return this.showEmailForm=e(this.showEmailForm,this),this.trackJoinWith=e(this.trackJoinWith,this),this.trackCreatedAccount=e(this.trackCreatedAccount,this),this.submitForm=e(this.submitForm,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click a.join_with_facebook":"joinWithFacebook","click a.join_with_twitter":"joinWithTwitter","click a.show_email_form":"showEmailForm","click .user_activation button.log_in":"submitForm","submit form":"submitForm"},i.prototype.initialize=function(){return this.$form=this.$(".user_activation"),this.setupFormInputs(),this.$socialSignUp=this.$(".social_sign_up"),this.$userSubmit=this.$form.find("button.log_in"),this.$userSubmit.after("<div class= 'spinner b_p'></div>")},i.prototype.render=function(t){return this.emailMode=t.emailMode,this.emailMode?this.showEmailForm():this.showSocialSignupForm(),Analytics.conversion("Initiated account creation")},i.prototype.submitForm=function(t){var e,r=this;return t.preventDefault(),this.loading?!1:(this.enableLoading(this.$userSubmit),this.validateForm()?(this.trackCreatedAccount(),e={name:this.$name.val(),email:this.$email.val(),password:this.$password.val()},this.createAndLogin(e)):(this.disableLoading(this.$userSubmit),this.$userSubmit.addClass("red"),_.delay(function(){return r.$userSubmit.removeClass("red")},500),!1))},i.prototype.createAndLogin=function(t){var e,r=this;return e=$.ajax({type:"POST",data:t,url:this.$form.attr("action"),error:this.handleError,success:function(o){return e=$.ajax({type:"POST",url:"/users/sign_in",data:{"user[email]":t.email,"user[password]":t.password,"user[remember_me]":!0},error:r.handleError,success:function(t,e,i){return o=JSON.parse(i.responseText),null!=o.trust_token?window.location.href="/users/sign_in?trust_token="+o.trust_token+"&remember_me=true&redirect_uri="+App.redirectUrl:r.redirectAfterLogin()}})}})},i.prototype.validateForm=function(){return this.validateName()&&this.validateEmail()&&this.validatePassword()},i.prototype.trackCreatedAccount=function(){return Analytics.conversion("Created account")},i.prototype.joinWithFacebook=function(){return this.loading?!1:(this.enableLoading(this.$("a.join_with_facebook")),this.trackJoinWith("Facebook"))},i.prototype.joinWithTwitter=function(){return this.loading?!1:(this.enableLoading(this.$("a.join_with_twitter")),this.trackJoinWith("Twitter"))},i.prototype.trackJoinWith=function(t){return this.trackCreatedAccount(),Analytics.click("Clicked 'Join with "+t+"'")},i.prototype.showEmailForm=function(){var t=this;return this.$socialSignUp.hide(),this.$("a.show_email_form").hide(),this.$form.fadeIn(250,function(){return t.$form.addClass("visible"),t.$name.focus()})},i.prototype.showSocialSignupForm=function(){return this.$socialSignUp.show()},i}(App.Views.CreateAccountFormBase)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FinishCreateAccountForm=function(r){function i(){return this.submit=e(this.submit,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click a.black-button":"submit"},i.prototype.initialize=function(){return this.$form=this.$(".user_details"),this.setupFormInputs(),this.$userSubmit=this.$form.find("a.black-button"),this.$userSubmit.after("<div class= 'spinner b_p'></div>")},i.prototype.validateForm=function(){return this.validateName()&&this.validateEmail()},i.prototype.submit=function(t){var e=this;return this.loading?!1:(this.enableLoading(this.$userSubmit),this.validateForm()?(this.trackCreatedAccount(),this.$form.submit()):(t.preventDefault(),this.disableLoading(this.$userSubmit),this.$userSubmit.addClass("red"),_.delay(function(){return e.$userSubmit.removeClass("red")},500),!1))},i.prototype.trackCreatedAccount=function(){return Analytics.conversion("Created account")},i}(App.Views.CreateAccountFormBase)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.LoginForm=function(r){function i(){return this.clearErrors=e(this.clearErrors,this),this.submitForm=e(this.submitForm,this),this.toggleForgotPassword=e(this.toggleForgotPassword,this),this.disableLoading=e(this.disableLoading,this),this.enableLoading=e(this.enableLoading,this),this.disableErrorState=e(this.disableErrorState,this),this.enableErrorState=e(this.enableErrorState,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.loading=!1,i.prototype.events={"click a.forgot_password":"toggleForgotPassword","click a.forgot_password_error":"toggleForgotPassword","click label.checkbox":"checkboxUpdate","click form .log_in button, form .forgot button":"submitForm","click .social_providers a":"socialLogin","submit form":"submitForm","click a.back_to_login":"backToLogin"},i.prototype.initialize=function(){return this.$form=this.$("form"),this.$forgot=this.$form.find(".forgot"),this.$("input[name='user[email]']").artsyplaceholder("Email"),this.$("input[name='user[password]']").artsyplaceholder("Password"),this},i.prototype.submitForgotPassword=function(){var t=this;if(!this.loading)return this.enableLoading(),$.ajax({type:"POST",url:"/users/password",data:{"user[email]":this.$form.find("input[name='user[email]']").val().trim()},success:function(){return t.disableLoading(),t.$(".login_providers").fadeOut(500,function(){return t.$(".forgot").hide().end().find(".log_in").show().end().find(".confirmation_sent").fadeIn(200)})},error:function(e){return e.suppressAppMessages=!0,t.disableLoading(),t.enableErrorState(t.getForgotPasswordErrorMessage(e))}})},i.prototype.submitLogin=function(){var t=this;if(!this.loading)return this.enableLoading(),$.ajax({type:"POST",data:{"user[email]":this.$form.find("input[name='user[email]']").val().trim(),"user[password]":this.$form.find("input[name='user[password]']").val().trim(),"user[remember_me]":this.$form.find("input[name='user[remember_me]']").is(":checked")},url:this.$form.attr("action"),success:function(e,r,o){var i,n;return n=JSON.parse(o.responseText),null!=n.trust_token?(i=t.$form.find("input[name='user[remember_me]']").is(":checked"),window.location.href="/users/sign_in?trust_token="+n.trust_token+"&remember_me="+i+"&redirect_uri="+App.redirectUrl):t.redirectAfterLogin()},error:function(e){return e.suppressAppMessages=!0,0===e.status&&""===e.responseText?t.redirectAfterLogin():(t.disableLoading(),t.enableErrorState(t.getLoginErrorMessage(e)))}})},i.prototype.enableErrorState=function(t){var e;return e="","The password you entered is incorrect."===t&&(e=" <a href='#' class='forgot_password_error'>Forgot password?</a>"),this.$(".errors").html("<p>"+html_escape(t)+e+"</p>").fadeIn(200),this.$form.find("button").addClass("error")},i.prototype.disableErrorState=function(){return this.$form.find("button").removeClass("error")},i.prototype.redirectAfterLogin=function(){return window.location.href=App.redirectUrl},i.prototype.enableLoading=function(){return this.loading=!0,this.$form.find("button, input").addClass("loading")},i.prototype.disableLoading=function(){return this.loading=!1,this.$form.find("button, input").removeClass("loading")},i.prototype.getErrorMessage=function(t){var e,r;return e=t.responseText,r=JSON.parse(t.responseText),e=null!=r.details?r.details.join("\n"):null!=r.error?r.error:t.responseText},i.prototype.getLoginErrorMessage=function(t){var e;return e=this.getErrorMessage(t),Analytics.error("Login: "+e),e},i.prototype.getForgotPasswordErrorMessage=function(t){var e;return e=this.getErrorMessage(t),"Email not found"===e&&(e="Sorry, we couldn't find an account with that email."),Analytics.error("Forgot password: "+e),e},i.prototype.backToLogin=function(){var t=this;return $(".confirmation_sent").fadeOut(200,function(){return t.$form.removeClass("forgot").show(),t.$(".login_providers").fadeIn(200)})},i.prototype.toggleForgotPassword=function(){var t=this;return this.clearErrors(),this.disableLoading(),this.$forgot.is(":visible")?this.$forgot.fadeOut(200,function(){return t.$form.removeClass("forgot"),t.$form.find(".log_in").fadeIn(200)}):this.$form.find(".log_in").fadeOut(200,function(){return t.$form.addClass("forgot"),t.$forgot.fadeIn(200),t.$("input[name='user[email]']").focus()}),!1},i.prototype.checkboxUpdate=function(t){return $("input[name='"+$(t.target).attr("for")+"']").click()},i.prototype.socialLogin=function(t){return window.location=$(t.target).attr("href"),!1},i.prototype.submitForm=function(t){return this.clearErrors(),t.preventDefault(),this.$forgot.is(":visible")?this.submitForgotPassword():this.submitLogin(),!1},i.prototype.clearErrors=function(){return this.$(".errors").html("")},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.LoginSignupDialog=function(r){function i(){return this.swapForm=e(this.swapForm,this),this.onHide=e(this.onHide,this),this.onShow=e(this.onShow,this),this.show=e(this.show,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#login_signup_modal",i.prototype.handle="signup-login",i.prototype.width=function(){return 900},i.prototype.copy=function(){return{"default":"The world&#8217;s greatest art, online. Sign up<br>to discover and collect your favorites.",bid:"The world&#8217;s greatest art, online. Sign up<br>to bid on artworks.",saveArtwork:"The world&#8217;s greatest art, online. Sign up<br>to save artworks.",followArtist:"The world&#8217;s greatest art, online. Sign up<br>to follow artists.",followGene:"The world&#8217;s greatest art, online. Sign up<br>to follow genes.",followProfile:"The world&#8217;s greatest art, online. Sign up<br>to follow.",addToPost:"The world&#8217;s greatest art, online. Sign up<br>to post.",registerToBid:"The world&#8217;s greatest art, online. Sign up<br>to bid.",viewAuctionResults:"The world&#8217;s greatest art, online. Sign up<br>for access to auction results and more."}},i.prototype.events={"click .close":"hide","click a.log_in":"login","click .back_to_signup a, a.sign_up":"signup"},i.prototype.initialize=function(){return this.loginForm=new App.Views.LoginForm({el:this.$(".login_form")}),this.signupForm=new App.Views.SignupForm({el:this.$(".signup_form")}),(App.onHomepage()||App.onLoginSignupPage())&&(this.show("pageLoad",!0),App.onHomepage()&&this.swapForm(".login_form",".signup_form","sign_up",!0)),"/"===this.getUriAction()&&null!=App.readCookie("log_in")?this.showLoginForm():void 0},i.prototype.getUriAction=function(){var t,e;return e=parseUri(window.location),t=e.query.length?"/"+e.queryKey.popover_action:e.path},i.prototype.performAction=function(){var t;switch(t=this.getUriAction()){case"/log_in":return this.showLoginForm(!0);case"/sign_up":return this.showSignupForm(!0)}},i.prototype.setCopy=function(t){var e;return this.$(".message .copy").html(null!=(e=this.copy()[t])?e:this.copy()["default"]),t?Analytics.click("Opened popover by "+t):void 0},i.prototype.show=function(t,e){return null==e&&(e={}),this.options=e,i.__super__.show.call(this,t,null!=e?e.instant:void 0),this.setCopy(t),t?this.swapForm(".login_form",".signup_form","sign_up",!0):void 0},i.prototype.onShow=function(){var t,e,r,o,i;return(null!=(t=this.options)?t.redirectUrl:void 0)?App.router.setRedirectUrl(this.options.redirectUrl):"/"!==window.location.pathname&&"/log_in"!==window.location.pathname&&"/sign_up"!==window.location.pathname&&App.router.setRedirectUrl(window.location.pathname),null!=(e=App.currentFrameView)&&null!=(r=e.exactMatch)&&null!=(o=r.infoPanel)&&null!=(i=o.viewInRoomView)&&i.onUnload(),this.performAction(),this.$el.show().find(".ui-dialog").show()},i.prototype.onHide=function(){return this.loginForm.$el.is(":visible")?Analytics.funnel("Exited login popover"):Analytics.funnel("Exited signup popover")},i.prototype.hidePlaceholders=function(){var t,e;return t=this.$(".login_form input[type=email], .login_form input[type=password]"),e=$.makeArray(t.map(function(){return $(this).val()})).join(""),""!==e?this.$(".login_form .artsy_placeholder").hide():void 0},i.prototype.login=function(t){return this.showLoginForm(),$(t.target).hasClass("log_in_button")&&Analytics.click("Clicked log in in popover"),!1},i.prototype.showLoginForm=function(t){return null==t&&(t=!1),this.swapForm(".signup_form",".login_form","log_in",t),this.hidePlaceholders(),Analytics.funnel("Started log in")},i.prototype.showForgotPasswordForm=function(){return this.showLoginForm(),this.loginForm.toggleForgotPassword()},i.prototype.showSignupForm=function(t){return null==t&&(t=!1),this.swapForm(".login_form",".signup_form","sign_up",t),Analytics.funnel("Started signup")},i.prototype.signup=function(t){return this.showSignupForm(),$(t.target).hasClass("signup_button")?Analytics.click("Clicked sign up in popover"):void 0},i.prototype.swapForm=function(t,e,r,o){var i,n=this;return null==o&&(o=!1),this.$(e).is(":visible")?void 0:(i=o?0:200,this.$(t).is(":visible")?this.$(t).fadeOut(i,function(){return n.swapForm(t,e,r,o)}):this.$(e).is(":hidden")&&(this.$(t).hide(),this.$(e).fadeIn(i),App.IS_TABLET||this.$("input[type=email]:visible").focus()),"/"+r!==window.location.pathname&&App.router.navigate(r,{trigger:!1}),!1)},i}(App.Views.ModalDialog)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PublicHeader=function(r){function i(){return this.fixHeaderPosition=e(this.fixHeaderPosition,this),this.close=e(this.close,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="header.public",i.prototype.defaultTop=85,i.prototype.initialize=function(){return this.$header=$("header.app"),App.onHomepage()||App.onLoginSignupPage()?this.close(!0):App.$window.bind("scroll.fix_header",this.fixHeaderPosition)},i.prototype.close=function(t){return null==t&&(t=!1),this.$header.css({top:0}),this.$el.slideUp(t?0:300),App.$body.removeClass("public_header_visible"),App.router.trigger("recomputeFeed"),App.$window.unbind(".fix_header")},i.prototype.fixHeaderPosition=function(){var t;return t=this.defaultTop-App.$window.scrollTop(),this.$header.css({top:0>t?0:t}),1>t?this.close():void 0},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SignupForm=function(r){function i(){return this.trackJoinWith=e(this.trackJoinWith,this),this.enableLoading=e(this.enableLoading,this),this.trackCreatedAccount=e(this.trackCreatedAccount,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click a.signup_with_email":"signupWithEmail","click a.signup_with_facebook":"signupWithFacebook","click a.signup_with_twitter":"signupWithTwitter"},i.prototype.trackCreatedAccount=function(){return Analytics.conversion("Created account")},i.prototype.enableLoading=function(){return this.loading=!0},i.prototype.signupWithFacebook=function(){return this.loading?!1:(this.enableLoading($("a.signup_with_facebook")),this.trackJoinWith("Facebook"))},i.prototype.signupWithTwitter=function(){return this.loading?!1:(this.enableLoading($("a.signup_with_twitter")),this.trackJoinWith("Twitter"))},i.prototype.trackJoinWith=function(t){return this.trackCreatedAccount(),Analytics.click("Clicked 'Join with "+t+"'")},i.prototype.signupWithEmail=function(){return this.enableLoading($("a.signup_with_email")),this.trackJoinWith("Email"),App.showCreateAccountDialog({email:1}),!1},i}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.AuctionConfirmationDialog=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.width=function(){return 650},o.prototype.handle="auctionConfirmation",o.prototype.renderDialog=function(t){return"registration"===t?this.$el.html(JST["templates/sales/auctions/registration_confirmation"]()):"bid"===t?this.$el.html(JST["templates/sales/auctions/bid_confirmation"]()):void 0},o}(App.Views.ModalDialog)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.AuctionInfoDialog=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.width=function(){return 650},o.prototype.handle="auctionInfo",o.prototype.onShow=function(){var t=this;return App.Repositories.Pages.getOrFetch("auction-info",["id","content","name"],{success:function(e){return t.$el.html(JST["templates/sales/auctions/auction_info_dialog"]({page:e})).css({"max-height":App.$window.height()-200})}})},o}(App.Views.ModalDialog)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.AuctionBanner=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),_.extend(o.prototype,App.Mixins.RegisterToBid),o.prototype.events={"click .bidder-register":"registerUser"},o.prototype.initialize=function(){return this.registered=this.model.get("currentUserRegistered"),this.registerBidderRegistrationActions(),this.render()},o.prototype.render=function(){var t;return t="preview"===this.model.get("auction_state"),this.$el.html(JST["templates/sales/auctions/banner"]({sale:this.model,feature:this.options.feature,showRegisterButton:t,registered:this.registered})),this.$registerButton=this.$(".bidder-register-container"),this.model.get("end_at")&&(this.countdown=new App.Views.Countdown({el:this.$(".countdown"),sale:this.model})),this.$el.show()},o.prototype.registerUser=function(){var t=this;return this.registerToBid(this.model,{onSuccess:function(){return t.registered=!0,t.$registerButton.removeClass("unregistered").addClass("registered")},onCreditCardRequired:function(e){return t.renderCreditCardForm(e)}})},o.prototype.registerBidderRegistrationActions=function(){var t,e=this;return t=$(".bidder-register"),(null!=t?t.length:void 0)>0?this.registered?(t.text("You're Registered to Bid").addClass("bidder-registered"),t.on("click",function(){return!1})):t.on("click",function(){return e.registerUser(),!1}):void 0},o.prototype.onUnload=function(){var t;return null!=(t=this.countdown)?t.onUnload():void 0},o}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.BidFrame=function(r){function i(){return this.showErrors=e(this.showErrors,this),this.showSuccessfulBidMessage=e(this.showSuccessfulBidMessage,this),this.placeBidClick=e(this.placeBidClick,this),this.onRegistrationSuccess=e(this.onRegistrationSuccess,this),this.showAuctionInfoDialog=e(this.showAuctionInfoDialog,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.ValidateBid),i.prototype.el="#bid",i.prototype.frameName="bid",i.prototype.maxTimesPolledForBidPlacement=8,i.prototype.events={"click .bidding_question":"showAuctionInfoDialog","click .registered .submit":"placeBidClick","form submit":"placeBidClick"},i.prototype.render=function(){var t=this;return this.$el.addClass("loading"),this.fetchSaleArtwork({success:function(e){return t.model=e,t.fetchSale()}})},i.prototype.fetchSaleArtwork=function(t){return App.Repositories.SaleArtworks.getFromUrl("/api/v1/sale/"+this.options.featureId+"/sale_artwork/"+this.options.artworkId,{success:function(e){return t.success(e.models[0])}})},i.prototype.fetchSale=function(){var t=this;return App.Repositories.Sales.getOrFetch(this.options.featureId,["id"],{success:function(e){return t.sale=e,"open"!==t.sale.get("auction_state")?t.renderClosed():t.checkCurrentUserRegistered()}})},i.prototype.checkCurrentUserRegistered=function(){var t=this;return this.sale.checkCurrentUserRegistered({success:function(){return t.currentUserRegistered=t.sale.get("currentUserRegistered"),t.renderBidForm()}})},i.prototype.renderBidForm=function(){return this.hideArtsyNavigation(),this.$el.removeClass("loading"),this.$el.html(JST["templates/sales/bid_form"]({saleArtwork:this.model,artwork:this.model.get("artwork"),maxBid:this.formatBid(this.options.params.bid),registered:this.currentUserRegistered})).show(),this.setupImageLoad(),this.currentUserRegistered?void 0:this.createAuctionRegistrationForm()},i.prototype.setupImageLoad=function(){return this.$("img").load(function(){return $(this).removeClass("loading")})},i.prototype.formatBid=function(t){return t&&!isNaN(Number(t))?App.numberToMoney(Number(t)):""},i.prototype.showAuctionInfoDialog=function(){return this.auctionInfoDialog||(this.auctionInfoDialog=new App.Views.AuctionInfoDialog({el:this.$(".auction_info_dialog")})),this.auctionInfoDialog.show(),!1},i.prototype.createAuctionRegistrationForm=function(){return this.form=new App.Views.AuctionRegistrationForm({el:this.$(".unregistered_bid_form"),sale:this.sale,success:this.onRegistrationSuccess}),this.form.render(),this.$form=this.$(".auction_registration_form"),this.$form.find("button.submit > span").text("Bid")},i.prototype.onRegistrationSuccess=function(){var t,e=this;return t=this.validateBid(this.getBid(),this.model.get("minimum_next_bid_cents")),t===!1?(this.$(".form_bottom").fadeOut(200,function(){return e.$(".form_bottom").html(JST["templates/sales/bid_form_registered_button"]()),e.$(".form_bottom").fadeIn(200)}),!1):this.placeBid({maxBid:t,error:function(){return e.showErrors(),e.$(".form_bottom").fadeOut(200,function(){return e.$(".form_bottom").html(JST["templates/sales/bid_form_registered_button"]()),e.$(".form_bottom").fadeIn(200)})}})},i.prototype.getBid=function(){return this.$("input.max-bid").val()},i.prototype.placeBidClick=function(t){var e;return t.preventDefault(),e=this.validateBid(this.getBid(),this.model.get("minimum_next_bid_cents")),e&&e>0?(this.placeBid({maxBid:e,target:$(".registered .submit"),error:this.showErrors}),!1):!1},i.prototype.placeBid=function(t){var e,r,o,i=this;return(r=t.maxBid)?(this.timesPolledForBidPlacement=0,null!=(o=t.target)&&o.addClass("loading"),e=new App.Models.BidderPosition,e.create({maxBid:r,saleId:this.sale.get("id"),artworkId:this.model.get("artwork").get("id"),success:function(){return i.pollForBidPlacement(i.model.get("minimum_next_bid_cents"))},error:null!=t?t.error:void 0})):void 0},i.prototype.pollForBidPlacement=function(t){var e,r=this;return e=new App.Models.SaleArtwork,e.url="/api/v1/sale/"+this.options.featureId+"/sale_artwork/"+this.options.artworkId,e.fetch({success:function(e){return r.model=e,r.model.get("highest_bid_amount_cents")>=t||r.timesPolledForBidPlacement>r.maxTimesPolledForBidPlacement?r.showSuccessfulBidMessage():_.delay(function(){return r.pollForBidPlacement(t)},1e3),r.timesPolledForBidPlacement=r.timesPolledForBidPlacement+1}})},i.prototype.showSuccessfulBidMessage=function(){var t,e,r;return t=parseUri(window.location),(null!=t?null!=(r=t.queryKey)?r.redirect_uri:void 0:void 0)?(e=t.queryKey.redirect_uri,window.location=""+unescape(t.queryKey.redirect_uri)+"/confirm-bid"):window.location="/artwork/"+this.model.get("artwork").get("id")+"/confirm-bid"},i.prototype.showErrors=function(t){return this.$(".errors").show().html(t.join("<br />")),this.$(".submit").removeClass("loading"),this.$el.removeClass("loading")},i.prototype.renderClosed=function(){return this.$el.html(JST["templates/sales/auctions/bidding_closed"]({sale_artwork:this.model})).show(),this.$el.removeClass("loading")},i.prototype.onLoad=function(){return this.hideArtsyNavigation()},i.prototype.onUnload=function(){return this.showArtsyNavigation()},i.prototype.hideArtsyNavigation=function(){return App.artsyNavigation.hide()},i.prototype.showArtsyNavigation=function(){return App.artsyNavigation.show()},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.Countdown=function(r){function i(){return this.calculateTimeLeft=e(this.calculateTimeLeft,this),this.updateTimer=e(this.updateTimer,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.secondsInOneDay=86400,i.prototype.secondsInOneHour=3600,i.prototype.secondsInoneMinute=60,i.prototype.initialize=function(){var t=this;return this.sale=this.options.sale,this.sale.calculateOffsetTimes({success:function(){return t.setUpTimer()}})},i.prototype.setUpTimer=function(){return _.contains(["preview","open"],this.sale.get("auctionState"))?(this.timerEnd=function(){switch(this.sale.get("auctionState")){case"open":return this.sale.get("offsetEndAtInSeconds");case"preview":return this.sale.get("offsetStartAtInSeconds")}}.call(this),this.sale.on("change:auctionState",function(){return clearInterval(this.interval),window.location.reload()},this),this.renderTimer({auctionState:this.sale.get("auctionState")}),this.updateTimer(),this.interval=setInterval(this.updateTimer,1e3)):void 0},i.prototype.renderTimer=function(t){return this.$el.html(JST["templates/sales/auctions/countdown"](t)),this.$heading=this.$("h3"),this.$days=this.$("#days .digits"),this.$hours=this.$("#hours .digits"),this.$minutes=this.$("#minutes .digits"),this.$seconds=this.$("#seconds .digits")},i.prototype.updateTimer=function(){return this.sale.updateState(),"closed"!==this.sale.get("auctionState")?(this.calculateTimeLeft(this.timerEnd),this.$days.text(this.days),this.$hours.text(this.hours),this.$minutes.text(this.minutes),this.$seconds.text(this.seconds)):void 0},i.prototype.calculateTimeLeft=function(t){var e,r;return e=moment().unix(),r=parseInt(t-e),this.days=this.pad(parseInt(r/this.secondsInOneDay)),r%=this.secondsInOneDay,this.hours=this.pad(parseInt(r/this.secondsInOneHour)),r%=this.secondsInOneHour,this.minutes=this.pad(parseInt(r/this.secondsInoneMinute)),this.seconds=this.pad(parseInt(r%this.secondsInoneMinute))},i.prototype.pad=function(t){return 10>t?"0"+t:t.toString()},i.prototype.onUnload=function(){return clearInterval(this.interval)},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.AuctionRegistration=function(r){function i(){return this.showAuctionInfoDialog=e(this.showAuctionInfoDialog,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .bidding_question":"showAuctionInfoDialog"},i.prototype.render=function(){return this.$el.html(JST["templates/sales/auctions/registration"]({})),this.form=new App.Views.AuctionRegistrationForm({el:this.$(".register"),sale:this.model}),this.form.render()},i.prototype.showAuctionInfoDialog=function(){return this.auctionInfoDialog||(this.auctionInfoDialog=new App.Views.AuctionInfoDialog({el:this.$(".auction_info_dialog")})),this.auctionInfoDialog.show(),!1},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.AuctionRegistrationForm=function(r){function i(){return this.cardCallback=e(this.cardCallback,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click button.submit":"onSubmit"},i.prototype.initialize=function(){return this.sale=this.options.sale},i.prototype.render=function(){var t;return this.injectBalancedJS(),t=App.isLoggedIn()&&App.currentUser.get("name")?App.currentUser.get("name"):"",this.$el.html(JST["templates/sales/auctions/registration_form"]({name:t})),this.$form=this.$("form.auction_registration_form"),this.setUpFields(),this.$submit=this.$form.find("button.submit")},i.prototype.onSubmit=function(){return this.$submit.hasClass("loading")?!1:(this.$submit.addClass("loading"),this.validateForm()?this.tokenizeCard():this.showError("Please review the error(s) above and try again."),!1)},i.prototype.cardCallback=function(t){var e=this;switch(t.status){case 201:return App.currentUser.addCreditCard({uri:t.data.uri,success:function(){return e.sale.createBidder({sale_id:e.saleId,success:function(){var t;return e.sale.set("currentUserRegistered",!0),"function"==typeof(t=e.options).success?t.success():void 0},error:function(){return e.showError(e.errors.other,"Error creating a bidder")}})},error:function(){return e.showError(e.errors.other,"Error adding your credit card")}});case 400:case 403:return this.showError(this.errors.missingOrMalformed,"Card missing or malformed");case 402:return this.showError(this.errors.couldNotAuthorize,"Card could not be authorized");case 404:return this.showError(this.errors.other,"Marketplace invalid");default:return this.showError(this.errors.other,"Card - other error")}},i}(App.Views.BalancedForm)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.AuctionRegistrationFrame=function(r){function i(){return this.redirect=e(this.redirect,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="#auction_registration",i.prototype.frameName="auctionRegistrationFrame",i.prototype.initialize=function(){return this.saleId=this.options.saleId},i.prototype.render=function(){var t=this;return App.Repositories.Sales.getOrFetch(this.saleId,[],{success:function(e){return t.sale=e,t.sale.on("change:currentUserRegistered",t.confirmUserRegistration,t),t.sale.get("is_auction")&&_.include(["preview","open"],t.sale.get("auction_state"))?App.isLoggedIn()?t.checkRegistration():App.loginSignupDialog.show("registerToBid"):t.sale.get("is_auction")?t.$el.show().html(JST["templates/sales/auctions/registration_error"]({message:"Registration for this auction is not currently open."})):App.showError("404: Not Found")
}})},i.prototype.checkRegistration=function(){var t=this;return this.sale.checkCurrentUserRegistered({success:function(){return t.sale.get("currentUserRegistered")?t.redirect():t.getCreditCards()}})},i.prototype.getCreditCards=function(){var t=this;return App.currentUser.fetchCreditCards({success:function(e){return e.length>0?t.sale.createBidder({success:function(){return t.redirect()}}):(t.sale.on("change:currentUserRegistered",function(){return t.sale.get("currentUserRegistered")?t.redirect():void 0}),t.renderCreditCardForm())}})},i.prototype.redirect=function(){var t,e,r;return t=parseUri(window.location),(null!=t?null!=(r=t.queryKey)?r.redirect_uri:void 0:void 0)?(e=t.queryKey.redirect_uri,window.location=""+unescape(t.queryKey.redirect_uri)+"/confirm-registration"):App.router.navigate("/feature/"+this.saleId+"/confirm-registration",{trigger:!0})},i.prototype.renderCreditCardForm=function(){var t=this;return this.hideArtsyNavigation(),null!=App.publicPopover&&App.publicPopover.closePublicHeader(),this.registrationView=new App.Views.AuctionRegistration({el:this.$el,model:this.sale}),this.registrationView.render(),_.defer(function(){return t.$el.fadeIn(200)})},i.prototype.onLoad=function(){return this.hideArtsyNavigation()},i.prototype.onUnload=function(){return this.showArtsyNavigation()},i.prototype.hideArtsyNavigation=function(){return App.artsyNavigation.hide()},i.prototype.showArtsyNavigation=function(){return App.artsyNavigation.show()},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SaleArtworks=function(r){function i(){return this.bid=e(this.bid,this),this.initializeArtworkColumns=e(this.initializeArtworkColumns,this),this.onResize=e(this.onResize,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.BidArtwork),_.extend(i.prototype,App.Mixins.ArtworkColumns),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via sale",i.prototype.analyticsSaveMessage="Added artwork to collection, via sale",i.prototype.artworkColumns=3,i.prototype.artworkColumnMargin=1,i.prototype.artworkColumnWidth=250,i.prototype.maxArtworkWidth=450,i.prototype.minArtworkWidth=200,i.prototype.defaultArtworkColumns=[3,4,5],i.prototype.events={"click .more_info":"visitArtwork","click .bid":"bid"},i.prototype.initialize=function(){return this.fixedWidth=this.$el.width(),this.setupArtworkColumnRowWidth(),this.renderArtworks(),App.IS_TABLET||App.IS_PHONE?void 0:App.$window.on("resize.sale_artworks",_.throttle(this.onResize,500))},i.prototype.renderArtworks=function(){var t=this;return this.model.doneFetching()?this.reRender():this.model.fetchSaleArtworks({success:function(e,r){return t.columns?t.appendArtworksToColumns(r):t.initializeArtworkColumns(),t.model.doneFetching()?t.model.get("display_artist_list")?t.renderArtistList():void 0:t.renderArtworks()}})},i.prototype.reRender=function(){return this.model.doneFetching()&&(this.destroy(),this.initializeArtworkColumns(),this.model.get("display_artist_list"))?this.renderArtistList():void 0},i.prototype.onResize=function(){return this.fixedWidth=this.$el.width(),this.setupArtworkColumnRowWidth(),this.initializeArtworkColumns(),this.reRender()},i.prototype.appendArtworksToColumns=function(t){var e,r,o,i;for(i=t.models,r=0,o=i.length;o>r;r++)e=i[r],this.columns.addToShortestColumn(e.get("artwork"),e.getAsSafeHtml("user_notes"));return this.setupImageLoad(),this.initializeArtworksFromDom()},i.prototype.initializeArtworkColumns=function(){var t,e,r,o;return o=this.model.get("is_auction"),o&&(e=this.model.get("auction_state")),r=o&&("preview"===e||"open"===e),t=function(){var t=this;return this.collection.each(function(o){var i,n;return i=t.addToNextColumn(o.get("artwork"),o.getAsSafeHtml("user_notes"),r,o.formatEstimate()),r&&(n="open"===e&&null!=o.get("highest_bid_amount_cents")?{displayCurrentBid:!0,price:o.formatHighestBid()}:{displayCurrentBid:!1,price:o.formatOpeningBid()},i.find(".auction_price").html(JST["templates/sales/auctions/artwork_auction_price"](n)),"open"===e)?i.find(".bidder_positions_count").html(o.formatBidsAndReserve()):void 0})},this.columns=new App.Views.ArtworkColumns({gutterWidth:this.artworkColumnMargin,numberOfColumns:this.artworkColumns,totalWidth:this.fixedWidth,collection:this.model.get("saleArtworks"),displayPurchase:!0,displaySold:!0,displayMoreInfo:!0,displayNotes:!0,isAuction:o,ordered:!0,appendArtworks:t,displayBid:"open"===this.model.get("auction_state")}),this.$el.html(this.columns.$el).find(".artwork-column figure:first-child").css({"padding-top":"0px"}),this.setupImageLoad(),this.initializeArtworksFromDom()},i.prototype.visitArtwork=function(t){var e,r;return e=$(t.target).attr("data-id"),r=App.Repositories.Artworks.get(e),App.router.navigate(r.searchPath(),{trigger:!0}),!1},i.prototype.renderArtistList=function(){var t,e,r,o,i,n;return r=this.model.get("saleArtworks").getArtworksSortedByArtist(),n=Math.floor(r.length/2),1>n&&(n=1),i=_.groupBy(r,function(t,e){return Math.floor(e/n)}),t=_.toArray(i),t.length>2&&t[0].push(t.pop(2)[0]),o=JST["templates/sales/artist_list"]({artworkGroups:t,width:this.artworkRowWidth}),e=this.artworkColumns>r.length?r.length-1:this.artworkColumns-1,this.$(".artwork-column:eq("+e+") figure:first").before(o)},i.prototype.bid=function(t){var e,r,o;return e=$(t.target),o=e.attr("data-id"),r=App.Repositories.Artworks.get(o),this.bidArtwork(r,this.model),!1},i.prototype.setupImageLoad=function(){return this.$("img").load(function(){return $(this).removeClass("loading")})},i.prototype.getDescription=function(){return this.$el.parent().parent().find(".sale_artworks_container, .description")},i.prototype.onLoad=function(){return this.reRender()},i.prototype.onUnload=function(){return App.$window.off(".sale_artworks"),this.destroy()},i.prototype.destroy=function(){return this.getDescription().css({width:"100%"}),this.$el.html("")},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SearchForm=function(r){function i(){return this.focusInput=e(this.focusInput,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.el="header.app",i.prototype.display="",i.prototype.selectedPath="",i.prototype.events={"focus #search_input":"onFocus","blur #search_input":"onBlur","click .search":"focusInput","keyup #search_input":"onKeyup","mouseover .search":"onIphoneMouseover"},i.prototype.initialize=function(){return this.$input=this.$("#search_input"),this.$focusMessage=this.$("#search_focus"),this.createAutocomplete()},i.prototype.createAutocomplete=function(){return this.autocomplete||(this.autocomplete=new App.Views.SearchAutocomplete({el:this.$("li.search"),$input:this.$input,parent:this}))},i.prototype.focusInput=function(){return this.$input.focus()},i.prototype.onFocus=function(){return this.$("li.search").removeClass("empty"),""===this.$input.val()?(this.showSuggestions(),Analytics.click("Focused on search input")):void 0},i.prototype.onBlur=function(){return""===this.$input.val()&&this.$("li.search").addClass("empty"),this.hideSuggestions()},i.prototype.onKeyup=function(){return""===this.$input.val()?!0:this.hideSuggestions()},i.prototype.showSuggestions=function(){var t=this;return this.$("ul.suggestions li:first").addClass("current"),window.clearInterval(this.suggestionInterval),this.suggestionInterval=window.setInterval(function(){return t.cycleSuggestions()},3500),this.$focusMessage.slideDown("fast")},i.prototype.hideSuggestions=function(){var t=this;if(this.suggestionInterval)return _.delay(function(){return t.$("ul.suggestions li.current").removeClass("current"),window.clearInterval(t.suggestionInterval),t.$focusMessage.slideUp("fast",function(){return $(this).removeClass("no_match")})},200)},i.prototype.cycleSuggestions=function(){var t,e;return t=this.$("ul.suggestions li.current"),e=t.next(),e.length>0||(e=this.$("ul.suggestions li:first")),t.removeClass("current"),e.addClass("current")},i.prototype.onIphoneMouseover=function(){return App.IS_PHONE||App.IS_TABLET&&App.IS_IPAD_LT_IOS6?this.focusInput():void 0},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.SearchRelatedArtists=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.nextPageUrl=function(t){return"/api/v1/related/layer/"+this.options.layer.id+"/artists?"+$.param(_.extend({size:this.options.size,page:t,artist:[this.options.artist.get("id")],exclude_artists_without_artworks:!0}))},o}(App.Views.ArtistsRowSet)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.SearchAutocomplete=function(r){function i(){return this.submitUserFeedbackForm=e(this.submitUserFeedbackForm,this),this.selectAutocompleteItem=e(this.selectAutocompleteItem,this),this.checkSubmission=e(this.checkSubmission,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .feedback_form button":"submitUserFeedbackForm","keyup input":"checkSubmission"},i.prototype.autocompleteUrl=function(){return App.currentUser.isAdmin()?"/api/v1/match?":"/api/v1/match?visible_to_public=true&"},i.prototype.initialize=function(){return this.parent=this.options.parent,this.$input=this.options.$input,this.initializeTypeahead(),this.$input.on("typeahead:autocompleted",this.selectAutocompleteItem),this.$input.on("typeahead:selected",this.selectAutocompleteItem)},i.prototype.initializeTypeahead=function(){var t=this;return this.$input.typeahead({template:"",name:"header-autocomplete",footer:JST["templates/search/suggestion_form"](),limit:20,remote:{url:""+this.autocompleteUrl()+"term=%QUERY",filter:function(e){return t.showHideFeedbackForm(e),t.cleanupAutocompleteItems(e)},beforeSend:function(){return t.$input.addClass("loading")},complete:function(){return t.selected=!1,t.$input.removeClass("loading"),t.$("img").error(function(){return $(this).hide()}),t.query=t.$input.val(),"doge"===t.$input.val()&&(App.dogeMode=!0,"artwork"===App.currentFrameName)?App.currentFrameView.render():void 0}},engine:{compile:function(){return{render:function(t){return JST["templates/search/autocomplete_result"]({item:t})}}}}})},i.prototype.cleanupAutocompleteItems=function(t){var e,r,o;if(Analytics.funnel("Searched from header, with results"),(null!=t?t.length:void 0)>0){for(r=0,o=t.length;o>r;r++)e=t[r],e.imageUrl=this.getImageUrl(e),e.cssClass=e.published?"":"private",e.value=e.display,e.displayModel="gene"===e.model?"category":e.model;return this.handleExactMatch(this.$input.val(),t)}return[{value:" ",cssClass:"hidden"}]},i.prototype.checkSubmission=function(t){return 13!==t.which||this.selected?void 0:window.location="/search?q="+this.$input.val()},i.prototype.handleExactMatch=function(t,e){var r,o,i,n,s,a;for(o=n=0,s=e.length;s>n;o=++n)if(i=e[o],(null!=(a=i.value)?a.toLowerCase():void 0)===t){r=o;break}return r&&e.splice(0,0,e.splice(r,1)[0]),e},i.prototype.selectAutocompleteItem=function(t,e){var r;return this.selected=!0,e?(Analytics.click("Selected item from search",e.model,e.id,{data:{query:this.query}}),r="profile"===e.model?"/"+e.id:""+e.model+"/"+e.id,App.router.navigate(r,{trigger:!0})):void 0},i.prototype.submitUserFeedbackForm=function(){var t=this;return this.searchSuggestions||(this.searchSuggestions=new App.Collections.SearchSuggestions),this.searchSuggestions.addSuggestion(this.$input.val(),{success:function(){return t.$("button.text.block").fadeOut(200,function(){return t.$(".success_text").fadeIn(200),_.delay(function(){return t.$("button.text.block").show(),t.$(".success_text").hide()},1e4)})}})},i.prototype.checkDisplayUserFeedback=function(t){var e,r,o,i;for(r={excellent:0,good:0,poor:0},o=0,i=t.length;i>o;o++)e=t[o],r[e.score]++;return r.excellent>0},i.prototype.showHideFeedbackForm=function(t){var e;return this.checkDisplayUserFeedback(t)?this.$(".feedback_form").hide():(e=this.$input.val(),(null!=e?e.length:void 0)>0?this.$(".feedback_form").show().find(".query").text(e):this.$(".feedback_form").hide())},i.prototype.getImageUrl=function(t){var e;return e="artwork"===t.model?"/api/v1/"+t.model+"/"+t.id+"/default_image.jpg":"/api/v1/"+t.model+"/"+t.id+"/image",App.XAPP.xapp_token?e=""+e+"?xapp_token="+App.XAPP.xapp_token:e},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.CustomSocialTip=function(r){function i(){return this.alreadyShowingEmail=e(this.alreadyShowingEmail,this),this.hideTip=e(this.hideTip,this),this.showTip=e(this.showTip,this),this.initTooltip=e(this.initTooltip,this),this.initialize=e(this.initialize,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.initialize=function(){return this.$emailForm=$(this.options.emailForm)},i.prototype.initTooltip=function(t){return t.find(".has_tip, .tip").hover(_.debounce(this.showTip,100),_.debounce(this.hideTip,100))},i.prototype.showTip=function(t){return this.alreadyShowingEmail()?void 0:(this.showing=!0,_.delay(function(){var e;return e=$(t.target).parents("li").find(".tip"),e.stop().fadeIn(100,function(){return e.show().css({opacity:1}),this.showing=!1})},100))},i.prototype.hideTip=function(t){return _.delay(function(){var e;if(!this.showing)return e=$(t.target).parents("li").find(".tip"),e.stop().fadeOut(100,function(){return e.hide()})},100)},i.prototype.alreadyShowingEmail=function(){return this.showingEmailForm||null!=this.$emailForm&&this.$emailForm.hasClass("visible")},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.FacebookCustom=function(r){function i(){return this.showPopUp=e(this.showPopUp,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .facebook_custom":"showPopUp"},i.prototype.render=function(){var t;return this.$fbLink=$("<a class='facebook_custom has_tip'><div class='tip'><div class='arrow_container'><div class='point'></div></div><div class='tip_body'>Post&nbsp;to&nbsp;Facebook</div></div></a>"),t={u:this.options.url||window.location.href},this.$fbLink.attr({href:"http://www.facebook.com/sharer.php?"+$.param(t)}),this.$el.html(this.$fbLink),this.initTooltip(this.$el)},i.prototype.showPopUp=function(){var t,e,r,o,i;return i=548,t=325,e=(App.$window.width()-i)/2,o=(App.$window.height()-t)/2,r="status=1,width="+i+",height="+t+",top="+o+",left="+e,window.open(this.$fbLink.attr("href"),"sharer",r),!1},i}(App.Views.CustomSocialTip)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.FacebookShare=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={click:"share"},o.prototype.render=function(t){return this.$el.attr({href:"http://www.facebook.com/sharer.php?"+t})},o.prototype.share=function(){var t,e,r,o,i,n;return n=548,t=325,o=0,e=(App.$window.width()-n)/2,i=(App.$window.height()-t)/2,r="status=1,width="+n+",height="+t+",top="+i+",left="+e,window.open(this.$el.attr("href"),"sharer",r),!1},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PinterestCustom=function(r){function i(){return this.showPopUp=e(this.showPopUp,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .pinterest_custom":"showPopUp"},i.prototype.render=function(){var t;return this.$pinterestLink=$("<a class='pinterest_custom has_tip'><div class='tip'><div class='arrow_container'><div class='point'></div></div><div class='tip_body'>Pin&nbsp;It&nbsp;on&nbsp;Pinterest</div></div></a>"),t={url:this.options.url||window.location.href,media:this.options.media,description:this.options.description},this.$pinterestLink.attr({href:"//pinterest.com/pin/create/button/?"+$.param(t)}),this.$el.html(this.$pinterestLink),this.initTooltip(this.$el)},i.prototype.showPopUp=function(){var t,e,r,o,i;return i=575,t=400,e=(App.$window.width()-i)/2,o=(App.$window.height()-t)/2,r="status=1,width="+i+",height="+t+",top="+o+",left="+e,window.open(this.$pinterestLink.attr("href"),"pinterest",r),!1},i}(App.Views.CustomSocialTip)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.PinterestShare=function(r){function i(){return this.share=e(this.share,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={click:"share"},i.prototype.render=function(t){return this.$el.attr({href:"//pinterest.com/pin/create/button/?"+t})},i.prototype.share=function(){var t,e,r,o,i;return i=575,t=400,e=(App.$window.width()-i)/2,o=(App.$window.height()-t)/2,r="status=1,width="+i+",height="+t+",top="+o+",left="+e,window.open(this.$el.attr("href"),"pinterest",r),!1},i}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ShareDialog=function(r){function i(){return this.showEmailForm=e(this.showEmailForm,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.width=function(){return 350},i.prototype.el="#share_modal",i.prototype.handle="sharing_is_caring",i.prototype.events={"click .email.social_option":"showEmailForm","click .ui-dialog-titlebar-close":"hide"},i.prototype.onShow=function(t){var e,r,o,i;return this.options=t,(i=this.options).url||(i.url=window.location.href),this.$el.html(JST["templates/shared/share_dialog"]({email:t.email,image:t.image,url:t.url})).show(),e=new App.Views.FacebookShare({el:this.$(".facebook")}),e.render($.param({u:t.url})),o=new App.Views.TwitterShare({el:this.$(".twitter")}),o.render($.param({text:t.text,url:t.url,hideVia:!0})),t.image&&(r=new App.Views.PinterestShare({el:this.$(".pinterest")}),r.render($.param({description:t.text,url:t.url,media:t.image}))),this.$(".link input").focus()},i.prototype.showEmailForm=function(){var t=this;return this.$(".social_option").fadeOut(150,function(){return t.$(".email_form").fadeIn(150)}),this.$(".ui-widget-content > .heading").text("Share via email"),new App.Views.ArtworkEmailShare({el:this.$el.find(".email_form"),model:this.options.model,parent:this})},i}(App.Views.ModalDialog)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.TwitterCustom=function(r){function i(){return this.showPopUp=e(this.showPopUp,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.events={"click .tweet_custom":"showPopUp"},i.prototype.render=function(){var t;return this.$tweetLink=$("<a class='tweet_custom has_tip'><div class='tip'><div class='arrow_container'><div class='point'></div></div><div class='tip_body'>Share&nbsp;on&nbsp;Twitter</div></div></a>"),t={text:this.options.text,url:this.options.url||window.location.href,related:"artsy"},null==this.options.hideVia,this.$tweetLink.attr({href:"http://twitter.com/share?"+$.param(t)}),this.$el.html(this.$tweetLink),this.initTooltip(this.$el)},i.prototype.showPopUp=function(){var t,e,r,o,i;return i=575,t=400,e=(App.$window.width()-i)/2,o=(App.$window.height()-t)/2,r="status=1,width="+i+",height="+t+",top="+o+",left="+e,window.open(this.$tweetLink.attr("href"),"twitter",r),!1},i}(App.Views.CustomSocialTip)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.TwitterShare=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={click:"share"},o.prototype.render=function(t){return this.$el.attr({href:"http://twitter.com/share?"+t})},o.prototype.share=function(){var t,e,r,o,i,n;return n=575,t=400,o=0,e=(App.$window.width()-n)/2,i=(App.$window.height()-t)/2,r="status=1,width="+n+",height="+t+",top="+i+",left="+e,window.open(this.$el.attr("href"),"twitter",r),!1},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.PartnerShows=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.urlRoot="/api/v1/shows/feed",o.prototype.initialize=function(){return this.render()},o.prototype.render=function(){return this.$el.html(JST["templates/home/_partner_shows"]),this.renderShows()},o.prototype.onLoad=function(){var t;return null!=(t=this.feed)?t.onLoad():void 0},o.prototype.onUnload=function(){var t;return App.router.viewState.saveScrollPosition(),null!=(t=this.feed)?t.onUnload():void 0},o.prototype.renderShows=function(){var t=this;return App.Repositories.FeedItems.getFromUrl(this.urlRoot,{success:function(e){return e.models.length>0?(e.urlRoot=t.urlRoot,t.feed||(t.feed=new App.Views.Feed({feedItems:e,el:t.$(".feed")})),t.trigger("rendered")):"undefined"!=typeof callback&&null!==callback?callback.error():void 0},error:function(){return t.$(".feed").html(JST["templates/posts/empty"]).removeClass("loading")}})},o}(Backbone.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.UserDelete=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.id="user_delete",o.prototype.el="#user_delete",o.prototype.frameName="userDelete",o.prototype.events={"click #user_submit":"submit","click #user_delete_confirm":"confirm"},o.prototype.initialize=function(){this.model=App.currentUser,this.$("form").length>0&&this.$el.show()},o.prototype.load=function(){return this.render()},o.prototype.render=function(){return this.$el.html(JST["templates/users/delete"]({user:this.model})).fadeIn("slow"),this.confirmCheckbox=this.$("#user_delete_confirm"),this.explanation=this.$("#explanation"),this.submitButton=this.$("#user_submit"),this.submitButton.attr("disabled","disabled")},o.prototype.clearErrors=function(){return this.$el.removeClass("errors"),this.$(".input_msg").empty(),this.$("#user_error").empty()},o.prototype.revealErrors=function(){var t=this;return this.$el.addClass("errors"),this.submitButton.addClass("error"),window.setTimeout(function(){return t.submitButton.removeClass("error")},1500)},o.prototype.submit=function(){var t=this;if(this.confirmCheckbox.is(":checked"))return this.clearErrors(),this.$el.removeClass("committed").addClass("busy_info"),$.ajax({type:"DELETE",url:"/api/v1/me",data:{explanation:this.$("#user_delete_explanation").val(),url:"/user/delete"},success:function(){var e;return e="/users/sign_out",t.$("form").html("<div id='confirmed'>Your account has been deleted, click <a href='"+e+"'>here to continue</a>.</div>"),$("header.app").remove(),!1},error:function(e){return t.$el.removeClass("busy_info"),e.suppressAppMessages=!0,t.displayErrors(e)}}),!1},o.prototype.confirm=function(){return this.confirmCheckbox.is(":checked")?this.submitButton.removeAttr("disabled"):this.submitButton.attr("disabled","disabled")},o.prototype.displayErrors=function(t){return this.displayResponseTextErrors(t),t.responseText||_.each(t,this.displayError,this),this.revealErrors()},o.prototype.displayError=function(t,e){return this.$("#user_"+e).parent().find(".input_msg").html(html_escape(t.toString()))},o.prototype.displayResponseTextErrors=function(t){var e;return t.responseText&&(e=$.parseJSON(t.responseText),e.detail&&_.each(e.detail,this.displayError,this),e.error)?this.$("#user_error").html(html_escape(e.error.toString())):void 0},o.prototype.remove=function(){return this.$el.empty()},o}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.UserEdit=function(r){function i(){return this.saveSettings=e(this.saveSettings,this),this.saveInfo=e(this.saveInfo,this),this.savePassword=e(this.savePassword,this),this.setUpCommunicationPreferences=e(this.setUpCommunicationPreferences,this),this.setUpLinkedAccounts=e(this.setUpLinkedAccounts,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="user_edit",i.prototype.el="#user_edit",i.prototype.frameName="userEdit",i.prototype.defaultPriceBucket="-1:20000",i.prototype.events={"click #user_submit":"submit","keyup #user_new_password":"passwordKeyUp","blur #user_new_password":"passwordBlur","keyup #user_email":"emailKeyUp","blur  #user_email":"emailBlur","blur  #user_name":"nameBlur","click a.toggle_facebook_linked":"toggleFacebookLinked","click a.toggle_twitter_linked":"toggleTwitterLinked","change .publish_to_facebook":"togglePublishToFacebook","click .preferences a.toggle":"toggleOption"},i.prototype.initialize=function(){var t=this;return this.model=App.currentUser,this.passwordModel=new App.Models.Password({id:this.model.id,email:this.model.get("email")}),this.passwordModel.on("invalid",function(e,r){return t.$el.removeClass("busy_pwd"),t.displayErrors(r)})},i.prototype.render=function(){return this.$el.html(JST["templates/users/edit"]({user:this.model})).fadeIn(160),this.locationField=new App.Views.User.LocationSearchField({el:this.$("#user_location")}),this.locationField.render(),this.passwordInput=this.$("#user_new_password"),this.passwordSupport=this.$(".password_support"),this.passwordMsg=this.passwordInput.parent().find(".input_msg"),this.emailInput=this.$("#user_email"),this.emailSupport=this.$(".email_support"),this.model.get("has_password")||this.$(".current_password").hide(),this.submitButton=this.$("#user_submit"),this.setUpCommunicationPreferences(),this.model.loadAuthentications({success:this.setUpLinkedAccounts})},i.prototype.clearErrors=function(){return this.$el.removeClass("errors"),this.$(".input_msg").empty(),this.$("#user_error").empty()},i.prototype.revealErrors=function(){var t=this;return this.$el.addClass("errors"),this.submitButton.addClass("error"),window.setTimeout(function(){return t.submitButton.removeClass("error")},1500)},i.prototype.setUpLinkedAccounts=function(){return this.setOption("facebook_linked",this.model.linkedTo("facebook")),this.$("input[name=publish_to_facebook]").attr("checked",this.model.get("publish_to_facebook")),this.model.linkedTo("facebook")&&this.model.hasLabFeature("Facebook Timeline Integration")&&this.$(".publish_to_facebook").show(),this.setOption("twitter_linked",this.model.linkedTo("twitter")),this.$(".linked_accounts").show()},i.prototype.setOption=function(t,e){var r;return r=this.$("a.toggle_"+t),e?r.addClass("on").find(".text").text("on"):r.removeClass("on").find(".text").text("off")},i.prototype.toggleFacebookLinked=function(){return this.model.hasLabFeature("Facebook Timeline Integration")&&this.model.linkedTo("facebook")&&(this.model.set({publish_to_facebook:!1},{silent:!0}),this.$(".publish_to_facebook").hide()),this.toggleLinked("facebook")},i.prototype.toggleTwitterLinked=function(){return this.toggleLinked("twitter")},i.prototype.toggleLinked=function(t){var e,r=this;return this.setOption(""+t+"_linked",!this.model.linkedTo(t)),this.model.linkedTo(t)?this.model.unlinkAccount(t,{error:function(t,e){return e.suppressAppMessages=!0,r.displayErrors(e)}}):(e="/users/auth/"+t,this.model.hasLabFeature("Facebook Timeline Integration")&&(e+="?scope=publish_actions"),window.location=e)},i.prototype.toggleOption=function(t){var e,r,o;return o=t.currentTarget,r=o.parentElement.className,this.setOption(r,!this.model.get(r)),e={},e[r]=!this.model.get(r),this.model.set(e),this.saveSettings()},i.prototype.togglePublishToFacebook=function(){var t;return t=!this.model.get("publish_to_facebook"),this.model.set({publish_to_facebook:t},{silent:!0}),this.saveSettings()},i.prototype.setUpCommunicationPreferences=function(){var t=this;return this.$(".preferences .toggle").each(function(e,r){var o;return o=r.parentElement.className,t.setOption(o,t.model.get(o))}),this.$(".preferences").show()},i.prototype.passwordKeyUp=function(){""!==this.passwordInput.val()&&(this.passwordSupport.slideDown("slow"),this.checkMinPasswordMsg())},i.prototype.checkMinPasswordMsg=function(){return this.passwordInput.val().length>5?this.passwordMsg.css("opacity","0"):this.passwordMsg.html(this.passwordModel.getErrorMessage("new_password_min")).css("opacity","1")},i.prototype.passwordBlur=function(){""===this.passwordInput.val()&&(this.passwordSupport.slideUp("slow"),this.$("#user_current_password").val(""),this.$("#user_password_confirmation").val(""),this.clearErrors())},i.prototype.emailKeyUp=function(){this.emailInput.val().trim()!==this.model.get("email")&&this.emailSupport.slideDown("slow")},i.prototype.emailBlur=function(){this.emailInput.val().trim()===this.model.get("email")&&(this.emailSupport.slideUp("slow"),this.clearErrors())},i.prototype.nameBlur=function(){return""===this.$("#user_name").val()?this.$("#user_name").val(this.model.get("name")):void 0},i.prototype.getPasswordAttribute=function(t){var e;switch(null==t&&(t="all"),e={},t){case"all":case"current_password":e.current_password=this.$("#user_current_password").val();break;case"all":case"new_password":e.new_password=this.passwordInput.val();break;case"all":case"password_confirmation":e.password_confirmation=this.$("#user_password_confirmation").val()}return e},i.prototype.savePassword=function(){var t,e=this;return t={current_password:this.$("#user_current_password").val(),new_password:this.passwordInput.val(),password_confirmation:this.$("#user_password_confirmation").val()},this.$el.removeClass("committed").addClass("busy_pwd"),this.passwordModel.save(t,{success:function(){return e.passwordInput.val("").blur(),App.showMessage("Your password has been updated."),e.$el.removeClass("busy_pwd").addClass("committed"),_.delay(e.saveInfo,1500)},error:function(t,r){return e.$el.removeClass("busy_pwd"),r.suppressAppMessages=!0,e.displayErrors(r)}}),!1},i.prototype.saveInfo=function(){var t,e,r;return r=this.updateUserLocation(),e={name:this.$("#user_name").val(),email:this.$("#user_email").val(),email_confirmation:this.$("#user_email_confirmation").val(),location:r.toJSON(),phone:this.$("#user_phone").val()},this.$el.removeClass("committed").addClass("busy_info"),t=this.model.validateAttrs(e),null!=t&&_.size(t)>0?(this.displayErrors(t),!1):(this.model.set(e),this.saveSettings())},i.prototype.updateUserLocation=function(){var t;return t=App.currentUser.get("location"),this.locationField.updateLocation(t),t},i.prototype.saveSettings=function(t){var e=this;
return this.$el.removeClass("committed").addClass("busy_info"),this.model.save({},{success:function(){return e.$el.removeClass("busy_info").addClass("committed"),App.showMessage("Your settings have been saved."),null!=t?"function"==typeof t.success?t.success():void 0:void 0},error:function(r,o){return e.$el.removeClass("busy_info"),o.suppressAppMessages=!0,e.displayErrors(o),null!=t?"function"==typeof t.error?t.error():void 0:void 0}}),!1},i.prototype.submit=function(){return this.clearErrors(),""!==this.passwordInput.val()?this.savePassword():this.saveInfo()},i.prototype.displayErrors=function(t){return this.displayResponseTextErrors(t),t.responseText||_.each(t,this.displayError,this),this.revealErrors()},i.prototype.displayResponseTextErrors=function(t){var e;if(t.responseText&&(e=$.parseJSON(t.responseText),e.detail&&_.each(e.detail,this.displayError,this),e.error))switch(e.error){case"User Already Exists":return this.$("#user_error").html("Another account is already associated with "+html_escape(this.$("#user_email").val())+". Please contact support@artsy.net.");case"Current Password Invalid":return this.displayError(this.passwordModel.getErrorMessage("current_password"),"current_password");case"Passwords Must be Different":return this.displayError(this.passwordModel.getErrorMessage("new_password"),"new_password_same");default:return this.$("#user_error").html(html_escape(e.error.toString()))}},i.prototype.displayError=function(t,e){return this.$("#user_"+e).parent().find(".input_msg").html(html_escape(t.toString()))},i.prototype.onLoad=function(){return this.render()},i.prototype.onUnload=function(){var t=this;return _.defer(function(){return App.router.viewState.unrenderFrame(t.frameName)})},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ProfileEdit=function(r){function i(){return this.toggleFavoritesEnabled=e(this.toggleFavoritesEnabled,this),this.toggleProfileEnabled=e(this.toggleProfileEnabled,this),this.save=e(this.save,this),this.setUpProfilePreferences=e(this.setUpProfilePreferences,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="profile_edit",i.prototype.el="#profile_edit",i.prototype.frameName="profileEdit",i.prototype.events={"click .profile_edit_icon_button":"editProfileIcon","click .profile_icon_actions .delete_action":"deleteIcon","click a.toggle_profile_enabled":"toggleProfileEnabled","click a.toggle_favorites_enabled":"toggleFavoritesEnabled","click #profile_save_changes":"save"},i.prototype.initialize=function(){return this.user=App.currentUser,this.profile=App.currentProfile,this.userFavorites=this.user.defaultArtworkCollection()},i.prototype.onLoad=function(){return this.render()},i.prototype.onUnload=function(){var t=this;return _.defer(function(){return App.router.viewState.unrenderFrame(t.frameName)})},i.prototype.render=function(){return this.$el.html(JST["templates/profiles/edit"]({user:this.model,profile:this.profile})).fadeIn(160),this.submitButton=this.$("#profile_save_changes"),this.profileIconView=new App.Views.ProfileIcon({el:this.$(".profile_icon_container"),model:App.currentProfile}),this.setUpProfilePreferences()},i.prototype.clearErrors=function(){return this.$el.removeClass("errors"),this.$(".input_msg").empty(),this.$("#errors").empty()},i.prototype.revealErrors=function(){var t=this;return this.$el.addClass("errors"),this.submitButton.addClass("error"),window.setTimeout(function(){return t.submitButton.removeClass("error")},1500)},i.prototype.setUpProfilePreferences=function(){var t,e=this;return this.$(".profile_preferences").show(),this.setOption("profile_enabled",!this.profile.get("private")),t=function(){return e.setOption("favorites_enabled",!e.userFavorites.get("private"))},this.userFavorites.ensureFetched(function(){return t()}),this.displayPublicProfile()},i.prototype.displayErrors=function(t){var e;return t.responseText?(e=$.parseJSON(t.responseText),e.detail&&_.each(e.detail,this.displayError,this),e.error&&this.$("#errors").html(html_escape(e.error.toString()))):_.each(t,this.displayError,this),this.revealErrors()},i.prototype.displayError=function(t,e){return this.$("#profile_"+e).parent().find(".input_msg").html(html_escape(t.toString()))},i.prototype.editProfileIcon=function(){return App.profileEditIcon?App.profileEditIcon.render():App.profileEditIcon=new App.Views.ProfileEditIconBackground},i.prototype.deleteIcon=function(){return $.ajax({url:"/api/v1/profile/"+App.currentProfile.get("id")+"/icon",type:"DELETE",success:function(){return App.currentProfile.unset("icon")}})},i.prototype.save=function(){var t,e,r,o,i,n=this;return this.profile||(this.profile=new App.Models.Profile),this.$el.removeClass("committed").addClass("busy"),r=null!=(o=this.$("#profile_website").val())?o.trim():void 0,r&&!/^https?:\/\//i.test(r)&&(r="http://"+r),e=null!=(i=this.$("#profile_bio").val())?i.trim():void 0,e=null!=e?e.replace(/#/g,"&#35;").replace(/_/g,"&#95;"):void 0,t={handle:this.$("#profile_handle").val(),location:this.$("#profile_location").val(),website:r,bio:e,"private":!this.$("a.toggle_profile_enabled").hasClass("on")},$.ajax({type:"PUT",url:"/api/v1/profile/"+this.profile.get("id"),data:t,success:function(t){return n.profile.set(t),n.displayPublicProfile(),App.showMessage("Your public profile has been updated."),n.$el.removeClass("busy").addClass("committed")},error:function(t,e){return e.suppressAppMessages=!0,n.displayErrors(e),n.$el.removeClass("busy")}}),!1},i.prototype.setOption=function(t,e){var r;return r=this.$("a.toggle_"+t),e?r.addClass("on").find(".text").text("on"):r.removeClass("on").find(".text").text("off")},i.prototype.toggleProfileEnabled=function(){var t;return t=!this.$("a.toggle_profile_enabled").hasClass("on"),t||this.$(".profile_settings_container").fadeOut("fast"),t||(this.userFavorites.set({"private":!0}).save(),this.setOption("favorites_enabled",t)),this.setOption("profile_enabled",t),this.save()},i.prototype.toggleFavoritesEnabled=function(){var t;return t=this.$("a.toggle_favorites_enabled").hasClass("on"),this.userFavorites.set({"private":t}).save(),this.setOption("favorites_enabled",!t)},i.prototype.displayPublicProfile=function(){return this.profile.get("private")?void 0:this.$(".profile_settings_container").fadeIn("fast")},i}(App.Frame)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.UserFavorites=function(r){function i(){return this.storeCurrentArtworkSet=e(this.storeCurrentArtworkSet,this),this.relayout=e(this.relayout,this),this.renderArtworks=e(this.renderArtworks,this),this.hideLoading=e(this.hideLoading,this),this.showLoading=e(this.showLoading,this),this.removeArtworkClick=e(this.removeArtworkClick,this),this.onResize=e(this.onResize,this),this.onLoad=e(this.onLoad,this),this.onUnload=e(this.onUnload,this),this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),_.extend(i.prototype,App.Mixins.ArtworkColumns),_.extend(i.prototype,App.Mixins.InitializeArtworks),i.prototype.analyticsRemoveMessage="Removed artwork from collection, via favorites",i.prototype.analyticsSaveMessage="Added artwork to collection, via favorites",i.prototype.margin=60,i.prototype.page=1,i.prototype.pageSize=10,i.prototype.done=!1,i.prototype.waiting=!1,i.prototype.initialize=function(){var t=this;if(!this.options.showEmpty)throw"showEmpty() function is required";if(!this.options.hideEmpty)throw"hideEmpty() function is required";return this.userFavorites=this.model.defaultArtworkCollection(),this.collection=new App.Models.ArtworkCollection({userId:this.model.get("id"),fetched:!0}),this.listenTo(this.userFavorites,"add",function(){return App.currentFrameName!==t.frameName?(App.router.viewState.unrenderFrame(t.frameName),t.collection=new App.Collections.SavedArtworks):void 0}),this.userFavorites.ensureFetched(this.render)},i.prototype.render=function(){return this.$el.html("").show(),this.fixedWidth=this.$el.width(),this.artworkColumns||(this.fixedWidth=this.$el.width(),this.setupArtworkColumnRowWidth()),this.getNextPage(),this.bindWindowEvents()},i.prototype.reRender=function(){return this.$el.show(),this.columns&&(this.columns.remove(),this.columns=null),this.renderArtworks(this.userFavorites.get("artworks").models),this.relayout()},i.prototype.onUnload=function(){var t;return App.router.viewState.saveScrollPosition(),this.unbindWindowEvents(),(null!=(t=this.userFavorites)?t.length:void 0)>0&&this.options.hideEmpty(),this.$el.hide()},i.prototype.onLoad=function(){return this.bindWindowEvents(),this.options.hideEmpty(),this.reRender()},i.prototype.onResize=function(){return this.fixedWidth=this.$el.width(),this.setupArtworkColumnRowWidth(),this.reRender()},i.prototype.onScroll=function(){var t;if(!this.waiting&&!this.done)return t=App.$window.height()+App.$window.scrollTop(),t>=this.$el.height()-App.$window.innerHeight()?this.getNextPage():void 0},i.prototype.removeArtworkClick=function(t){var e=this;return _.defer(function(){return $(t.target).parents("figure").remove(),e.relayout()})},i.prototype.showLoading=function(){return this.$el.append("<div class='pre_loader loading'></div>").show()},i.prototype.hideLoading=function(){return this.$(".pre_loader").remove()},i.prototype.getNextPage=function(){var t=this;if(!this.done&&!this.waiting)return this.waiting=!0,this.showLoading(),this.collection.fetchArtworks({params:$.param({page:this.page,size:this.pageSize,sort:this.collection.defaultSortOrder,user_id:this.model.get("id"),"private":!0}),success:this.renderArtworks,error:function(e){return 403===e.status&&(e.suppressAppMessages=!0),t.showEmpty()}}),this.page++},i.prototype.showEmpty=function(){return this.done=!0,this.waiting=!1,this.afterArtworksFetched(),this.options.showEmpty()},i.prototype.afterArtworksFetched=function(){var t;return this.userFavorites.allFetched=this.done,this.hideLoading(),"function"==typeof(t=this.options).finishedRendering?t.finishedRendering():void 0},i.prototype.renderArtworks=function(t){var e,r,o;if(!this.userFavorites.displayable()&&!this.options.canViewPrivateFavorites)return this.showEmpty();if(0===this.userFavorites.get("artworks").length&&0===t.length)return this.showEmpty();if(this.waiting=!1,this.done=0===t.length,this.done&&this.afterArtworksFetched(),t.length>0){for(this.userFavorites.get("artworks").add(t),this.columns||(this.setupArtworkColumnRowWidth(),this.initializeArtworkColumns()),r=0,o=t.length;o>r;r++)e=t[r],this.columns.addToShortestColumn(e);return this.$(".loading").load(function(){return $(this).removeClass("loading")}),this.options.removeArtworkOnSave&&this.$(".save").click(this.removeArtworkClick),this.initializeArtworksFromDom(),this.hideLoading()}},i.prototype.initializeArtworkColumns=function(){return this.columns=new App.Views.ArtworkColumns({gutterWidth:this.artworkColumnMargin,numberOfColumns:this.artworkColumns,totalWidth:this.fixedWidth,collection:new Backbone.Collection}),this.$el.html(this.columns.$el)},i.prototype.relayout=function(){return this.hideLoading(),this.userFavorites.get("artworks").length>0?this.bindWindowEvents():this.options.showEmpty()},i.prototype.bindWindowEvents=function(){var t=this;return this.onScrollThrottled=_.debounce(function(){return t.onScroll()},75),this.onResizeThrottled=_.debounce(function(){return t.onResize()},300),App.$window.bind("scroll.userFavorites",this.onScrollThrottled),App.$window.bind("resize.userFavorites",this.onResizeThrottled)},i.prototype.unbindWindowEvents=function(){return App.$window.unbind(".userFavorites")},i.prototype.storeCurrentArtworkSet=function(t){var e,r,o;return e=$(t.target).parent(".img_container"),this.userFavorites.get("artworks").models.length>1?(App.currentArtworkSet=this.userFavorites.get("artworks").models,App.currentArtworkIndex=this.$(".img_container").index(e),App.previousFrameUrl="/"+Backbone.history.fragment,App.previousFrameTitle=null!=(r=App.router.viewState.frames[App.currentFrameName])?null!=(o=r.frame)?o.frameTitle:void 0:void 0):void 0},i}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.User.LocationSearchField=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.selectedResult=null,o.prototype.events={input:"onInput","geocode:result":"onLocationSelected"},o.prototype.render=function(){var t=this;return this.$el.attr("placeholder","Enter your city"),App.render3rdPartyAssets?App.Lib.GoogleMaps.loadJsApi().then(function(){return t.$el.geocomplete({types:["(cities)"]})}):void 0},o.prototype.onInput=function(){return this.selectedLocation=null},o.prototype.onLocationSelected=function(t,e){return this.selectedResult=e,this.trigger("result",e)},o.prototype.getSelectedResult=function(){return this.selectedResult},o.prototype.getVal=function(){return this.$el.val()},o.prototype.updateLocation=function(t){var e,r;return e=this.getSelectedResult(),r=this.getVal(),e?(t.setFromGoogleResult(e),t.set({raw:r})):t.reset({raw:r})},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ResetPasswordForm=function(r){function i(){return this.disableLoading=e(this.disableLoading,this),this.enableLoading=e(this.enableLoading,this),this.disableErrorState=e(this.disableErrorState,this),this.enableErrorState=e(this.enableErrorState,this),this.resetPassword=e(this.resetPassword,this),this.submit=e(this.submit,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.passwordBlank="Please enter a new password.",i.prototype.unexpectedError=function(t){return"Unexpected error: "+t+". Please contact <a href='mailto:support@artsy.net'>support@artsy.net</a>."},i.prototype.serverError=function(t){return""+t+" Please contact <a href='mailto:support@artsy.net'>support@artsy.net</a> if you believe there has been an error."},i.prototype.events={"click button":"submit","click a.back_to_login":"redirectToLogin"},i.prototype.loading=!1,i.prototype.initialize=function(){var t=this;return this.$form=this.$el.find("form"),this.$form.bind("submit",function(e){return t.submit(e)})},i.prototype.submit=function(t){return t.preventDefault(),this.loading?void 0:(this.enableLoading(),this.validate()?this.resetPassword():!1)},i.prototype.redirectToLogin=function(){return window.location.href="/log_in"},i.prototype.resetPassword=function(){var t,e=this;return t=$.ajax({type:"put",data:this.$form.serialize(),url:this.$form.attr("action"),success:function(t,e,r){var o;return o=JSON.parse(r.responseText),window.location.href=null!=o.trust_token?"/users/sign_in?trust_token="+o.trust_token+"&remember_me=true":"/"},error:function(t){var r;return t.suppressAppMessages=!0,r=JSON.parse(t.responseText),e.enableErrorState(_.map(r.details,function(t){return""+t+"."}).join("<br/>"))}})},i.prototype.validate=function(){var t;return t=[],(this.$form.find("input[name='user[password]']").val().length<1||this.$form.find("input[name='user[password_confirmation]']").val().length<1)&&t.push(this.passwordBlank),t.length<1?!0:(this.enableErrorState(t.join("<br/>")),!1)},i.prototype.enableErrorState=function(t){return this.$form.find(".errors").html(html_escape(t)).end().find("button").addClass("error"),this.disableLoading(),setTimeout(this.disableErrorState,1500)},i.prototype.disableErrorState=function(){return this.$form.find("button").removeClass("error")},i.prototype.enableLoading=function(){return this.loading=!0,this.$form.find("button").addClass("loading")},i.prototype.disableLoading=function(){return this.loading=!1,this.$form.find("button").removeClass("loading")},i}(App.View)}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function o(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};App.Views.ResetPasswordFrame=function(r){function i(){return this.render=e(this.render,this),t=i.__super__.constructor.apply(this,arguments)}return o(i,r),i.prototype.id="reset_password",i.prototype.el="#reset_password",i.prototype.frameName="reset_password",i.prototype.render=function(){var t=this;return $("#content").show(),_.defer(function(){return t.$el.show()}),this.form||(this.form=new App.Views.ResetPasswordForm({el:this.el}))},i.prototype.onLoad=function(){return this.render()},i}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.UnsubscribeFrame=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.id="unsubscribe",o.prototype.el="#unsubscribe",o.prototype.frameName="unsubscribe",o.prototype.load=function(){return this.render()},o.prototype.render=function(){var t=this;return _.defer(function(){return t.$el.show()})},o.prototype.onUnload=function(){return this.$el.hide()},o}(App.Frame)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Views.Video=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.events={"click .video-play-trigger, .play":"onPlayTriggerClick","click .video-skip-trigger":"onSkipTriggerClick"},o.prototype.initialize=function(){var t=this;return this.$video=this.$el.find("video"),this.$video.on("ended",function(){return t.onEnded()}),App.videoView=this,App.videoEl=this.$video.get(0)},o.prototype.onPlayTriggerClick=function(){var t=this;return this.$el.addClass("playing"),this.$video.attr("controls","true"),this.$(".play").hide(),_.defer(function(){return t.$video.get(0).play()})},o.prototype.onSkipTriggerClick=function(t){var e;return t&&t.stopPropagation(),null!=(e=this.options)&&e.skipClick(),!1},o.prototype.onEnded=function(){return this.$el.removeClass("playing"),this.$video.removeAttr("controls"),this.$video.get(0).currentTime=0},o}(App.View)}.call(this),function(){var t,e={}.hasOwnProperty,r=function(t,r){function o(){this.constructor=t}for(var i in r)e.call(r,i)&&(t[i]=r[i]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};App.Routers.Client=function(e){function o(){return t=o.__super__.constructor.apply(this,arguments)}return r(o,e),o.prototype.routes={"":"home","_=_":"home","auction-registration/:id(/*params)":"auctionRegistration","auction-registration/:id":"auctionRegistration","feature/:id/bid/:artwork(/*params)":"bid","feature/:id/confirm-bid":"featureConfirmBid","feature/:id/confirm-registration":"featureConfirmRegistration","feature/:id(/*params)":"feature",invite:"invite",log_in:"login","join(?:params)":"createAccount",join:"createAccount","forgot-password":"forgotPassword","page/*params":"page","pages/*params":"page",post:"postDialog","reset_password(?:params)":"resetPassword",sign_up:"signup",terms:"terms","unsubscribe(?:params)":"unsubscribe","user/delete":"userDelete","user/edit":"userEdit","profile/edit":"profileEdit",":handle/browse/artist/:id":"profileArtist",":handle/browse/artists":"profileArtistsList",":handle/browse/artists/*params":"profileArtistsSectionList",":handle/browse/show/:id":"profilePartnerShow",":handle/browse/shows":"profilePartnerShowsFeed",":handle/browse/shows/*params":"profilePartnerShowsSectionFeed",":handle/browse/exhibitors":"profileExhibitorsList",":handle/browse/exhibitors/*params":"profileExhibitorsSectionFeed",":handle/browse/filter":"profileFilter",":handle/browse/filter/*params":"profileFilter",":handle/:tab(/:tabObjId)":"profile",":handle(/:tab)":"profile",":handle/*params":"profile",":handle":"profile"},o.prototype.initialize=function(){return this.viewState=new App.Models.ViewState({auctionRegistration:{obj:App.Views.AuctionRegistrationFrame},fairProfile:{obj:App.Views.FairOrganizerProfileShow},bid:{obj:App.Views.BidFrame},feature:{obj:App.Views.FeatureFrame},galleryProfile:{obj:App.Views.GalleryProfileFrame},home:{obj:App.Views.HomeIndex},institutionProfile:{obj:App.Views.InstitutionProfileFrame},invite:{obj:App.Views.InvitationNew},page:{obj:App.Views.PageFrame},profiles:{obj:App.Views.Profiles.Frame},postDialog:{obj:App.Views.PostDialogFrame},profileEdit:{obj:App.Views.ProfileEdit},resetPassword:{obj:App.Views.ResetPasswordFrame},shows:{obj:App.Views.Shows.Frame},smallFairProfile:{obj:App.Views.SmallFairOrganizerFrame},unsubscribe:{obj:App.Views.UnsubscribeFrame},userDelete:{obj:App.Views.UserDelete},userEdit:{obj:App.Views.UserEdit},userProfile:{obj:App.Views.UserProfileShow}}),this.setCurrentRoute("home"),this.on("all",this.onAll,this),this.handleRedirectURI(),o.__super__.initialize.apply(this,arguments)},o.prototype.startHistory=function(){return Backbone.history.start({pushState:!0})},o.prototype.setCurrentRoute=function(t){return this.currentRoute=t.replace("route:","")},o.prototype.handleRedirectURI=function(){var t;if(!App.isLoggedIn())return t=parseUri(window.location),this.checkRedirectUrl(t)},o.prototype.checkRedirectUrl=function(t){return t.anchor.indexOf("!")>-1&&this.redirectTo(t.anchor.substring(1)),null!=window.return_to&&"/"!==window.return_to&&(this.setRedirectUrl(window.return_to),this.navigate("log_in")),t.queryKey.redirect_uri&&"/"!==unescape(t.queryKey.redirect_uri)?(this.setRedirectUrl(unescape(t.queryKey.redirect_uri)),this.navigate("log_in")):void 0},o.prototype.setRedirectUrl=function(t){return App.redirectUrl=t,$(".enter_with_facebook").attr("href","/users/auth/facebook?redirect_uri="+escape(t)),$(".enter_with_twitter").attr("href","/users/auth/twitter?redirect_uri="+escape(t))},o.prototype.login=function(){return App.isLoggedIn()?this.redirectToHome():(App.loginSignupDialog.showLoginForm(),this.viewState.setFrame("home"))},o.prototype.createAccount=function(){var t;return App.isLoggedIn()?this.redirectToHome():(t=$.deparam(window.location.search.substring(1)),App.showCreateAccountDialog(t),this.viewState.setFrame("home"))},o.prototype.forgotPassword=function(){return App.isLoggedIn()?this.redirectToHome():(App.loginSignupDialog.showForgotPasswordForm(),this.viewState.setFrame("home"))},o.prototype.signup=function(){return App.isLoggedIn()?this.redirectToHome():(App.loginSignupDialog.showSignupForm(),this.viewState.setFrame("home"))},o.prototype.home=function(){return this.viewState.setFrame("home"),App.IS_PHONE&&!App.isLoggedIn()?App.loginSignupDialog.mobileValueProp(!0):void 0},o.prototype.userEdit=function(){return this.viewState.setFrame("userEdit")},o.prototype.userDelete=function(){return this.viewState.setFrame("userDelete")},o.prototype.profileEdit=function(){return this.viewState.setFrame("profileEdit")},o.prototype.invite=function(){return this.viewState.setFrame("invite")},o.prototype.terms=function(){return this.viewState.setFrame("page",{pageId:"terms"})},o.prototype.job=function(t){return this.viewState.setFrame("page",{pageId:t})},o.prototype.page=function(t){return this.viewState.setFrame("page",{pageId:t})},o.prototype.bid=function(t,e,r){return r=r?$.deparam(r):{},this.viewState.setFrame("bid",{params:r,featureId:t,artworkId:e})},o.prototype.featureConfirmBid=function(t){return this.viewState.setFrame("feature",{featureId:t,subpage:"confirm-bid"})},o.prototype.featureConfirmRegistration=function(t){return this.viewState.setFrame("feature",{featureId:t,subpage:"confirm-registration"})},o.prototype.feature=function(t,e){return e=e?$.deparam(e):{},this.viewState.setFrame("feature",{params:e,featureId:t})},o.prototype.resetPassword=function(t){return this.viewState.setFrame("resetPassword",{params:t})},o.prototype.unsubscribe=function(t){return this.viewState.setFrame("unsubscribe",{params:t})},o.prototype.auctionRegistration=function(t){return this.viewState.setFrame("auctionRegistration",{saleId:t})},o.prototype.postDialog=function(t){return this.viewState.setFrame("postDialog",{type:t})},o.prototype.profileArtist=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"artist",artistId:e})},o.prototype.profileArtistsList=function(t){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"artistsList"})},o.prototype.profileArtistsSectionList=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"exhibitorsList",filterName:e.split("=")[1],filterType:e.split("=")[0]})},o.prototype.profilePartnerShow=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"partnerShow",partnerId:e})},o.prototype.profilePartnerShowsFeed=function(t){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"partnerShowsList"})},o.prototype.profilePartnerShowsSectionFeed=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"partnerShowsList",filterName:e.split("=")[1],filterType:e.split("=")[0]})},o.prototype.profileExhibitorsList=function(t){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"exhibitorsList"})},o.prototype.profileExhibitorsSectionFeed=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"exhibitorsList",filterName:e.split("=")[1],filterType:e.split("=")[0]})},o.prototype.profileFilter=function(t,e){return this.fetchProfileAndSetFrame({profileId:t,tab:"browse",subTab:"filter",params:e})},o.prototype.profile=function(t,e,r){return this.fetchProfileAndSetFrame({profileId:t,tab:e,tabObjId:r})},o.prototype.fetchProfileAndSetFrame=function(t){var e=this;return App.Repositories.Profiles.getOrFetch(t.profileId,["private"],{success:function(r){return _.defer(function(){return r.ensureSubmodelsFetched(function(){return e.viewState.setFrame(r.frameName(),_.extend(t,{model:r}))})})}})},o.prototype.onAll=function(t){var e;if(t.indexOf("route:")>-1)return this.routedOnce&&(window.redirectToMicrogravity(),window.redirectToForce()),this.setCurrentRoute(t),(null!=(e=window.history)?e.pushState:void 0)&&$("link[rel='canonical']").attr("href",""+App.canonicalUrl+window.location.pathname),$("#deep_zoom_light_box").hide(),App.loginSignupDialog&&(App.onHomepage()||App.onLoginSignupPage()||App.loginSignupDialog.hide()),App.searchForm&&(App.searchForm.$input.val(""),App.searchForm.onBlur()),Analytics.page(),this.routedOnce=!0},o.prototype.redirectToHome=function(){return this.redirectTo("/")},o.prototype.renderError=function(t){return this.redirectTo("/"+t)},o.prototype.isUrlRelative=function(t){var e;return e=t.toLowerCase(),0!==e.indexOf("http://")&&0!==e.indexOf("https://")},o.prototype.isSSL=function(){return"https:"===location.protocol},o.prototype.redirectTo=function(t){return window.location.href=t},o}(App.Router)}.call(this),function(){App.createCookie=function(t,e,r){var o,i;return null==r&&(r=7),r?(o=new Date,o.setTime(o.getTime()+1e3*60*60*24*r),i="; expires="+o.toGMTString()):i="",document.cookie=t+"="+e+i+"; path=/"},App.readCookie=function(t){var e,r,o,i,n,s;for(o=t+"=",r=document.cookie.split(";"),n=0,s=r.length;s>n;n++){for(e=r[n];" "===e.charAt(0);)e=e.substring(1,e.length);0===e.indexOf(o)&&(i=e.substring(o.length,e.length))}return i},App.deleteCookie=function(t){return App.createCookie(t,"",-1)}}.call(this),function(){App.follow=function(t,e,r){return App.currentUser.accountCreated()?(e.follow({success:function(){return null!=(null!=r?r.success:void 0)&&r.success(),App.currentUser.hideFollowTooltip()},error:function(){return null!=(null!=r?r.error:void 0)?r.error():void 0}}),!1):(e.url().match(/gene/)?App.loginSignupDialog.show("followGene"):e.url().match(/artist/)?App.loginSignupDialog.show("followArtist"):e.url().match(/profile/)&&App.loginSignupDialog.show("followProfile"),void 0)},App.unfollow=function(t,e,r){return e.unfollow({success:function(){return null!=(null!=r?r.success:void 0)&&r.success(),App.currentUser.hideFollowTooltip()},error:function(){return null!=(null!=r?r.error:void 0)?r.error():void 0}}),!1}}.call(this),App.formatNumber=function(e,r,o,i){function n(t,e,r){var o=Math[r||"round"],i=Math.pow(10,Math.abs(e||0));return 0>e&&(i=1/i),o(t*i)/i}function s(t){return!isNaN(parseFloat(t))&&isFinite(t)}var a,l,p,u,h,c,d="";for(void 0===o&&(o=","),void 0===i&&(i="."),p=(s(r)?n(e,r||0).toFixed(Math.max(r,0)):e.toString()).replace(/^-/,""),u=p.split("."),h=u[0],c=u[1],a=h.length;a>0;a-=3)a<h.length&&(d=o+d),d=h.slice(Math.max(0,a-3),a)+d;return c&&(t=(r||0)-c.length,l=t>0?_.times(t,function(){l+="0"}):"",d+=i+l+c),(0>e?"-":"")+d},function(){App.Lib.GoogleMaps={getMapImageSrc:function(t){return t=_.defaults({},t,{maptype:"roadmap",sensor:!1,style:"lightness:50|saturation:-100",zoom:16,key:this.apiKey?this.apiKey:void 0,sensor:!1}),"http://maps.googleapis.com/maps/api/staticmap?"+$.param(t)},getMapLink:function(t){var e;return e={q:t,hnear:t},"https://maps.google.com/maps?"+$.param(e)},loadJsApi:function(){var t,e;return this.apiLoadPromise||(t=$.Deferred(),window.googleMapsCallback=function(){return window.googleMapsCallback=null,t.resolve()},e={sensor:!1,libraries:"places",key:this.apiKey?this.apiKey:void 0,callback:"googleMapsCallback"},App.$body.append("<script src='http://maps.googleapis.com/maps/api/js?"+$.param(e)+"'></script>"),this.apiLoadPromise=t.promise()),this.apiLoadPromise}}}.call(this),function(){App.fullyQualifiedImageUrl=function(t){var e;return App.isSSL()&&null!=App.secureImagesUrl&&null!=App.imagesUrl&&null!=App.imagesUrlPrefix?(null==(e=App.imagesUrlPrefixRE)&&(App.imagesUrlPrefixRE=new RegExp(App.imagesUrlPrefix.replace("%d","\\d"))),t.replace(App.imagesUrlPrefixRE,App.secureImagesUrl)):t},App.imageUrl=function(t,e){return t.hasImage(e)?App.fullyQualifiedImageUrl((t.get("image_url")||":version.jpg").replace(":version",e)):"/assets/shared/missing_image.png"}}.call(this),function(){var t;App.WINDOW_DEBOUNCE_TIME=500,t={"0-1024":140,"1024-1260":160,"1260-1420":180,"1420-1660":200,"1660-1900":220,"1900-2540":240,"2540-2560":260},App.fillwidthRowHeight=function(){var e,r,o,i,n;for(e in t)if(r=t[e],i=parseInt(e.split("-")[0]),o=parseInt(e.split("-")[1]),i<(n=App.$window.width())&&o>n)return r}}.call(this),function(){App.serverTime=function(t){return null==t&&(t={}),$.ajax({type:"GET",url:"/api/v1/system/time",success:null!=t?t.success:void 0,error:null!=t?t.error:void 0})}}.call(this),function(){App.siteFeatureEnabled=function(t,e){var r,o;return null==e&&(e=!0),r=null!=(o=App.siteFeatures)?o[t]:void 0,null!=r?r:e}}.call(this),function(){var t,e;t=["transform","box-shadow","transition-duration"],$(function(){var e,r,o,i;for(i=[],r=0,o=t.length;o>r;r++)e=t[r],i.push($.cssHooks[e]={set:_.bind(function(t,e,r){var o;return o={},o["-moz-"+t]=r,o["-webkit-"+t]=r,o["-o-"+t]=r,o["-ms-"+t]=r,$(e).css(o)},this,e)});return i}),e="transitionEnd oTransitionEnd msTransitionEnd transitionend webkitTransitionEnd",$.fn.transitionEnd=$.fn.onTransitionEnd=function(t){return $(this).on(e,t)},$.fn.offTransitionEnd=function(t){return $(this).off(e,t)},$.fn.oneTransitionEnd=function(t){return $(this).one(e,_.debounce(t))}}.call(this),function(){var t;t=function(){function t(){}return t.impression=function(t,e,r,o){var i;return i={filterModules:{google:!0}},null!=o&&_.extend(i,o),this.logEvent("impression",t,e,r,!0,i)},t.hover=function(t,e,r,o){return this.logEvent("hover",t,e,r,!0,o)},t.click=function(t,e,r,o){return this.logEvent("click",t,e,r,!1,o)},t.funnel=function(t,e,r,o){return this.logEvent("funnel",t,e,r,!0,o)},t.segment=function(t,e,r,o){return this.logEvent("segment",t,e,r,!0,o)},t.error=function(t,e,r,o){var i;return i={filterModules:{google:!0}},null!=o&&_.extend(i,o),this.logEvent("error",t,e,r,!0,i)},t.maxTrackableMultiIds=50,t.multi=function(t,e,r){var o,i,n,s,a,l,p,u,h=this;if((null!=r?r.length:void 0)>0){for("Impression"===t&&(s={filterModules:{google:!0}}),i=_.groupBy(r,function(t,e){return Math.floor(e/h.maxTrackableMultiIds)}),p=_.toArray(i),u=[],n=a=0,l=p.length;l>a;n=++a)o=p[n],u.push(function(r){return window.setTimeout(function(){return h.logEvent("multi",t,e,r,!0,s)
},1e3*n+1)}(this.encodeMulti(o)));return u}},t.page=function(){var t=this;return _.defer(function(){return t.setPage(""+window.location.pathname+window.location.hash)})},t.conversion=t.funnel,t.event=function(t,e,r){return this.logEvent("other",t,e,r,!0)},t.setPage=function(t){return"undefined"!=typeof Analytical&&null!==Analytical&&Analytical.track(t),"undefined"!=typeof Analytical&&null!==Analytical&&Analytical.set({index:2,name:"U",value:t,scope:"page"}),this.currentPage=t},t.registerCurrentUser=function(t){var e;if(e=(null!=t?t.isAdmin():void 0)?"Admin":t&&t.get("email")?"Member":"Visitor","Visitor"!==e){if(window._kmq&&_kmq.push(["identify",t.get("email")]),window.mixpanel&&(mixpanel.identify(t.get("id")),mixpanel.register({"User Type":e})),window._gaq)return _gaq.push(["_setCustomVar",1,"User Type",e,3]),_gaq.push(["_setCustomVar",3,"User Type",e,1])}else if(window._gaq&&_gaq.push(["_setCustomVar",1,"User Type",e,3]),window._kmq&&_kmq.push(["set",{"User Type":e}]),window.mixpanel)return mixpanel.register({"User Type":e})},t.logEvent=function(t,e,r,o,i,n){var s;return null==n&&(n={}),s={},null!=(null!=n?n.data:void 0)&&_.extend(s,n.data),s.category=this.categoryToString(t),null!=r&&(s.label=this.modelAndIdToLabel(r,o)),null!=this.currentPage&&(s.page=this.currentPage),null!=i&&(s.noninteraction=i),"undefined"!=typeof Analytical&&null!==Analytical?Analytical.event(e,s,n):void 0},t.categoryToString=function(t){return"impression"===t?"Impressions":"hover"===t||"click"===t?"UI Interactions":"funnel"===t?"Funnel Progressions":"segment"===t?"UI A/B Test Segments":"error"===t?"UI Errors":"multi"===t?"Multi-object Events":"Other Events"},t.encodeMulti=function(t){return t=_.compact(t),_.map(t,function(t){return hex_md5(t).substr(0,8)}).join("-")},t.modelAndIdToLabel=function(t,e){return"object"==typeof t&&null!=(null!=t?t.modelName:void 0)&&null!=(null!=t?"function"==typeof t.get?t.get("id"):void 0:void 0)?""+_.capitalize(null!=t?t.modelName:void 0)+":"+(null!=t?"function"==typeof t.get?t.get("id"):void 0:void 0):null!=t&&"object"!=typeof t&&null!=e?""+_.capitalize(t)+":"+e:void 0},t.abAssignment=function(t,e,r){var o,i,n,s;return null==r&&(r={}),o=$.deparam.querystring()[t],null!=o?o:null==window.mixpanel?e[0]||_.keys(e)[0]:(i=App.readCookie("ab"),i=null!=i?JSON.parse(i):{},null!=i[t]?i[t]:(i[t]=o=this.abChoiceRandomize(e),App.createCookie("ab",JSON.stringify(i),!1),n="ab:"+t,(s={})[n]=o,window.mixpanel.register_once(s),window.mixpanel.track(""+n+":start"),"undefined"!=typeof _gaq&&null!==_gaq&&r.ga&&_gaq.push(["_setCustomVar",4,n,o,1]),null!=r.onAssignment&&r.onAssignment(o),o))},t.abChoiceRandomize=function(t){var e,r,o,i,n,s;return null!=t.length?t[Math.floor(t.length*Math.random())]:(i=function(){var e;e=[];for(r in t)s=t[r],e.push([r,s]);return e}().sort(),e=0,n=i.map(function(t){return[t[0],e+=t[1]]}),o=Math.random(),n.filter(function(t){return o<t[1]})[0][0])},t.abSuccess=function(t,e){var r;return null==e&&(e=null),null!=window.mixpanel?(r="ab:"+t+":success",null!=e&&(r+=":"+e),window.mixpanel.track(r)):void 0},t}(),window.Analytics=t}.call(this),function(){window.Mailcheck={domains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","fb.com"]}}.call(this),function(){$(function(){return window.onerror=function(t,e,r){return window.errorFired={message:t,file:e,line:r},Analytics.error("(window) "+t+" ["+e+" ("+r+")]")},App.$document.ajaxError(function(t,e,r,o){var i,n;if("abort"!==o&&404!==(null!=e?e.status:void 0)){if(window.ajaxErrorFired=!0,n=e.responseText)try{i=$.parseJSON(n).message,i&&(n=i)}catch(s){}return Analytics.error("(ajax "+e.status+") "+o+" "+n+" ["+r.url+"]")}})})}.call(this),function(){App.Facebook={callbacks:[],appId:$("meta[property='fb:app_id']").attr("content"),namespace:null,canonicalUrl:null,onLoad:function(t){return window.FB?t():App.Facebook.callbacks.push(t)},asyncInit:function(){var t,e,r,o,i;for(o=App.Facebook.callbacks,i=[],e=0,r=o.length;r>e;e++)t=o[e],i.push(App.Facebook.callbacks.pop()());return i},ensureAuth:function(t){var e=this;if("undefined"!=typeof FB&&null!==FB)return App.currentUser.loadAuthentications({success:function(){var r;return r=App.currentUser.linkedTo("facebook"),null!=r?FB.getLoginStatus(function(o){return"connected"!==o.status?e.reauthorize(t):r.get("uid")===o.authResponse.userID?t():void 0}):void 0}})},reauthorize:function(t){var e=this;return FB.login(function(r){return null!=r.authResponse&&"connected"===r.status?e.ensureAuth(function(){return t(),$.getJSON("/users/auth/facebook/callback")}):void 0},{scope:"publish_actions"})},shareSavedArtwork:function(t){var e=this;return this.ensureAuth(function(){return e.saveToTimeline(t,function(r){return r.error&&"OAuthException"===r.error.type?e.reauthorize(function(){return e.saveToTimeline(t)}):void 0})})},saveToTimeline:function(t,e){return FB.api("/me/"+this.namespace+":save","post",{artwork:"{@canonicalUrl}/artwork/"+t.get("id")},function(t){return null!=e?e(t):void 0})}}}.call(this);var Flash=new Object;Flash.data={},Flash.transferFromCookies=function(){var t=JSON.parse(unescape($.cookie("flash")));t||(t={}),Flash.data=t,$.cookie("flash",null,{path:"/",domain:""})},Flash.writeDataTo=function(t,e,r){e=$(e);var o="";Flash.data[t]&&(o=Flash.data[t].toString().replace(/\+/g," "),e.html(o),r&&"function"==typeof r?r(e):e.show())},/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
function(t){t.cookie=function(e,r,o){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(r))||null===r||void 0===r)){if(o=t.extend({},o),(null===r||void 0===r)&&(o.expires=-1),"number"==typeof o.expires){var i=o.expires,n=o.expires=new Date;n.setDate(n.getDate()+i)}return r=String(r),document.cookie=[encodeURIComponent(e),"=",o.raw?r:encodeURIComponent(r),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}o=r||{};for(var s,a=o.raw?function(t){return t}:decodeURIComponent,l=document.cookie.split("; "),p=0;s=l[p]&&l[p].split("=");p++)if(a(s[0])===e)return a(s[1]||"");return null}}(jQuery);