extends ../../components/main_layout/templates/index
include ../../components/pagination/paginator
include ../artist/templates/header

block head
  include meta
  +paginateHead(auctionLots.state.currentPage, auctionLots.state.totalPages, '?sort=' + auctionLots.sortBy + '&')

block locals
  assetPackage = 'auction_lots'

block body
  #auction-results-page.main-layout-container
    +artist-header(artist, 'Auction results for ')

    .auction-lots-table-header
      .auction-lots-total
          | #{auctionLots.state.totalRecords} Results
          - if (auctionLots.state.totalPages > 1)
            | &mdash;Page #{auctionLots.state.currentPage} of #{auctionLots.state.totalPages}

      .auction-lots-sort
        span Order:
        .bordered-pulldown
          a.bordered-pulldown-toggle
            = auctionLots.sortCriteria[auctionLots.sortBy]
            .bordered-pulldown-toggle-caret
              span.caret
          .bordered-pulldown-options
            a( href="?sort=#{auctionLots.sortBy}" )
              = auctionLots.sortCriteria[auctionLots.sortBy]
            - for k, v in auctionLots.sortCriteria
              - if (!(!user && k === 'Sale' || v === auctionLots.sortBy))
                a( href="?sort=#{v}" )= k

    table.auction-lots-table
      thead
        tr
          th Title
          th Year
          th Medium
          th Size
          th Auction House
          th Date
          th Estimate
          th Sale Price
      tbody
        - for lot in auctionLots.models
          tr.auction-lot( id="auction-lot-#{lot.id}" )
            td
              .auction-lot-title-container
                - if (lot.get('image_url') != '/assets/shared/missing_image.png')
                  a.auction-lot-image-zoom(
                    href=lot.get('image_url').replace(/thumbnail/, 'original')
                  )
                    img.auction-lot-image( src!= lot.get('image_url'), alt= lot.get('title') )
                - else
                  .auction-lot-image-placeholder
                .auction-lot-title
                  em= lot.get('title')
                  - if (lot.get('external_url'))
                    a.auction-lot-details-link(
                      href=lot.get('external_url'), target='_blank'
                    ) See details
            td= lot.get('dates_text')
            td.auction-lot-medium= lot.get('medium_text')
            td
              = lot.get('dimensions').in
              br
              = lot.get('dimensions').cm
            td.auction-lot-organization= lot.get('organization')
            td= lot.get('auction_dates_text')
            td!= lot.get('estimate_text')
            td
              - if (user)
                = lot.get('price_realized_text')
              - else
                a.auction-lot-sale-signup
                  | Sign up to see sale price

    +paginate(auctionLots.state.currentPage, auctionLots.state.totalPages, '?sort=' + auctionLots.sortBy + '&')
